Title,Body,AnswerAccepted
"Calculate Picture ID for Gallery With Ads","<p>I have a picture gallery where after every three pictures, an ad is displayed (gotta pay those bills üòÄ).</p>

<p>So in an example scenario, my gallery would have 11 slides, of which there are 9 pictures and 2 ads, like this:</p>

<p><a href=""https://i.stack.imgur.com/IR4Nm.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/IR4Nm.png"" alt=""gallery""></a></p>

<p>In the top row of this drawing are the zero-based indexes of the slides, which I have in an array.</p>

<p>What I need to come up with now is a formula to calculate the index of the picture corresponding to a given slide ID (the numbers in the bottom row).</p>

<p>So for <code>slideIndex === 2</code>, I need <code>picIndex === 2</code>, for <code>slideIndex === 5</code>, I need <code>picIndex === 4</code> and for <code>slideIndex === 8</code>, the result would be <code>picIndex === 6</code>.</p>

<p>For a slide that contains an ad, I would like to have the index of the last pic, so for <code>slideIndex === 3</code> ‚Üí <code>picIndex === 2</code>.</p>

<p>I do have a working solution already, where I just use a <code>for</code> loop, but this seems really lame and cumbersome:</p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>const adInterval = 3; // show an ad every 3 pics

function calculatePicIndex(slideIndex) {
    let picCount = 0;
    let picIndex = -1;
    for (let i = 0; i &lt;= slideIndex; i++) {
        if (++picCount &gt; adInterval) {
            picCount = 0;
        } else {
            picIndex++;
        }
    }
    return picIndex;
}

for (let i = 0; i &lt; 11; i++) {
    console.log(`slide index: ${i} ‚Äì pic index: ${calculatePicIndex(i)}`);
}</code></pre>
</div>
</div>
</p>

<p>I'm sure there is a much more elegant solution with a simple math formula, so basically, it's more a math question than a JavaScript question:</p>

<p><strong>How can I refactor the above code to avoid the loop and calculate the number through a math formula?</strong></p>

<p>I have tried something like this:</p>

<pre><code>const picIndex = slideIndex - Math.floor(slideIndex / adInterval);
</code></pre>

<p>But that gives me incorrect values which are more and more off as slide index increases.</p>

<p>See JSFiddle: <a href=""https://jsfiddle.net/pahund/1bobtkyp/3/"" rel=""nofollow noreferrer"">https://jsfiddle.net/pahund/1bobtkyp/3/</a></p>
","<p>Your formula is almost correct, you only have to add 1 to the slide index and ad interval to fix it:</p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>const adInterval = 3;

for (let slideIndex = 0; slideIndex &lt; 12; slideIndex++){
    let picIndex = slideIndex - Math.floor((slideIndex + 1) / (adInterval + 1)); 
    console.log(`slide index: ${slideIndex} ‚Äì pic index: ${picIndex}`);
}</code></pre>
</div>
</div>
</p>


"
"Node js, refactoring long node js async function","<p>I'm converting SQL Procedure to node js function.</p>

<p>My converting function is too long, so readability is bad.</p>

<p>I want to split small function, but don't know how I can refactoring it.
I use async.wait because several SQL statement should be run serial.</p>

<pre><code>exports.cancelDansok =  function cancelDansok(dansokSeqNo, callback) {
       var tasks = [
         function (callback) {
           models.DansokHist.max('SerialNo', {
             where: { DansokSeqNo: dansokSeqNo}
           })
           .then(max =&gt; {
             if (!max) {
               callback(null, 1);
             } else {
               callback(null, max+1);
             }
           })
           .error(err =&gt; {
             log.info(err);
             return callback({status:400, message:'select dansokhisttbl failed.'});
           });          
         },
         function (serialNo, callback) {
            ....
           })
           .then(() =&gt; {
             ....
           })
           .then( feeVBankList =&gt; {
             callback(null);
           })
           .error(err =&gt; {
             return callback({status:400, message:'update dansokfeetbl failed.'});
           });          
         },
         function (callback) {        
           ....
         },
         function (callback) {        
           ....
         },
         function (callback) {        
           ....
         },
         function (callback) {        
           ....
         }
       ];

       async.waterfall(tasks, function(err, success) {
         if (err) {
           return callback(err);
         } else {
           return callback(success);
         }
       });
     }
</code></pre>

<p>What would be the best practice in my case?</p>
","<p>I would create a named function for each <code>function (callback) {</code> and then replace them in the tasks array by the newly created function name.</p>

<p>Plus I'll wrap the callback functions into <code>Promises</code> and use <code>Promise.all</code>.</p>

<p><em>Example :</em></p>

<pre><code>  /**
   * I love cats!
   */
  function loveCats() {
    return new Promise((resolve, reject) =&gt; {
      models.DansokHist.max('SerialNo', {
        where: { DansokSeqNo: dansokSeqNo }
      })
       .then(max =&gt; resolve(!max ? 1 : max + 1))
       .error(err =&gt; reject({
          status: 400,
          message: 'select dansokhisttbl failed.',
        }));
    });
  }

  /**
   * I love dogs!
   */
  function loveDogs() {
    // ...
  }

  Promise.all([
    loveCats,
    loveDogs,
    ...
  ])
   .then((allRets) =&gt; {
     // Handle the rets
   })
   .catch((err) =&gt; {
     // Handle the errors
   });
</code></pre>

<hr>

<p>Even better you can use new supported features <code>async/await</code>.</p>

<pre><code>  /**
   * I love cats!
   */
  function loveCats() {
    return new Promise((resolve, reject) =&gt; {
      models.DansokHist.max('SerialNo', {
        where: { DansokSeqNo: dansokSeqNo }
      })
       .then(max =&gt; resolve(!max ? 1 : max + 1))
       .error(err =&gt; reject({
          status: 400,
          message: 'select dansokhisttbl failed.',
        }));
    });
  }

  /**
   * I love dogs!
   */
  function loveDogs() {
    // ...
  }

  try {
    const allRets = await Promise.all([
      loveCats,
      loveDogs,
      ...
    ]);

    // Handle the rets
  } catch (err) {
    // Handle the errors
  }
</code></pre>
"
"Elixir rename imported function to alias","<p>Let's say I am testing a function belonging to Utils module like this</p>

<pre><code>defmodule Test do
  alias Module.Utils

  test ""test 1"" do
    Utils.some_function?(...)
  end

  test ""test 2"" do
    Utils.some_function?(...)
  end
end
</code></pre>

<p>Can I refactor or simplify that function into something like:</p>

<pre><code>import Utils.some_function as test_func()
</code></pre>

<p>So I dont have to write module name and simplify function name</p>
","<p>You cannot rename a function while importing it.</p>

<p>You can use <code>defdelegate</code> to create a local function that calls another module's function like this:</p>

<pre><code>defmodule A do
  def just_add_these_two_numbers(a, b), do: a + b
end

defmodule B do
  defdelegate add(a, b), to: A, as: :just_add_these_two_numbers
  # `add/2` is now the same as `A.just_add_these_two_numbers/2`.

  def test do
    IO.inspect add(1, 2) == 3
  end
end

B.test #=&gt; true
</code></pre>

<p>Although you might as well just do this instead (it's even shorter):</p>

<pre><code>def add(a, b), do: A.just_add_these_two_numbers(a, b)
</code></pre>
"
"Why jQuery's Promise.reject does not working?","<p>I am working with REST API, similar to this stub: <a href=""https://gitlab.com/snippets/1687097"" rel=""nofollow noreferrer"">Snippet 1</a> (Ruby on Rails example).</p>

<p>I have existing jQuery-code on classic callbacks: <a href=""https://gitlab.com/snippets/1687096"" rel=""nofollow noreferrer"">Snippet 2</a></p>

<p>which is executes with logs: </p>

<pre class=""lang-none prettyprint-override""><code>case 1:
[INFO] /api/my/action1: got rejecting signal, do not continue 

case 2:
[INFO] /api/my/action1: no rejecting signal, continue
[INFO] /api/my/action2: no rejecting signal, continue
[INFO] /api/my/action3: hurrah!! we got message:  Third action executed!

case 3:
[INFO] /api/my/action1: no rejecting signal, continue
[ERROR] Got error with message: Unexpected error
</code></pre>

<p>I want to refactor this code to promises:</p>

<pre><code>function ajxGet(url){
  return $.ajax({
    url,
    dataType: 'JSON'
  })
}

export function makeThreeAsyncQueries(){
  ajxGet('/api/my/action1')
    .then(response1 =&gt; {
      if(response1.do_reject_other_actions){
        console.log('[INFO] /api/my/action1: got rejecting signal, do not continue');
        return Promise.reject({mute: true});
      }else{
        console.log('[INFO] /api/my/action1: no rejecting signal, continue');
        return ajxGet('/api/my/action2');
      }
    })
    .then(response2 =&gt; {
      if(response2.do_reject_other_actions){
        console.log('[INFO] /api/my/action2: got rejecting signal, do not continue');
        return Promise.reject({mute: true});
      }else{
        console.log('[INFO] /api/my/action2: no rejecting signal, continue');
        return ajxGet('/api/my/action3');
      }
    })
    .then(response3 =&gt; {
      console.log('[INFO] /api/my/action3: hurrah!! we got message: ', response3.message);
    })
    .fail((err) =&gt; {
      if(err &amp;&amp; err.mute){
        console.log('[INFO] normal chain break.');
        return
      }
      console.info('[ERROR] Got error with message:', err.responseJSON.message);
    });
}
</code></pre>

<p>The problem is that <code>Promise.reject({mute: true});</code> does not working, and I have these logs: </p>

<pre class=""lang-none prettyprint-override""><code>[INFO] /api/my/action1: got rejecting signal, do not continue           &lt;&lt;-- SHOULD STOP HERE
[INFO] /api/my/action2: no rejecting signal, continue
   Uncaught (in promise) Object {mute: true}
   &lt;...callstack here...&gt;
[INFO] /api/my/action3: hurrah!! we got message:  Third action executed!
</code></pre>
","<p>In your example, you are using <a href=""https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"" rel=""nofollow noreferrer"">Promise</a> from <a href=""http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects"" rel=""nofollow noreferrer"">ECMAScript 2015 specification</a> instead of jQuery's <a href=""http://api.jquery.com/category/deferred-object/"" rel=""nofollow noreferrer"">Deferred</a> promise-like object.</p>

<p>So instead of this line:</p>

<pre><code>return Promise.reject({mute: true});
</code></pre>

<p>Use this:</p>

<pre><code>return $.Deferred().reject({ mute: true }) 
</code></pre>

<p>Full example of code:</p>

<pre><code>function ajxGet(url){
  return $.ajax({
    url,
    dataType: 'JSON'
  })
}

export function makeThreeAsyncQueries(){
  ajxGet('/api/my/action1')
    .then(response1 =&gt; {
      if(response1.do_reject_other_actions){
        console.log('[INFO] /api/my/action1: got rejecting signal, do not continue');
        return $.Deferred().reject({ mute: true })
      }else{
        console.log('[INFO] /api/my/action1: no rejecting signal, continue');
        return ajxGet('/api/my/action2');
      }
    })
    .then(response2 =&gt; {
      if(response2.do_reject_other_actions){
        console.log('[INFO] /api/my/action2: got rejecting signal, do not continue');
        return $.Deferred().reject({ mute: true })
      }else{
        console.log('[INFO] /api/my/action2: no rejecting signal, continue');
        return ajxGet('/api/my/action3');
      }
    })
    .then(response3 =&gt; {
      console.log('[INFO] /api/my/action3: hurrah!! we got message: ', response3.message);
    })
    // as argument here we will get jquery's xhr object on AJAX-error, or will get payload sent by $.deferred().reject
    .fail((xhr) =&gt; {
      if(xhr &amp;&amp; xhr.mute){
        console.log('[INFO] normal chain break.');
        return
      }
      console.info('[ERROR] Got error with message:', xhr.responseJSON.message);
    });
}
</code></pre>

<p>So when backend will return <code>do_reject_other_actions === true</code> chain will break and you will get this correct logs:</p>

<pre class=""lang-none prettyprint-override""><code>[INFO] /api/my/action1: got rejecting signal, do not continue
[INFO] normal chain break.

or

[INFO] /api/my/action1: no rejecting signal, continue
[INFO] /api/my/action2: got rejecting signal, do not continue
[INFO] normal chain break.

or

[INFO] /api/my/action1: no rejecting signal, continue
[INFO] /api/my/action2: no rejecting signal, continue
[INFO] /api/my/action3: hurrah!! we got message:  Third action executed!

or

[INFO] /api/my/action1: no rejecting signal, continue
[ERROR] Got error with message: Unexpected error 
</code></pre>

<h1>SOLUTION 2</h1>

<p>If you want to use <a href=""https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"" rel=""nofollow noreferrer"">ECMAScript2015 Promise</a>, you can wrap jQuery's <code>ajax</code> into <a href=""https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"" rel=""nofollow noreferrer"">Promise</a>:</p>

<pre><code>function ajxGet(url){
  return new Promise((resolve, reject) =&gt; {
    $.ajax({
      url,
      dataType: 'JSON',
      success: response =&gt; resolve(response),
      error: (xhr) =&gt; { reject(xhr) },
    })
  });
}

export function makeThreeAsyncQueries(){
  ajxGet('/api/my/action1')
    .then(response1 =&gt; {
      if(response1.do_reject_other_actions){
        console.log('[INFO] /api/my/action1: got rejecting signal, do not continue');
        return Promise.reject({mute: true});
      }else{
        console.log('[INFO] /api/my/action1: no rejecting signal, continue');
        return ajxGet('/api/my/action2');
      }
    })
    .then(response2 =&gt; {
      if(response2.do_reject_other_actions){
        console.log('[INFO] /api/my/action2: got rejecting signal, do not continue');
        return Promise.reject({mute: true});
      }else{
        console.log('[INFO] /api/my/action2: no rejecting signal, continue');
        return ajxGet('/api/my/action3');
      }
    })
    .then(response3 =&gt; {
      console.log('[INFO] /api/my/action3: hurrah!! we got message: ', response3.message);
    })
    .catch((xhr) =&gt; {
      if(xhr &amp;&amp; xhr.mute){
        console.log('[INFO] normal chain break.');
        return
      }
      console.info('[ERROR] Got error with message:', xhr.responseJSON.message);
    });
}
</code></pre>

<p>Note that instead of <code>fail(...)</code> you will need to use <code>catch(...)</code> at the end of chain, because <a href=""http://api.jquery.com/deferred.fail/"" rel=""nofollow noreferrer""><code>fail</code></a> is jQuery Deferred's method. </p>
"
"Induction hypothesis for free variables of closed term in the simply typed lambda calculus","<p>I am trying to formalize the simply typed lambda calculus in Coq and have a problem stating the lemma that the set of free variables of a well-typed expression in an empty context is empty.</p>

<p>Here is the relevant part of may formalisation.</p>

<pre><code>Require Import Coq.Arith.Arith.
Require Import Coq.MSets.MSets.
Require Import Coq.FSets.FMaps.

Inductive type : Set :=
| tunit : type
| tfun : type -&gt; type -&gt; type.

Module Var := Nat.
Definition var : Set := Var.t.
Module VarSet := MSetAVL.Make Var.
Module VarSetFacts := MSetFacts.Facts VarSet.
Module VarSetProps := MSetProperties.Properties VarSet.
Module Context := FMapWeakList.Make Var.
Module ContextFacts := FMapFacts.Facts Context.
Module ContextProps := FMapFacts.Properties Context.
Definition context := Context.t type.
Definition context_empty : context := Context.empty type.

Inductive expr : Set :=
| eunit : expr
| evar : var -&gt; expr
| eabs : var -&gt; type -&gt; expr -&gt; expr
| eapp : expr -&gt; expr -&gt; expr.

Fixpoint free_vars (e : expr) : VarSet.t :=
  match e with
  | eunit =&gt; VarSet.empty
  | evar y =&gt; VarSet.singleton y
  | eabs y _ e =&gt; VarSet.remove y (free_vars e)
  | eapp e1 e2 =&gt; VarSet.union (free_vars e1) (free_vars e2)
  end.

Inductive has_type : context -&gt; expr -&gt; type -&gt; Prop :=
| has_type_unit : forall c,
    has_type c eunit tunit

| has_type_var : forall c x t,
    Context.find x c = Some t -&gt;
    has_type c (evar x) t

| has_type_abs : forall c x t1 t2 e,
    has_type (Context.add x t1 c) e t2 -&gt;
    has_type c (eabs x t1 e) (tfun t1 t2)

| has_type_app : forall c e1 e2 t1 t2,
    has_type c e1 (tfun t1 t2) -&gt;
    has_type c e2 t1 -&gt;
    has_type c (eapp e1 e2) t2.

Check has_type_ind.

Lemma has_type_empty_context_free_vars : forall e t,
  has_type context_empty e t -&gt;
  VarSet.Empty (free_vars e).
Proof.
  intros e t H.
  remember context_empty as c.
  induction H; subst.
  - apply VarSet.empty_spec.
  - rewrite ContextFacts.empty_o in H.
    congruence.
  - simpl.
    admit. (* Wrong induction hypothesis *)
  - simpl.
    rewrite VarSetProps.empty_union_1; auto.
Admitted.
</code></pre>

<p>The problem seems to be that my induction hypothesis is wrong. It merely says</p>

<pre><code>Context.add x t1 context_empty = context_empty -&gt;
  VarSet.Empty (free_vars e)
</code></pre>

<p>which is trivially true, since the hypothesis is false. I tried an induction over the expression and to reformulate the theorem to get the right induction hypothesis, but could not figure it out.</p>

<p>What is the correct way to define and prove this property?</p>

<h1>Solution</h1>

<p>Following Yves' <a href=""https://stackoverflow.com/a/47608334/823955"">answer</a> and thanks to ejgallego's comment, I first proved a generalized lemma.</p>

<pre><code>Lemma has_type_free_vars_in_context : forall c e t,
  has_type c e t -&gt;
  VarSet.For_all (fun x =&gt; Context.mem x c = true) (free_vars e).
Proof.
  intros c e t H.
  induction H; simpl.
  - intros x contra.
    apply VarSetFacts.empty_iff in contra.
    inversion contra.
  - intros y H2.
    apply Context.mem_1.
    apply ContextFacts.in_find_iff.
    apply VarSet.singleton_spec in H2.
    subst.
    rewrite H.
    discriminate.
  - intros y H2.
    unfold VarSet.For_all in *.
    apply VarSet.remove_spec in H2 as [H2 H3].
    specialize (IHhas_type y H2).
    rewrite ContextFacts.add_neq_b in IHhas_type; auto.
  - intros x H2.
    apply VarSet.union_spec in H2 as [H2 | H2]; auto.
Qed.
</code></pre>

<p>And used to use it to prove my theorem.</p>

<pre><code>Lemma has_type_empty_context_free_vars : forall e t,
  has_type context_empty e t -&gt;
  VarSet.Empty (free_vars e).
Proof.
  intros e t H.
  apply has_type_free_vars_in_context in H.
  induction (free_vars e) using VarSetProps.set_induction.
  - assumption.
  - rename t0_1 into s.
    rename t0_2 into s'.
    apply VarSetProps.Add_Equal in H1.
    unfold VarSet.For_all in *.
    specialize (H x).
    rewrite H1 in H.
    specialize (H (VarSetFacts.add_1 s eq_refl)).
    Search (Context.empty).
    rewrite ContextFacts.empty_a in H.
    discriminate.
Qed.
</code></pre>

<p>It now works. Thank you very much. Is there a way to refactor this solution for more automation, better readability, better maintenance, etc.?</p>
","<p>You were right to perform induction on the hypothesis of statement ""has_type ..."", but you probably need to load the induction.  In other words, you need to prove a stronger statement, make the environment a variable, and express that the set of free variables in <code>e</code> must be inside the variables that have a type in your context.</p>
"
"Cannot create FactoryGirl's factory for model","<p>I have this situation with legacy project. Suppose I have rails model: </p>

<pre><code>rails g model entity name:string
</code></pre>

<p>In that model there is <code>MAIN_ENTITY</code> constant:</p>

<pre><code>class Entity &lt; ActiveRecord::Base  
  MAIN_ENTITY_ID = 1
  MAIN_ENTITY = Entity.find(MAIN_ENTITY_ID)
end
</code></pre>

<p>Now I want to cover <code>Entity</code>-model with <a href=""http://rspec.info/"" rel=""nofollow noreferrer"">rspec</a> tests, but first I need factory. I created this factory: </p>

<pre><code>FactoryGirl.define do
  factory :entity do
    name { FFaker::Company.name }
  end
end
</code></pre>

<p>And when I running <code>create(:entity)</code> inside <a href=""http://rspec.info/"" rel=""nofollow noreferrer"">rspec</a> test, I am getting this error: </p>

<pre class=""lang-none prettyprint-override""><code>Failure/Error: MAIN_ENTITY = Entity.find(MAIN_ENTITY_ID)

ActiveRecord::RecordNotFound:
  Couldn't find Entity with 'id'=1
</code></pre>

<p>How to fix that without refactoring code and keeping <code>MAIN_ENTITY</code> constant?</p>
","<h3>Solution without refactoring (hack)</h3>

<p>Ruby constants initializing before you access the static context of class. So, when you calling <code>Entity</code> class (manually or by using FactoryGirl), in background there is SQL query, which is trying to find record with <code>id == 1</code>. </p>

<p>In case of production, this code is working, but when you writing tests, your database usually is cleaning up after each test case run (rspec's <code>it</code>). So solution would be to create 'main entity' before each test case run in empty database:</p>

<pre><code># Your DatabaseCleaner initializer file
RSpec.configure do |config|
  # ...
  config.around(:each) do |example|
    DatabaseCleaner.cleaning do
      FactoryGirl.create_main_entity
      example.run
    end
  end
end
</code></pre>

<p>In <code>create_main_entity</code> method we have limitation here: we cannot use <code>Entity.create</code> or <code>Entity.new</code> methods, so we should use more low level solution: we need to make <code>INSERT</code> query directly into database. I would rewrite your <code>entities.rb</code>-factory like this:</p>

<pre><code>FactoryGirl.define do
  factory :entity do
    name { FFaker::Company.name }
  end
end


module FactoryGirl
  def self.create_main_entity
    connection = ActiveRecord::Base.connection

    values = {
      id: 1,
      name: 'MAIN ENTITY',
      created_at: Time.now.to_s(:db),
      updated_at: Time.now.to_s(:db)
    }

    sql = &lt;&lt;-SQL
      INSERT INTO entities (#{values.keys.map {|k| k.to_s}.join(', ')})
      VALUES(#{values.values.map{""'%s'""}.join(', ')})
    SQL

    connection.insert(sql % values.values)
  end
end
</code></pre>

<h3>Better solution with refactoring</h3>

<p>My code above is temporary solution. I would recommend you to refactor your <code>Entity</code> model. Instead of initializing constant by finding record, you can use static method:</p>

<pre><code>class Entity &lt; ActiveRecord::Base
  MAIN_ENTITY_ID = 1

  def self.main_entity
    @@main_entity ||= Entity.find(MAIN_ENTITY_ID)
  end
end
</code></pre>

<p>I used memorization here <code>@@main_entity ||= ...</code> to avoid executing same SELECT-query on each <code>Entity.main_entity</code> call.</p>
"
"Ionic3, AngularFire - Property 'remove' does not exist on type 'Observable<any[]>'","<p>I have been following an outdated tutorial (<a href=""https://www.youtube.com/watch?v=UHTBnTg4rno&amp;list=PLtKjv92L0ihAJ90_NbqCINRu4uKy3RJJU&amp;index=13"" rel=""nofollow noreferrer"">this playlist in particular</a>) and I got lost switching between AngularFire 4.0 and AngularFire 5.0.
It's a simple CRUD application which implements Firebase.
The code is uncouth, but I am able to view and post to the database.</p>

<p>
I'm trying to delete an item from a node using the key in firebase, but I'm getting the error </p>

<p><code>Property 'remove' does not exist on type 'Observable&lt;any[]&gt;'.</code></p>

<p>Here is my <code>.ts</code> file:</p>

<pre><code>import { Component } from '@angular/core';
import { IonicPage, NavController, NavParams, ActionSheetController } from 'ionic-angular';
import { AngularFireList, AngularFireDatabase } from 'angularfire2/database';
import { Matatu } from '../../models/matatu/matatu.interface';
import { Observable } from 'rxjs/Observable';

@IonicPage()
@Component({
  selector: 'page-owner-dash',
  templateUrl: 'owner-dash.html',
})

export class OwnerDashPage {

  matatuListRef$: Observable&lt;any[]&gt;;

  constructor(public navCtrl: NavController, public navParams: NavParams, private database: AngularFireDatabase, public actionShtCrtl: ActionSheetController) {
    this.matatuListRef$ = this.database.list('matatu-list').valueChanges();

  }

  ionViewDidLoad() {
    //
  }

  selectMatatu(matatu: Matatu){
    this.actionShtCrtl.create({
      title: `${matatu.matNumberPlate}`,
      buttons: [
        {
          text: 'Edit',
          handler: () =&gt; {
            //
          }          
        },
        {
          text: 'Delete',
          role: 'destructive',
          handler: () =&gt; {
            this.matatuListRef$.remove(matatu.$key);
          }
        },
        {
          text: 'Cancel',
          role: 'cancel',
          handler: () =&gt; {
            //
          }
        }
      ]
    }).present();
  }


}
</code></pre>

<p>And here the <code>.html</code> code that displays the records.</p>

<pre><code>...
&lt;ion-list&gt;
    &lt;button ion-item *ngFor=""let ma3 of matatuListRef$ | async"" (click)=""selectMatatu(ma3)""&gt;
      &lt;h2 style=""font-weight: bold;""&gt;{{ma3.matNumberPlate}}&lt;/h2&gt;
      &lt;h3&gt;Driver: {{ma3.matDriver}}&lt;/h3&gt;
      &lt;h3&gt;Status: {{ma3.matStatus}}&lt;/h3&gt;
    &lt;/button&gt;
  &lt;/ion-list&gt;
...
</code></pre>

<p>
I know <code>FirebaseListObservable</code> was refactored to <code>AngularFireList</code>, but I assigned my variable to the type <code>Observable</code> instead.</p>

<p><code>matatuListRef$: Observable&lt;any[]&gt;;</code></p>

<p>Bottom line, I get the error <code>TypeError: _this.matatuListRef$.remove is not a function</code> on the browser's console when I try to delete the record.</p>

<p>How can I resolve this? 
All suggestions and approaches are highly welcomed,but I would really appreciate it if the solutions focused on using <code>AngularFireList</code>.</p>
","<p><code>remove()</code> function is present on the list reference retrieved from Firebase and <em>not the Observable</em> from <code>valueChanges()</code>.</p>

<p>You need to set </p>

<pre><code>this.matatuListRef$ = this.database.list('matatu-list');
</code></pre>

<p>Secondly, you will not get <code>$key</code> from <code>valueChanges()</code> either. You need to use <code>snapshotChanges()</code> in order to retrieve keys and values.</p>

<pre><code>this.matatuListAsync = this.matatuListRef$.snapshotChanges();
</code></pre>

<p>instead of </p>

<pre><code>this.matatuListRef$ = this.database.list('matatu-list').valueChanges();
</code></pre>

<p>You can  use <code>this.matatuListAsync</code> in the <code>*ngFor</code> in the HTML</p>

<pre><code>&lt;ion-list&gt;
    &lt;button ion-item *ngFor=""let ma3 of matatuListAsync$ | async"" (click)=""selectMatatu(ma3)""&gt;
      &lt;h2 style=""font-weight: bold;""&gt;{{ma3.payload.val().matNumberPlate}}&lt;/h2&gt;
      &lt;h3&gt;Driver: {{ma3.payload.val().matDriver}}&lt;/h3&gt;
      &lt;h3&gt;Status: {{ma3.payload.val().matStatus}}&lt;/h3&gt;
    &lt;/button&gt;
  &lt;/ion-list&gt;
</code></pre>

<p>and finally in your <code>remove()</code> call,</p>

<pre><code>        this.matatuListRef$.remove(matatu.payload.$key);
</code></pre>
"
"Add data to DataTable-Bootstrap","<p>I need to know how to add data from  database to DataTable-Bootstrap</p>

<p>This is my table:</p>

<pre><code>&lt;div class=""container""&gt;
&lt;button id=""addRow""&gt;Add new row&lt;/button&gt;
 &lt;table id=""example"" class=""display"" cellspacing=""0"" width=""100%""&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;Column 1&lt;/th&gt;
            &lt;th&gt;Column 2&lt;/th&gt;
            &lt;th&gt;Column 3&lt;/th&gt;

        &lt;/tr&gt;
    &lt;/thead&gt; 
&lt;/table&gt;
&lt;/div&gt;
</code></pre>

<p>I have a script that add from my database the data automatically to DataTable-Bootstrap</p>

<pre><code>&lt;script&gt;
var tblusuario = document.getElementById('example');
var databaseRef = firebase.database().ref('Usuarios/');
//var databaseRef = FirebaseFirestore.database().ref('/users');
var rowindex = 1;

databaseRef.once('value', function(snapshot) {
    snapshot.forEach(function(childSnapshot) {

        var childKey = childSnapshot.key;
        var childData = childSnapshot.val();

        var row = tblusuario.insertRow(rowindex);
        var cellIndice= row.insertCell(0);
        var cellId = row.insertCell(1);
        var cellNombre = row.insertCell(2);


        cellIndice.innerHTML=rowindex;
        cellId.appendChild(document.createTextNode(childKey));
        cellNombre.appendChild(document.createTextNode(childData.usuario));

            rowindex = rowindex + 1;


    });
});
</code></pre>

<p></p>

<p><strong>BUT THE TABLE DOES NOT RECOGNIZE IT</strong>, I can't use the use the functionalities of DataTable</p>

<p><a href=""https://i.stack.imgur.com/Xy4o3.png"" rel=""nofollow noreferrer"">See the table</a></p>

<p>After this, I have been studying for 3 days to change the code to put it in the table</p>

<p>I have took this reference(it's okey)</p>

<pre><code>   &lt;button id=""addRow""&gt;Add new row&lt;/button&gt;
   &lt;script&gt;

   $(document).ready(function() {
   var t = $('#example').DataTable();
   var counter = 1;

   $('#addRow').on( 'click', function () {
    t.row.add( [
        counter +'.1',
        counter +'.2',
        counter +'.3',

    ] ).draw( false );

       counter++;
   } );

   // Automatically add a first row of data
   $('#addRow').click();
    } );
</code></pre>

<p></p>

<p>So far, I want to refactor my code in order funtion to dataTable</p>

<p>I have this, but it doesn¬¥t work :(</p>

<pre><code>&lt;script&gt;


$(document).ready(function() {
var t = $('#example').DataTable();
var counter = 1;
var databaseRef = firebase.database().ref('Usuarios/');
var rowindex = 1;
 databaseRef.once('value', function(snapshot) {
snapshot.forEach(function(childSnapshot) {
var childKey = childSnapshot.key;
var childData = childSnapshot.val();

var addhere = childKey;
var b = childData.usuario;

            });
    });

  $('#addRow').on( 'click', function () {

    t.row.add( [
        addhere,//PROBLEM
        'hola',
        '.3',
    ] ).draw( false );


   } );

  // Automatically add a first row of data
  $('#addRow').click();
 } );
</code></pre>

<p></p>

<p>Someone can help me with the code?
Thanks</p>
","<p>By seeing your code it seems you are using <a href=""https://firebase.google.com/docs/web/setup"" rel=""nofollow noreferrer"">Firebase JavaScript client SDK</a>. So what you can do is retrieve the data from firebase and then inject it to DataTables.</p>

<pre><code>databaseRef.once('value', function(snapshot) {
  $('#example').DataTable({
    data : snapshot.val()  
  });
});
</code></pre>

<p>You need to keep one thing in mind that data that is being send by the firebase should be in context with the <a href=""https://datatables.net/manual/data/#Data-source-types"" rel=""nofollow noreferrer"">DataTables Data source types
</a>, otherwise you have to use <a href=""https://datatables.net/reference/option/columns.data"" rel=""nofollow noreferrer"">columns.data</a> or <a href=""https://datatables.net/reference/option/columns.render"" rel=""nofollow noreferrer"">columns.render</a> to modify the received data.</p>
"
"Redux Form - initialValues not updating when using compose","<p>reference: <a href=""https://redux-form.com/6.7.0/examples/initializefromstate/"" rel=""nofollow noreferrer"">https://redux-form.com/6.7.0/examples/initializefromstate/</a></p>

<p>I am trying to implement a profile form that updates with initial data that is fetched from an api endpoint.</p>

<p>I've been able to get the example to work when referencing the redux-form example above. However when I refactor it to use compose 'initialValues' does not get inserted into the fields. </p>

<p>This code does not work, initialValues contains data but does not insert into form fields.</p>

<pre><code>export default compose(
    reduxForm({
        form: 'initializeFromState',
        enableReinitialize : true
    }),
    connect(state =&gt; ({
        initialValues: state.profile, // pull initial values from account reducer
    }), actions)
)(EditProfile);
</code></pre>

<p>However this code works which is just slightly modified from reference example. 'initialValues' also contains data.</p>

<pre><code>EditProfile = reduxForm({
    form: 'initializeFromState', 
    enableReinitialize: true
})(EditProfile);

EditProfile = connect(
    state =&gt; ({
        initialValues: state.profile, 
    }),
    actions, 
)(EditProfile);

export default EditProfile;
</code></pre>

<p>It's looks similar to me but maybe I can't use compose like this? </p>
","<p>You're passing the arguments to <code>compose</code> in the wrong order. Composed functions execute from the end toward the beginning. So you'll need to reverse the order to have the equivalent of what you've got in the second example:</p>

<pre><code>export default compose(
    connect(state =&gt; ({
        initialValues: state.profile, // pull initial values from account reducer
    }), actions),
    reduxForm({
        form: 'initializeFromState',
        enableReinitialize : true
    })
)(EditProfile);
</code></pre>
"
"Swagger2 too many the same annotations","<p>I integrate swagger2 to springboot project, because all of my endpoints authorization is by OAuth2, so I need to add Authorization header to every method, like the following code:</p>

<pre><code>@ApiImplicitParams({     
    @ApiImplicitParam(paramType=""header"",name=""Authorization"",dataType=""String"",required=true, value=""Bearer {access-token}"")
})
</code></pre>

<p>These same annotations are too many, can I have some ways to refactor them?</p>

<p>Swagger2 Docket code:</p>

<pre><code>@Bean
public Docket createRestApi() {
    return new Docket(DocumentationType.SWAGGER_2)
            .apiInfo(apiInfo())
            .ignoredParameterTypes(TokenInfo.class, HttpServletRequest.class, HttpServletResponse.class)
            .select()
            .apis(RequestHandlerSelectors.basePackage(""com.xxx.yyy.resource""))
            .paths(PathSelectors.any())
            .build();
}
</code></pre>
","<p>I spend couple of days to find out the solution. Here I give you the docket config for <code>access_token</code>. Configure a global parameter, can say common parameters (<code>access_token</code>) that includes every end-point.So you don't need to include <code>@ApiImplicitParams</code> to every end-point. Probable docket configuration given below (later your can change of your own for <strong>api info</strong>).</p>

<pre><code>@Bean
public Docket api() {
    return new Docket(DocumentationType.SWAGGER_2)
            .select()
            .apis(RequestHandlerSelectors.basePackage(""com.xxx.yyy.resource""))
            .paths(PathSelectors.any())
            .build()
            .globalOperationParameters(commonParameters())
            .apiInfo(apiInfo())
            .ignoredParameterTypes(TokenInfo.class, HttpServletRequest.class, HttpServletResponse.class)
            .securityContexts(Lists.newArrayList(securityContext()))
            .securitySchemes(Lists.newArrayList(apiKey()));
}


private List&lt;Parameter&gt; commonParameters() {
    List&lt;Parameter&gt; parameters = new ArrayList&lt;Parameter&gt;();
    parameters.add(new ParameterBuilder()
            .name(""access_token"")
            .description(""token for authorization"")
            .modelRef(new ModelRef(""string""))
            .parameterType(""query"")
            .required(true)
            .build());

    return parameters;
}

private ApiInfo apiInfo() {
    ApiInfo apiInfo = new ApiInfo(
            ""My REST API"",
            ""Some custom description of API."",
            ""API TOS"",
            ""Terms of service"",
            ""myeaddress@company.com"",
            ""License of API"",
            ""API license URL"");
    return apiInfo;
}

private SecurityContext securityContext() {
    return SecurityContext.builder()
            .securityReferences(defaultAuth())
            .forPaths(PathSelectors.any())
            .build();
}

List&lt;SecurityReference&gt; defaultAuth() {
    AuthorizationScope authorizationScope
            = new AuthorizationScope(""global"", ""accessEverything"");
    AuthorizationScope[] authorizationScopes = new AuthorizationScope[1];
    authorizationScopes[0] = authorizationScope;
    return Lists.newArrayList(
            new SecurityReference(""AUTHORIZATION"", authorizationScopes));
}

private ApiKey apiKey() {
    return new ApiKey(""AUTHORIZATION"", ""access_token"", ""header"");
}
</code></pre>

<p>Just paste the code and try from <code>swagger-ui</code> and let me know the status.</p>
"
"Distinct Values using Set","<p>I have been using </p>

<pre><code>      &lt;FormGroup&gt;
        &lt;Campaign
          campaignName={this.campaignName.bind(this)}
          campaignOptions={[...new Set(this.props.records.map(options =&gt; options.campaign))]}/&gt;
      &lt;/FormGroup&gt;
</code></pre>

<p>to get a unique array for a dropdown option, however I now need to pass an array with each object in it having a label and a value. </p>

<p>I have refactored the code as follows, </p>

<pre><code>   &lt;FormGroup&gt;
        &lt;Campaign
          campaignName={this.campaignName.bind(this)}
          campaignOptions={[...new Set(this.props.records.map(options =&gt; {
            return {value: options.campaign, label: options.campaign };
          }))]}/&gt;
      &lt;/FormGroup&gt;
</code></pre>

<p>...but the unique element is now not working (see below with duplicates). What am I doing wrong please?</p>

<p>The input array looks like...</p>

<pre><code>    [
    1. 0:{_id: ""zWTiLEjqrCKdxTvze"", owner: ""K7xTxu7PRDCuhFZRC"", company_ID: ""1"", campaign: ""newevent"", ‚Ä¶}
    2. 1:{_id: ""SkZzDMAWokFFYEycp"", owner: ""K7xTxu7PRDCuhFZRC"", company_ID: ""1"", campaign: ""instagramlaunch"", ‚Ä¶}
    3. 2:{_id: ""p4pychanC5Zw8iWAQ"", owner: ""K7xTxu7PRDCuhFZRC"", company_ID: ""1"", campaign: ""stuffinhere"", ‚Ä¶}
       ‚Ä¶ more in here including more than 1 object with instagram launch for example
    ]
</code></pre>

<p>Original approach resulted in Array of...</p>

<pre><code>    0:""newevent""
    1:""sheffieldevent""
    2:""stuffinhere""
    3:‚Äùinstagramlaunch""
    4:‚Äùanothertest""
    5:‚Äùyetanother""
</code></pre>

<p>now results in...</p>

<pre><code>    0:{value: ""newevent"", label: ""newevent""}
    1:{value: ""sheffieldevent"", label: ""sheffieldevent""}
    2:{value: ""stuffinhere"", label: ""stuffinhere""}
    3:{value: ""instagramlaunch"", label: ""instagramlaunch""}
    4:{value: ""instagramlaunch"", label: ""instagramlaunch""}
    5:{value: ""instagramlaunch"", label: ""instagramlaunch‚Äù}
    6:{value: ""anothertest"", label: ""anothertest‚Äù}
    7:{value: ""yetanother"", label: ""yetanother""}
</code></pre>
","<p>I resolved this using lodash...</p>

<pre><code>    campaignOptions={_.uniqBy(this.props.records.map((options,index) =&gt; {return { value: index, label: options.campaign }}),'label')}/&gt;
</code></pre>
"
"Using async await properly in node js","<p>To overcome callback hell in javascript, I'm trying to use async await from legacy code written in SQLServer procedure.
But I'm not sure my code might be write properly.</p>

<p>My first confusing point is when async function returns, should it return resolve() as boolean, or just return reject and handle with try-catch?</p>

<p>Here is my code snippets.
Please correct me to right direction.</p>

<p>apiRoutes.js</p>

<pre><code>app.route('/api/dansok/cancelDansok')
    .post(dansokCancelHandler.cancelDansok);
</code></pre>

<p>dansokCancelController.js</p>

<pre><code>const sequelize = models.Sequelize;
const jwt = require('jsonwebtoken');

async function jwtAccessAuthCheck(accessToken) {
  if (!accessToken) {
    return Promise.reject('Empty access token');
  }

  jwt.verify(accessToken,""dipa"",function(err){
    if(err) {
      return Promise.reject('TokenExpiredError.');
    } else {
      return Promise.resolve();
    }
  });
}

async function checkFeeHist(dansokSeqNo) {
  let feeHist = await models.FeeHist.findOne({  
                  where: { DansokSeqNo: dansokSeqNo}
                });
  return !!feeHist;
}

async function getNextDansokHistSerialNo(dansokSeqNo) {
  ....
}

async function getDansokFee(dansokSeqNo) {
  ....
}

async function doCancel(dansokSeqNo) {
  try {
    if (await !checkFeeHist(dansokSeqNo)) {
      log.error(""doCancel() invalid dansokSeqNo for cancel, "", dansokSeqNo);
      return;
    }
    let nextDansokSerialNo =  await getNextDansokHistSerialNo(dansokSeqNo);
    await insertNewDansokHist(dansokSeqNo, nextDansokSerialNo);
    await updateDansokHist(dansokSeqNo);
    await updateVBankList(dansokSeqNo, danokFee.VBankSeqNo);
    await getVBankList(dansokSeqNo);
  } catch (e) {
    log.error(""doCancel() exception:"", e);
  }
}

exports.cancelDansok = function (req, res) {
  res.setHeader(""Content-Type"", ""application/json; charset=utf-8"");
  const dansokSeqNo = req.body.DANSOKSEQNO;
  const discKindCode = req.body.HISTKIND;
  const worker = req.body.PROCWORKER;
  const workerIp = req.body.CREATEIP;
  const accessToken = req.headers.accesstoken;

  //check input parameter
  if (!dansokSeqNo || !discKindCode || !worker || !workerIp) {
    let e = {status:400, message:'params are empty.'};
    return res.status(e.status).json(e);
  } 

  try {
    jwtAccessAuthCheck(accessToken)
    .then(() =&gt; {
      log.info(""jwt success"");
      doCancel(dansokSeqNo).then(() =&gt; {
        log.info(""cancelDansok() finish"");
        res.status(200).json({ message: 'cancelDansok success.' });
      });
    });
  } catch(e) {
    return res.status(e.status).json(e);
  }
};
</code></pre>
","<p>You'll need to rewrite <strong>jwtAccessAuthCheck(accessToken)</strong> so that it keeps track of the outcome of its nested tasks. In the code you've written:</p>

<pre><code>// Code that needs fixes!
async function jwtAccessAuthCheck(accessToken) {

  // This part is fine. We are in the main async flow.
  if (!accessToken) {
    return Promise.reject('Empty access token');
  }

  // This needs to be rewritten, as the async function itself doesn't know anything about
  // the outcome of `jwt.verify`... 
  jwt.verify(accessToken,""dipa"",function(err){
    if(err) {
      // This is wrapped in a `function(err)` callback, so the return value is irrelevant
      // to the async function itself
      return Promise.reject('TokenExpiredError.');
    } else {
      // Same problem here.
      return Promise.resolve();
    }
  });

  // Since the main async scope didn't handle anything related to `jwt.verify`, the content
  // below will print even before `jwt.verify()` completes! And the async call will be
  // considered complete right away.
  console.log('Completed before jwt.verify() outcome');

}
</code></pre>

<p>A better rewrite would be:</p>

<pre><code>// Fixed code. The outcome of `jwt.verify` is explicitly delegated back to a new Promise's
// `resolve` and `reject` handlers, Promise which we await for.
async function jwtAccessAuthCheck(accessToken) {
  await new Promise((resolve, reject) =&gt; {

    if (!accessToken) {
      reject('Empty access token');
      return;
    }

    jwt.verify(accessToken,""dipa"",function(err){
      if(err) {
        reject('TokenExpiredError.');
      } else {
        resolve();
      }
    });

  });

  // We won't consider this async call done until the Promise above completes.
  console.log('Completed');

}
</code></pre>

<p>An alternate signature that would also work in this specific use case:</p>

<pre><code>// Also works this way without the `async` type:
function jwtAccessAuthCheck(accessToken) {
  return new Promise((resolve, reject) =&gt; {
    ...
  });
}
</code></pre>

<hr>

<p>Regarding your <code>cancelDansok(req, res)</code> middleware, since <code>jwtAccessAuthCheck</code> is guaranteed to return a <code>Promise</code> (you made it an async function), you'll also need to handle its returned Promise directly. No try / catch can handle the outcome of this asynchronous task.</p>

<pre><code>exports.cancelDansok = function (req, res) {

  ...

  jwtAccessAuthCheck(accessToken)
    .then(() =&gt; {
      log.info(""jwt success"");
      return doCancel(dansokSeqNo);
    })
    .then(() =&gt; {
      log.info(""cancelDansok() finish"");
      res.status(200).json({ message: 'cancelDansok success.' });
    })
    .catch(e =&gt; {
      res.status(e.status).json(e);
    });

};
</code></pre>

<hr>

<p>I strongly suggest reading a few Promise-related articles to get the hang of it. They're very handy and powerful, but also bring a little pain when mixed with other JS patterns (async callbacks, try / catch...).</p>

<ul>
<li><a href=""https://www.promisejs.org/"" rel=""nofollow noreferrer"">https://www.promisejs.org/</a></li>
<li><a href=""https://nodejs.org/dist/latest-v8.x/docs/api/util.html#util_util_promisify_original"" rel=""nofollow noreferrer"">Node.js util.promisify</a></li>
</ul>
"
"Have PyCharm extract code in a Python function to a nested function","<p>I have had PyCharm 2017.3 extract some code inside a top-level function to another top-level function, and it does a good job.</p>

<p>However, sometimes I would like to not put the extracted function on top level, but rather it should become a function nested inside the existing function. The rationale is re-using code that is only used inside a function, but several times there. I think that this ""sub-function"" should ideally not be accessible outside of the original function.</p>

<p>How can I do this? I have not seen any options in the refactoring dialog.</p>

<h2>Example</h2>

<p>a) Original code:</p>

<pre><code>def foo():
    a = ''
    if a == '':
        b = 'empty'
    else:
        b = 'not empty'
    return b
</code></pre>

<p>b) What extracting does:</p>

<pre><code>def foo():
    a = ''
    b = bar(a)
    return b


def bar(a):
    if a == '':
        b = 'empty'
    else:
        b = 'not empty'
    return b
</code></pre>

<p>c) What I would like to have:</p>

<pre><code>def foo():
    def bar():
        if a == '':
            b = 'empty'
        else:
            b = 'not empty'
        return b

    a = ''
    b = bar(a)
    return b
</code></pre>

<p>I am aware that <code>bar</code>'s <code>b</code> will shadow <code>foo</code>'s <code>b</code> unless it is renamed in the process. I also thought about completely accepting the shadowing by not returning or requesting <code>b</code> and just modifying it inside <code>bar</code>.</p>

<p>Please also hint me if what I want is not a good thing for any reason.</p>
","<p>It is considered good practice to keep function boundaries isolated: get data as parameters and spit data as return values with as little side-effects as possible. That said, there are a few special cases where you break this rule; many of them when using <a href=""https://www.learnpython.org/en/Closures"" rel=""nofollow noreferrer"">closures</a>. Closures are not as idiomatic in Python as they are in Javascript - personally I think it is good but many people disagree.</p>

<p>There is one place were closures are absolutely idiomatic in Python: decorators. For other cases where you would use a closure in order to avoid use of global variables and provide some form of data hiding there are other alternatives in Python. Although some people advocates using closure instead of a class when it has just one method, a plain function combined with <a href=""https://docs.python.org/3/library/functools.html"" rel=""nofollow noreferrer"">functools.partial</a> can be even better.</p>

<p>This is my guess about why there is no such feature in Pycharm: we almost never do it in Python, instead we tend to keep the function signature as <code>foo(x)</code> even when we can get <code>x</code> from the enclosing scope. Hell, in Python our methods receive <code>self</code> explicitly where most languages have an implicit <code>this</code>. If you write code this way then Pycharm already does everything that is needed when refactoring: it fixes the indentation when you cut &amp; paste.</p>

<p>If you catch yourself doing this kind of refactoring a lot I guess you are coming from a language where closures are more idiomatic like Javascript or Lisp.</p>

<p>So my point is: this ""nested to global"" or ""global to nested"" function refactoring feature does not exist in Pycharm because nested functions relying on the enclosing scopes are not idiomatic in Python unless for closures - and even closures are not that idiomatic outside of decorators. </p>

<p>If you care enough go ahead and fill a feature request at <a href=""https://youtrack.jetbrains.com/issues/PY"" rel=""nofollow noreferrer"">their issue tracker</a> or upvote some related tickets like <a href=""https://youtrack.jetbrains.com/issue/PY-12802"" rel=""nofollow noreferrer"">#PY-12802</a> and <a href=""https://youtrack.jetbrains.com/issue/PY-2701"" rel=""nofollow noreferrer"">#PY-2701</a> - as you can see those have not attracted a lot of attention possibly because of the reasons above.</p>
"
"Can this be refactored to use generic functional principles?","<p>A comparator function <code>ascending</code> accepts two arguments - <code>a</code> and <code>b</code>. It must return an integer comparing the two.</p>

<p>I have a list that I want to sort by name, so I wrote the following functions. </p>

<p>Is there a functional idiom I can use to combine these two functions, rather than having <code>byName</code> take responsibility for composing the resulting function?</p>

<pre><code>const ascending = (a, b) =&gt; a.localeCompare(b);
const byName = (i) =&gt; i.get('name');
const useTogether = (...fns) =&gt; ...; // is there an idiomatic function like this?

// usage
items.sort(useTogether(byName(ascending))); 
</code></pre>
","<p>I'm not sure if it satisfies what you're looking for, but here is one possible formulation of your <code>useTogether</code> (with a somewhat different signature) that does WORK. I'm not aware of a standard function with precisely that effect.</p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>const ascending = (a, b) =&gt; a.localeCompare(b);
const byName = (i) =&gt; i['name'];
const useTogether = (selector, consumer) =&gt; (...fnArgs) =&gt; consumer(...fnArgs.map(selector));

var items = [{ name: ""C"" }, { name: ""A"" }, { name: ""B"" }];

console.log(
  items.sort(useTogether(byName, ascending))
)</code></pre>
</div>
</div>
</p>
"
"Exception handling: Differentiating between instances of the same error in Python","<p>What is the recommended way of separately handling exceptions of <em>the same type</em> based on differences in what caused the exception?</p>

<p>Let's say one desire to handle the following two instances of AttributeError differently:</p>

<ul>
<li><code>'str' object has no attribute 'append'</code> </li>
<li><code>'float' object has no attribute 'append'</code></li>
</ul>

<p>At the same time, we don't want to handle other attribute errors.</p>

<p>Are there are any generalizable answers that work for all exception types? Can I interrogate the exception object for details using some method or function on the exception object?</p>

<pre><code>Try:
    blah
Except AttributeError as exc:
    if exc.baz('foo') is bar:
         handle 'str' object has no attribute 'append'
    elif plugh(exc):
         handle 'float' object has no attribute 'append'
    else:
         raise exc
</code></pre>

<p>I assume that the obvious answer is to refactor. My question specifically regards the cases where that would be inefficient or simply not possible (if there are any such cases at all). </p>
","<p>You can see what methods and attributes an object has by using <a href=""https://docs.python.org/3/library/functions.html#dir"" rel=""nofollow noreferrer""><code>dir</code></a>.</p>

<p>In Python 3.6, from:</p>

<pre><code>a = 'hello'
try:
    a.append(2)
except AttributeError as e:
    print(dir(e))
</code></pre>

<p>You get:</p>

<pre><code>['__cause__', '__class__', '__context__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setstate__', '__sizeof__', '__str__', '__subclasshook__', '__suppress_context__', '__traceback__', 'args', 'with_traceback']
</code></pre>

<p>That narrows down the things we can test since we don't want a dunder, leaving only <code>args</code> and <code>with_traceback</code>. It seems then that the best you could get is to use <code>args</code> which returns the string in a tuple:</p>

<pre><code>a = 'hello'
try:
    a.append(2)
except AttributeError as e:
    if 'str' in e.args[0]:
        print('Need to handle string')
    elif 'float' in e.args[0]:
        print('Need to handle float')
</code></pre>
"
"How to use Vuex types constants with module namespace?","<p>I have this Vuex module:</p>

<pre><code>//modules/things.js
const state = {
  firstThing: 'abc',
  secondThing: 'def',
};

const getters = {
  getFirstThing: state =&gt; state.firstThing,
  getSecondThing: state =&gt; state.secondThing,
};

const mutations = {
  setFirstThing: (state, payload) =&gt; state.firstThing = payload,
  setSecondThing: (state, payload) =&gt; state.secondThing = payload
};

const actions = {};

export default {
  namespaced: true,   // &lt;------
  state,
  mutations,
  actions,
  getters
};
</code></pre>

<p>I use <code>namespaced: true</code> <a href=""https://vuex.vuejs.org/en/modules.html#namespacing"" rel=""nofollow noreferrer"">flag</a> and can work with this module like this:</p>

<pre><code>this.$store.state.things.firstThing             // &lt;-- return abc here
this.$store.commit('things/setFirstThing', 10)
this.$store.getters['things/getFirstThing']     // &lt;-- return abc here
</code></pre>

<p>If I will use constants like in Vuex <a href=""https://github.com/vuejs/vuex/blob/dev/examples/shopping-cart/store/mutation-types.js"" rel=""nofollow noreferrer"">official example</a>, and refactor my <code>modules/things.js</code> file like this:</p>

<pre><code>export const Types = {
  getters: {
    GET_FIRST_THING: 'GET_FIRST_THING',
    GET_SECOND_THING: 'GET_SECOND_THING',
  },
  mutations: {
    SET_FIRST_THING: 'SET_FIRST_THING',
    SET_SECOND_THING: 'SET_SECOND_THING',
  }
};

const getters = {
  [Types.getters.GET_FIRST_THING]: state =&gt; state.firstThing,
  [Types.getters.GET_SECOND_THING]: state =&gt; state.secondThing,
};

const mutations = {
  [Types.mutations.SET_FIRST_THING]: (state, payload) =&gt; state.firstThing = payload,
  [Types.mutations.SET_SECOND_THING]: (state, payload) =&gt; state.secondThing = payload
};
</code></pre>

<p>I will have to use namespace prefix: </p>

<pre><code>this.$store.commit('things/' + Types.mutations.SET_FIRST_THING, 10);
this.$store.getters['things/' +  + Types.getters.GET_FIRST_THING]  
</code></pre>

<p>If I will include module namespace prefix to <code>Types</code> constant, I will have to use string prefix <code>things/</code> for mutations/actions/getters declaration:</p>

<pre><code>const getters = {
  ['things/' + Types.getters.GET_FIRST_THING]: state =&gt; state.firstThing,
  ['things/' + Types.getters.GET_SECOND_THING]: state =&gt; state.secondThing,
};
</code></pre>

<p>How to avoid that?</p>
","<p>You can disable namespacing by <code>namepsaced: false</code> and just use constants with prefixes:</p>

<pre><code>export const Types = {
  getters: {
    GET_FIRST_THING: 'THINGS_GET_FIRST_THING',    // your namespace without '/' slash
    GET_SECOND_THING: 'THINGS_GET_SECOND_THING',
  },
  // ...
}
</code></pre>

<p>- it will work.</p>

<p>But if you still want to keep <code>namepsace: true</code> in module and use constants also, you can define two types of constants: <strong>public</strong> and <strong>private</strong>:</p>

<pre><code>export const Types = {                                               // &lt;-- public
  getters: {
    GET_FIRST_THING: 'GET_FIRST_THING',
    GET_SECOND_THING: 'GET_SECOND_THING',
  },
  mutations: {
    SET_FIRST_THING: 'SET_FIRST_THING',
    SET_SECOND_THING: 'SET_SECOND_THING',
  }
};

const _types = removeNamespace('things/', Types);                    // &lt;-- private
</code></pre>

<p>Then use private <code>_types</code> only inside Vuex module:</p>

<pre><code>const getters = {
  [_types.getters.GET_FIRST_THING]: state =&gt; state.firstThing,       
  [_types.getters.GET_SECOND_THING]: state =&gt; state.secondThing,
};

//...
</code></pre>

<p>and public <code>Types</code> outside module: </p>

<pre><code>// some-component.vue
this.$store.commit('things/' + Types.mutations.SET_FIRST_THING, 10);
this.$store.getters['things/' +  + Types.getters.GET_FIRST_THING]
// ...
</code></pre>

<p>Also implement simple <code>removeNamespace</code> function in your new <code>namespace-helper.js</code> file:</p>

<pre><code>export default function removeNamespace(namespace, types){
  return _.reduce(types, (typeObj, typeValue, typeName) =&gt; {
    typeObj[typeName] = _.reduce(typeValue, (obj, v, k)=&gt;{
      obj[k] = v.replace(namespace, '');
      return obj;
    }, {});
    return typeObj;
  }, {});
}
</code></pre>
"
"Switch Statement inside condition refactoring","<p>I have a piece of code that works but I do not like the way it looks. It looks clunky and messy. Is basically an if statement that has a switch statement inside.</p>

<p>Is there a way to refactor this? Maybe a well know to deal with them?</p>

<pre><code>private Direction update(Coordinates coordinate) {
    if (coordinate.isLeft()) {
        switch (coordinate.getDirection()) {
        case NORTH: return Direction.WEST;
        case SOUTH: return Direction.EASTH;
        case EASTH: return Direction.NORTH;
        case WEST: return Direction.SOUTH;
        }
    }
    if (coordinate.isRight()) {
        switch (coordinate.getDirection()) {
        case NORTH: return Direction.EASTH;
        case SOUTH: return Direction.WEST;
        case EASTH: return Direction.SOUTH;
        case WEST: return Direction.NORTH;
        }
    }
    return null;
}
</code></pre>
","<p>If you order your enum clockwise, you can walk from one to the next with a simple index:</p>

<pre><code>enum Direction {
    NORTH, EAST, SOUTH, WEST;

    public Direction rotate(boolean clockwise) {
        int nextIndex = ordinal() + (clockwise ? 1 : 3);
        return values()[nextIndex % 4];
    }
}
</code></pre>
"
"The resize function loads the page","<p>For the side menu there is a recalculation for the height: adaptive, for the tablet and for the desktop. It seems to be working more and less, but when I started testing on real devices, I noticed that everything is working too slowly because of the function of what is written in the function of resize. Do not tell me how refactor the code in a normal way, so that the speed of work on devices is faster? Thank you!</p>

<p><a href=""https://codepen.io/malinosky/pen/JOVdOG"" rel=""nofollow noreferrer"">https://codepen.io/malinosky/pen/JOVdOG</a> </p>

<pre><code> //—Ä–∞—Å—á–µ—Ç –≤—ã—Å–æ—Ç—ã body
var calcHeightFilter = function calcHeightFilter() {
    var bodyHeight = $(document).outerHeight(true);
    var asideHeight = $('.section--aside').height();

    if (($(document).width()) &lt; 768) {
        if ($('.section--aside').hasClass('open-aside')) {
            $('.js-anchor-top').css(""display"", ""none"");
            if (bodyHeight &gt; asideHeight) {
                $('body').css(""overflow"", ""hidden"");
                $('body').height(asideHeight + 169); // –ó–Ω–∞—á–µ–Ω–∏–µ 169 - —ç—Ç–æ —Ö–µ–∞–¥–µ—Ä + —Ñ—É—Ç–µ—Ä
            }
        }
    }

    if (($(document).width()) &gt;= 768 &amp;&amp; ($(document).width()) &lt;= 1023 ) {
        var tabletFilterHeight = $('.wrap-main').height();
        $("".section--aside"").height(tabletFilterHeight);
        $("".section--aside"").css(""overflow-y"", ""auto"");


        $("".section--aside"").css(""height"", function(){ 
            return $('.wrap-main').height() + 70;
        });



        var newwTabletFilterHeight = $('.section--content').height() + 112 + $('.footer').height(); // 112 - —ç—Ç–æ —à–∞–ø–∫–∞
            var asideNewwHeightH = $("".section--aside"").height(newwTabletFilterHeight - 70);
            $('body').height(newwTabletFilterHeight);

        $(window).scroll(function() {
            if ($(window).scrollTop() &gt;= $(document).height() - $(window).height()) {
                calcHeightFilter();
                $('.button_more').css('box-shadow', '0px 0px 13px 0px rgba(0, 0, 0, 0.2)');
            } else {
                $('.button_more').css('box-shadow', 'none');
            }
        });
    }

    if (($(document).width()) &gt; 1023) {
        $('body').css(""overflow-y"", ""visible"");
        $('section--aside').css(""overflow-y"", ""visible"");
    }

        $(window).on('resize', function(){

            if (($(document).width()) &lt; 768) {
                if ($('.section--aside').hasClass('open-aside')) {
                    $('.js-anchor-top').css(""display"", ""none"");
                        $('body').css(""overflow"", ""hidden"");
                        $('.section--aside').css(""overflow"", ""hidden"");
                        $('.section--aside').css(""height"", ""auto"");
                        $(""body"").css(""height"", function(){ 
                            return $('.section--aside').height() + 169;
                        });
                        $('.section--aside__close').css(""display"", ""block"");
                        $('.section-empty').remove();
                }
            }


            if (($(document).width()) &gt;= 768 &amp;&amp; ($(document).width()) &lt;= 1023 ) {
                var newTabletFilterHeight = $('.section--content').height() + 112 + $('.footer').height();
                var asideNewHeightH = $("".section--aside"").height(newTabletFilterHeight);
                $('body').height(newTabletFilterHeight);
                $("".section--aside"").css(""overflow-y"", ""auto"");
                if ($('.section--aside').hasClass('open-aside')) {
                    $('.section--aside__close').css(""display"", ""block"");
                    $("".wrap-main"").append('&lt;div class=""section-empty""&gt;');
                    $('body').height(newTabletFilterHeight + $('.section-empty').height());
                }
            }


            if (($(document).width()) &gt; 1023) {
                $('body').css(""height"", ""inherit"");
                $('.section-empty').remove();
                $("".footer"").css(""margin-bottom"", ""0"");
                $('.section--aside__close').css(""display"", ""none"");
                $('body').css(""overflow"", ""visible"");
                $('.section--aside').css(""overflow"", ""visible"");
                $('.section--aside').css(""height"", ""auto"");
            }
        });

}

// –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
$(document).on('click', '.js-filter_show', function(){
    $("".section--aside"").addClass(""open-aside"");
    $("".section--catalog"").addClass(""overlay-section"");
    $('.section--aside__close').css(""display"", ""block"");

    if (($(document).width()) &gt;= 768 &amp;&amp; ($(document).width()) &lt;= 1023 ) {
        $("".wrap-main"").append('&lt;div class=""section-empty""&gt;');
    }

    calcHeightFilter();
});

$(document).on('click', '.section--aside__close', function(){
    $("".section--aside"").removeClass(""open-aside"");
    $('.section--aside__close').css(""display"", ""none"");
    $("".section--catalog"").removeClass(""overlay-section"");
    $('.section-empty').remove();
    $('body').css(""overflow"", ""visible"");
    $('body').css(""height"", ""100%"");
});
</code></pre>
","<p>The <code>$(window).on('resize')</code> callback can be called many times in quick succession. Instead of recalculating everything immediately, I would suggest debouncing the calculations:</p>

<pre><code>$(window).on('resize', _debounce);

// Time to wait before calling resize in milliseconds
var DEBOUNCE_DELAY = 250;

var timeout = null;
function _debounce() {
    timeout = setTimeout(function() {
        timeout = null;
        resize();
    }, DEBOUNCE_DELAY);
}

function resize() {
    // perform all calculations here.
}
</code></pre>

<p>How this works is the <code>_debounce</code> function sets up a timer which waits <code>DEBOUNCE_DELAY</code> milliseconds before calling the <code>resize</code> function. If <code>_debounce</code> is called and there is an existing timer, the timer gets cancelled so that <code>_resize</code> is only called once, after the <em>last</em> call to <code>_debounce</code></p>
"
"Each column of a data.frame as a factor of two levels","<p>I have the following <code>data.frame</code>:</p>

<pre><code># Define data.frame 
  u&lt;-data.frame(matrix(c(0,0,0,1,0,1,1,1,0), nrow=3))
# Define each column as a factor with two levels 
  r &lt;- as.data.frame(apply(u,2,function(x) factor(x, levels = c(0,1))))
</code></pre>

<p>Although I apply the factor function to each column defining the levels, the first column only presents one of them (the 0; the only value in the column) and I want it to be a factor with two levels (0 and 1).</p>

<p>Any idea about how to solve it?</p>

<p>The problem is that using <code>apply</code> function there is a problem with columns with all the same values; if I do it manually there is not any problem.</p>
","<p>Use <code>lapply</code> instead:  </p>

<pre><code>r &lt;- data.frame(lapply(u, function(x) factor(x, levels = c(0,1))))
</code></pre>

<p>All data frames are list of lists, so this naturally works.   </p>

<p><code>apply</code> works good for functions like <code>mean</code>,<code>sum</code>,<code>median</code> etc., but if you wan't to adjust the data frame you're working on, <code>lapply</code> is more suitable.</p>
"
"How do I pass gson JsonObject between fragments in the same activity","<p>I'm refactoring my app and currently rewriting two activities as two fragments in the same activity. This was how I used to send gson JsonObject from the first activity to the second activity:</p>

<p>Activity1:</p>

<pre><code>Intent intent = new Intent(this, Activity2.class);
intent.putExtra(""form"", gson.toJson(form));
startActivity(intent);
</code></pre>

<p>Activity2:</p>

<pre><code>intent = getIntent();
form = gson.fromJson(intent.getStringExtra(""form""), JsonObject.class);
</code></pre>

<p>Now that I've rewritten <code>Activity1</code> and <code>Activity2</code> as fragments in the same activity, is there a similar approach that I can use to send and retrieve data in the fragments? I just find using intents very intuitive, but I figured fragments use a different way of communicating with one another.</p>
","<pre><code>Bundle args = new Bundle();
args.putString(""form"", gson.toJson(form));
secondFragment.setArguments(args);
</code></pre>

<p>and in your targeted Fragment :</p>

<pre><code>getArguments().getString(""form"");
</code></pre>
"
"How are the equational reasoning operators used in practice?","<p>The <a href=""https://agda.github.io/agda-stdlib/Relation.Binary.EqReasoning.html"" rel=""nofollow noreferrer"">Agda Standard Library</a> exports some operators that allow you to write proofs in a manner similar to what you would do on paper, or how it is taught in the Haskell community. While you can write ""conventional"" Agda proofs in a somewhat systematic manner by refining a Goal using <code>with</code> abstractions, <code>rewrite</code>s or helper lemmas as needed, it isn't really clear to me how a proof using the equality reasoning primitives ""comes to be"".</p>

<p>That is, while you can find examples about what these proofs look like when they are finished and type-check <a href=""http://people.inf.elte.hu/divip/AgdaTutorial/Functions.Equality_Proofs.html#equational-reasoning"" rel=""nofollow noreferrer"">here</a> and <a href=""https://www.csie.ntu.edu.tw/~b94087/aopa-intro.pdf"" rel=""nofollow noreferrer"">there</a>, these already worked examples don't show you how they are developed in a systematic step-by-step (maybe hole-driven) manner.</p>

<p>How is it done in practice? Do people ""refactor"" an already existing proof? Do you try to ""burn the candle from both sides"" by starting with the left-hand and right-hand sides of the initial Goal and a hole in the middle?</p>

<p>Furthermore, the <a href=""https://agda.readthedocs.io/en/v2.5.3/tools/auto.html#equality-reasoning"" rel=""nofollow noreferrer"">Agda documentation</a> states that if the equality reasoning primitives are in scope, ""then Auto will do equality reasoning using these constructs"". What does that mean?</p>

<p>I would appreciate it if someone could point me in the right direction, or even post an example of how they develop these kinds of proofs step-by-step, what questions they ask themselves as they go through it, where they put the holes and so on. Thanks!</p>
","<p>I think it would be more helpful for you to look at the definitions for equational reasoning for Identity here <a href=""https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#5706"" rel=""nofollow noreferrer"">Equational Reasoning</a>. The main point is that it is just a nicer way to apply transitivity chains and allowing the user to see the actual expression in code, rather than the proof evidence which is not that easy to read.</p>

<p>The way I go about building a proof using equational reasoning for any setoid is this. With the example of natural numbers</p>

<pre><code>open import Relation.Binary.PropositionalEquality
open ‚â°-Reasoning

data ‚Ñï : Set where
  zero : ‚Ñï
  succ : ‚Ñï ‚Üí ‚Ñï

_+_ : ‚Ñï ‚Üí ‚Ñï ‚Üí ‚Ñï
m + zero   = m
m + succ n = succ (m + n)
</code></pre>

<p>Let's take commutativity as an example.
This is how I start with the goals.</p>

<pre><code>comm+ : ‚àÄ m n ‚Üí m + n ‚â° n + m
comm+ m zero     = {!!}
comm+ m (succ n) =
  begin
    succ (m + n)
  ‚â°‚ü® {!!} ‚ü©
    succ n + m
  ‚àé
</code></pre>

<p>Now I see the original expression and goal and my goal proof is between the brackets.
I work only on the expression leaving the proof objects untouched and add 
what I think should work.</p>

<pre><code>comm+ : ‚àÄ m n ‚Üí m + n ‚â° n + m
comm+ m zero     = {!!}
comm+ m (succ n) =
  begin
    succ (m + n)
  ‚â°‚ü® {!!} ‚ü©
    succ (n + m)
  ‚â°‚ü® {!!}‚ü©
    succ n + m
  ‚àé
</code></pre>

<p>Once I think I have a proof, I work on the proof objects that justify my steps.</p>

<p>Regarding the auto-tactic, you should not bother with that in my opinion. It's not being worked on for a while.</p>
"
"ArgumentError when accessing pageobject widget","<pre><code>class MainTabsWidget  &lt; PageObject::Elements::UnorderedList
  include  PageObject
  include  PageObject::PageFactory

  link(:first_link, :text =&gt; 'First')
  link(:second_link, :text =&gt; 'Second')
  link(:third_link, :text =&gt; 'Third')
  link(:category_link, :text =&gt; 'Category')
  link(:subcat1_link, :text =&gt; 'Subcat1')
  link(:subcat2_link, :text =&gt; 'Subcat2')

  def goto_tab_item(tab_item)
    items = tab_item.split /\//
    items.each do |item|
      case item
        when 'First'
          first_link
        when 'Second'
          second_link
        when 'Third'
          third_link
        when 'Category'
          category_link
        when 'Subcat1'
          subcat1_link
        when 'Subcat2'
          subcat2_link
      end
    end
  end
end

PageObject.register_widget :main_menu, MainTabsWidget , :ul
</code></pre>

<p>I have a page called landing page that uses the widget in the following manner....</p>

<pre><code>class LandingPage
  include  PageObject
  include  PageObject::PageFactory


  main_menu(:menu_tabs, :id =&gt; 'mainMenu')


  def select_menu_item(item)
    menu_tabs_element.go_to_tab_item item
  end
end
</code></pre>

<p>This actually did work at one point.  If you pass 'First' for  select_menu_item, it will click to the page specified by first_link.  If you specify 'Category/Subcat1' it will click on the category link and then subcat1.  </p>

<p>Howerver, something changed.  We are transition from watir-webdriver gem to watir (6.10) gem, and now the code gets the argument exeption </p>

<pre><code>'ArgumentError: wrong number of arguments (0 for 1..2)'
</code></pre>

<p>This occurs when menu_tabs_element gets referenced in any way.  I've run out of ideas to remedy this.</p>

<p>Stack Trace:</p>

<pre><code>ArgumentError: wrong number of arguments (0 for 1..2)
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/element_locators.rb:10:in `element'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/elements/element.rb:191:in `respond_to_missing?'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object.rb:53:in `respond_to_missing?'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object.rb:70:in `respond_to?'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object.rb:70:in `initialize'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/platforms/watir/page_object.rb:1047:in `new'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/platforms/watir/page_object.rb:1047:in `find_watir_element'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/platforms/watir/page_object.rb:1118:in `block in define_widget_singular_accessor'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page-object-2.2.4/lib/page-object/widgets.rb:38:in `block (3 levels) in define_accessors'
./lib/pages/menu.rb:13:in `select_menu_item'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page_navigation-0.10/lib/page_navigation.rb:134:in `block in navigate_through_pages'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page_navigation-0.10/lib/page_navigation.rb:129:in `each'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page_navigation-0.10/lib/page_navigation.rb:129:in `navigate_through_pages'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/page_navigation-0.10/lib/page_navigation.rb:67:in `navigate_to'
./spec/refactor/test_spec.rb:6:in `block (2 levels) in &lt;top (required)&gt;'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:350:in `instance_exec'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:350:in `run'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:509:in `block in run_owned_hooks_for'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:508:in `each'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:508:in `run_owned_hooks_for'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/hooks.rb:460:in `run'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/example_group.rb:537:in `block in run_before_context_hooks'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/memoized_helpers.rb:186:in `block in isolate_for_context_hook'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/memoized_helpers.rb:182:in `instance_exec'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/memoized_helpers.rb:182:in `isolate_for_context_hook'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/example_group.rb:536:in `run_before_context_hooks'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/example_group.rb:589:in `run'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:118:in `block (3 levels) in run_specs'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:118:in `map'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:118:in `block (2 levels) in run_specs'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/configuration.rb:1896:in `with_suite_hooks'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:113:in `block in run_specs'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/reporter.rb:79:in `report'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:112:in `run_specs'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:87:in `run'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:71:in `run'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/lib/rspec/core/runner.rb:45:in `invoke'
C:/Ruby22/lib/ruby/gems/2.2.0/gems/rspec-core-3.7.0/exe/rspec:4:in `&lt;top (required)&gt;'
C:/Ruby22/bin/rspec:23:in `load'
C:/Ruby22/bin/rspec:23:in `&lt;top (required)&gt;'
-e:1:in `load'
-e:1:in `&lt;main&gt;'

1 example, 1 failure, 0 passed

Finished in 6.087 seconds

Process finished with exit code 1
</code></pre>
","<p>It is not clear to me which change in Watir would cause this issue. It seems more likely a change in Page-Object. At any rate, here are 2 solutions. Note that this was tested with Page-Object v 2.2.4.</p>

<p><strong>Using Widgets</strong></p>

<p>As pointed out by <a href=""https://github.com/cheezy/page-object/issues/263"" rel=""nofollow noreferrer"">Alexis in Page-Object Issue 263</a>, including page object accessor methods in widgets is not as straight forward as one would expect. In the <code>MainTabsWidget</code> class, instead of <code>include PageObject</code>, you need to do:</p>

<pre><code>extend PageObject::Accessors  # to get the accessor methods
attr_reader :platform         # the accessor methods don't work without a platform
</code></pre>

<p>With this change, your page object should work.</p>

<p><strong>Using Page Section</strong></p>

<p>Page-Object has a page section feature that might better suit your needs. It simplifies some of the code (ie address the above issue).</p>

<p>You define a class to represent your main tabs section. Note that you do not need to register the section or have the multi-line setup as with Widgets.</p>

<pre><code>class MainTabs
  include PageObject
  include PageObject::PageFactory

  link(:first_link, :text =&gt; 'First')
  link(:second_link, :text =&gt; 'Second')
  link(:third_link, :text =&gt; 'Third')
  link(:category_link, :text =&gt; 'Category')
  link(:subcat1_link, :text =&gt; 'Subcat1')
  link(:subcat2_link, :text =&gt; 'Subcat2')

  def select_menu_item(tab_item)
    items = tab_item.split /\//
    items.each do |item|
      case item
        when 'First'
          first_link
        when 'Second'
          second_link
        when 'Third'
          third_link
        when 'Category'
          category_link
        when 'Subcat1'
          subcat1_link
        when 'Subcat2'
          subcat2_link
      end
    end
  end
end
</code></pre>

<p>The page object can simply become:</p>

<pre><code>class LandingPage
  include PageObject
  include PageObject::PageFactory

  page_section(:menu_tabs, MainTabs, :id =&gt; 'mainMenu')
end
</code></pre>

<p>The clicking of the menu would change to:</p>

<pre><code>page.menu_tabs.select_menu_item('First')
</code></pre>

<p>(or you could continue to define a <code>#select_menu_item</code> method in <code>LandingPage</code> to avoid downstream changes)</p>
"
"Problems with Feature Branches In Git","<p>The following description is looking for help with improving my day to day workflow with git and solving an issue I'm not having with additional work.</p>

<p>Let's say I create a remote feature branch from Jira. Then I track it so that it creates a local copy of that remote branch on my local repo. After I complete it that feature, I push that remote version of that feature branch and then make a pull request into the remote development branch. My issue is I've been given the green light to go in and refactor code because this project code is all over the place. However, if I create a branch off of my local dev its not going to be my changes from the local feature branches that I've done. Should I push my local feature branches into my local dev branch?</p>

<pre><code>Branches

Local

   - Development
   - Feature 1
   - Feature 2

Remote

   - Master
   - Development
   - Feature 1
   - Feature 2
</code></pre>
","<p>The best course of action would be to ask your project lead what they would do. That way, the fault of doing it wrongly won't lie with you. :)</p>

<p>If that's not an option, I would try to follow the <a href=""http://nvie.com/posts/a-successful-git-branching-model/"" rel=""nofollow noreferrer"">git flow</a> approach. What this means in detail comes down to what you mean by this statement:</p>

<blockquote>
  <p>I've been given the green light to go in and refactor code because this project code is all over the place.</p>
</blockquote>

<p>Does this mean refactoring everything that's currently in the <code>Development</code> branch? If so, your approach should be as follows:</p>

<ol>
<li>Create a new feature branch that branches off of <code>Development</code></li>
<li>Using that feature branch, refactor the code base</li>
<li>Create a pull request to merge your feature branch into <code>Development</code></li>
</ol>

<blockquote>
  <p>However, if I create a branch off of my local dev its not going to be my changes from the local feature branches that I've done.</p>
</blockquote>

<p>That's true, and you have two options here:</p>

<ul>
<li>Do the refactoring of <code>Development</code> first. As soon as that is done, refactor the code for your new feature on your local feature branch, then open a pull request to merge it into <code>Development</code>.</li>
<li>Open the pull request to merge it into <code>Development</code> first - as soon as it is merged into <code>Development</code>, you can begin the refactoring of <code>Development</code> (which then includes refactoring the code introduced for your new feature as well, of course).</li>
</ul>

<p>The former approach might save you some work in terms of refactoring, but the latter approach will get the feature out quicker. Once again, depending on how much time is necessary to refactor the code base, this question might be suited for your project lead.</p>
"
"PowerMockito.mockStatic() of a static method is not working correctly in Spring Boot Test","

<p>This is the setup of the test class:</p>

<pre><code>@RunWith(PowerMockRunner.class)
@PowerMockIgnore(""javax.management.*"")
@PowerMockRunnerDelegate(SpringRunner.class)
@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT, classes = ServiceApplication.class)
@PrepareForTest({ MyClass.class })
public class ControllerTest {

    @Autowired
    public TestRestTemplate restTemplate;

    public static MyClass myClass = Mockito.mock(MyClass.class);

    @BeforeClass
    public static void beforeClassSetup() throws Exception {
        PowerMockito.mockStatic(MyClass.class);
        BDDMockito.given(MyClass.getInstance(Mockito.anyString())).willReturn(myClass);
        BDDMockito.given(myClass.foo()).willReturn(""BAR"");
        // ...
    }
 .
 .
 .
 // test cases
</code></pre>

<p>In configuration class of this project, for load some beans, I use this static call for generate the instance.</p>

<pre><code>@Configuration
@ComponentScan(basePackages = { ""package.from.another.project.in.production"" })
public class Beans {

    @Bean
    public MyClass myClass() {
        return MyClass.getInstance(K.FOO);
    }

}
</code></pre>

<p>This is my controller that uses the bean, as well as the static call according to the parameters.</p>

<pre><code>@RestController
public class Controller {

    @Autowired
    private MyClass myClass;

    @GetMapping(path = ""/"")
    public String doSomething() {
            String filter = myClass.foo();
            return filter;
    }

    @GetMapping(path = ""/two"")
    public String doSomething2(@RequestParam Map&lt;String, String&gt; allParams) {
            String accountId = allParams.get(""account_id"");
            String filter = MyClass.getInstance(K.BAR + accountId).foo();
            return filter;
    }
}
</code></pre>

<p>The bean is autowired because its use is greater than instantiation by the <code>getInstance()</code> method. In addition, the instantiation by the <code>getIntance()</code> method is variable according to the parameter. Don't ask me why the MyClass class is like this, because the API was old and I'm slowly refactoring.</p>

<p>The issue is that the autowired bean is correctly mocked by <code>PowerMockito.mockStatic(MyClass.class)</code> and also by <code>@MockBean</code> (which I used initially), but the call <code>MyClass.getInstance()</code> in <code>Controller.class</code> does not work at all.</p>

<p>I think the problem should happen when Spring climbs its environment and does not load everything that has been correctly mocked by PowerMockito, just the classes of its beans. Can anyone help me solve this problem?</p>
","<p>This is just a wild guess, have you tried using regular Mockito as opposed to BDDMockito? Just want to rule it out as a culprit.</p>
"
"regex to ignore lines with specific symbol","<p>I'm trying to get a regex to set change relative paths to absolute with an alias, and ignore any lines with alias already indicated with the @ symbol to prevent folder/file name matches.  I've got as far as the replace and match , but I can't do the ignore lines with @ bit.  I would also like it to match  the /foldername/ forward slashes either side when selecting.</p>

<p><a href=""https://i.stack.imgur.com/Hppq8.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/Hppq8.jpg"" alt=""RegEx JP""></a></p>

<p><a href=""https://regex101.com/r/vRUegE/1/"" rel=""nofollow noreferrer"">https://regex101.com/r/vRUegE/1/</a></p>

<p>I would have expected the lines with @ to be ignored</p>

<p><strong><em>Here is the correct response thanks to Wiktor:</em></strong></p>

<p><a href=""https://i.stack.imgur.com/bx0Vq.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/bx0Vq.jpg"" alt=""Perfect working screenshot""></a></p>

<p><a href=""https://regex101.com/r/aOuFtc/1"" rel=""nofollow noreferrer"">Working example</a></p>

<p>Using a combination of <a href=""https://sourceforge.net/projects/grepwin/"" rel=""nofollow noreferrer"">WinGrep</a> and these regex's it was easy to refactor hundreds of paths in hundreds of files in minutes!</p>
","<p>You may add a <a href=""https://www.regular-expressions.info/lookaround.html"" rel=""nofollow noreferrer""><em>negative lookahead</em></a> <code>(?!@)</code> after the positive lookbehind:</p>

<pre><code>(?&lt;=from..)(?!@)(.*)(?=module)(.*)(module)
           ^^^^^
</code></pre>

<p>See <a href=""https://regex101.com/r/LLU4z9/1"" rel=""nofollow noreferrer"">this regex demo</a>. The <code>(?!@)</code> will fail the match once <code>@</code> is found right after <code>from</code> and any 2 chars immediately to the right of it.</p>

<p>Note that the regex might need further adjusting as <code>(?=module)</code> does not make much sense here. You might as well use <a href=""https://regex101.com/r/LLU4z9/2"" rel=""nofollow noreferrer""><code>(?&lt;=from..)(?!@)(.*)(module)</code></a>.</p>
"
"Is it possible to apply refactoring using OmniPascal?","<p>I've installed <a href=""http://omnipascal.com/"" rel=""nofollow noreferrer"">OmniPascal</a> extension in Visual Studio Code to use it for coding in Delphi and I am loving it. Code completion, parameters hint, go to declarations, all working 100%! Nonetheless, I am missing the refactor commands like rename (CTRL+SHIFT+E). Is that already implemented in OmniPascal?</p>
","<p>There are currently no refactoring tools implemented in OmniPascal. <em>Rename</em> and <em>Extract method</em> are planned for the future but there are other features that need to be implemented before OmniPascal can turn into a <strong>reliable</strong> refactoring tool.</p>

<p>As long as OmniPascal doesn't handle all language features correctly (like <code>with</code>-blocks or class helpers) the rename command would produce wrong results. You don't want to work with such a refactoring tool.</p>
"
"Is this a violation of the Law of Demeter? vs. readable code","<p>The code below brakes apparently the Law of Demeter, i.e. methods <code>getServer().methodx(...)</code>. From other side it looks pretty compact = better readable?  </p>

<pre><code>abstract class BaseManager {
    ResultSet find(String searchText) {
        return getServer().find(searchText);
    }

    ResultSet fetch(String fetchText) {
        return getServer().fetch(fetchText);
    }

    void save(String saveText) {
        getServer().save(saveText);
    }

    abstract BaseManager getServer();
}

class Server1Manager extends BaseManager {
    @Override
    protected BaseManager getServer() {
        return server1;
    }
}

class Server2Manager extends BaseManager {
    @Override
    protected BaseManager getServer() {
        return server2;
    }
}
</code></pre>

<p>If the law is violated, them how to refactor this code? 
Many thanks in advance.</p>
","<blockquote>
  <p>The code below brakes [sic] apparently the Law of Demeter, i.e.
  methods getServer().methodx(...). From other side it looks pretty
  compact = better readable?</p>
</blockquote>

<p>The point of your design is lost on me.  If compactness is your goal, then would not this be even better?</p>

<pre><code>class Manager {
    private Server server;

    public Manager(Server server) {
        this.server = server;
    }

    ResultSet find(String searchText) {
        server.find(searchText);
    }

    ResultSet fetch(String fetchText) {
        server.fetch(fetchText);
    }

    void save(String saveText) {
        server.save(saveText);
    }
}
</code></pre>

<p>In addition to being even more compact and clear, that happens to conform to the Law of Demeter.  Moreover, it follows the principle of preferring composition over inheritance, which I think you'll see is favored (but not implied) by the Law of Demeter.</p>

<blockquote>
  <p>If the law is violated, them how to refactor this code?</p>
</blockquote>

<p>I'm still liking what I presented above.</p>

<blockquote>
  <p>Is the
  following solution acceptable (does it not look like a code
  duplication)?: [...]</p>
</blockquote>

<p>If you presented that to me for code review, I would certainly ask what you think you gain from inheritance there.  One might argue a bit over whether your code is technically duplicative, but it is certainly longer and more complex than the non-inheritance version I presented.  And the non-inheritance version leaves no question about code duplication.</p>
"
"DDD - How does the domain receive client data","<p>I'm planning to refactor a legacy .NET project that I'm maintaining, there are mainly 4 projects involved:</p>

<ul>
<li><code>My.Company.Web</code> - The presentation layer. ASP.NET MVC.</li>
<li><code>My.Company.Service</code> - The service layer, defines service interfaces and contains command handlers. Invoked by the web layer.</li>
<li><code>My.Company.DTO</code> - The assembly that contains DTO classes for data transfer between the domain and web layers.</li>
<li><code>My.Company.Domain</code> - The domain layer.</li>
<li><code>My.Company.Data</code> - The persistence layer.</li>
</ul>

<p>When user submits a form to update a person's details, the process looks somewhat like this:</p>

<ol>
<li>Using the submitted data, controller constructs a <code>PersonDetailsDTO</code> which consists of multiple simple fields to hold <code>FirstName</code>, <code>LastName</code>, <code>Age</code> and etc, and a complex type object called <code>AddressDTO</code> that holds address details: <code>var dto = new PersonDetails(...);</code></li>
<li><p>Controller calls the service layer with the DTO: </p>

<pre><code>_personService.UpdateDetails(dto);
</code></pre></li>
<li><p>In the service:</p>

<pre><code>public void UpdatePerson(PersonDetailsDTO dto)
{
    var person = _personRepository.GetById(dto.PersonId);
    person.Update(dto);
    _personRepository.Update(person);
}
</code></pre></li>
<li><p>In the Person domain:</p>

<pre><code>public class Person : AggregateRoot
{
    private string FirstName;
    .... // other fields
    private Address Address;

    public void Update(PersonDetailsDTO dto)
    {
        FirstName = dto.FirstName;
        .... // other fields
        Address.Update(dto.AddressDTO); // update the value object - address
    }
}
</code></pre></li>
</ol>

<p>As you can see here, the <code>Person</code> domain references the <code>PersonDetailsDTO</code>. This feels wrong to me as DTOs are means to present the data in the domain to its clients while not exposing the domain itself. and the domain should <strong>not</strong> be concerned with how it's presented to the clients.</p>

<p>Also IMO the DTOs should live in the <code>My.Company.Service</code> project as it's the service that defines the operation/data transfer contracts.</p>

<p>But then how would the service pass the details on to the domain? Would it have to be a loooong list of parameters: <code>person.Update(firstName, lastName, age, gender, street1, street2, state, postcode...)</code>. This certainly looks wrong to me.</p>

<p>Or does the domain have to define yet another set of it's own ""DTOs"" to receive client data?</p>

<p>I have gone through a LOT of tutorials and SO posts and no one seem to share my concern, so I'm starting to think I'm missing something here, could someone point me to the right direction?</p>
","<p>You could do as follows.
You already have a Value Object named <code>Address</code> similarly you could have another Value Object as <code>PersonalDetails</code> which will contain firstName, lastName, age, gender etc. and the <code>Person</code> entity will have two behaviors like <code>updatePersonalDetails()</code> and <code>updateAddress()</code>. Your application service will look like below.</p>

<pre><code>public void UpdatePerson(PersonDetailsDTO dto)
{
    var person = _personRepository.GetById(dto.PersonId);
    Address address = new Address(dto.getStreet1, dto.getStreet2,...);
    PersonalDetails details = new PersonalDetails(dto.getFirstName,dto.getLastName(),...);
    person.updatePersonalDetails(details);
    person.updateAddress(address);
   _personRepository.save(person);
}
</code></pre>
"
"How to bulk delete records using temporary tables in Hibernate?","<p>I have a question. Where did these methods go?</p>

<pre><code>Dialect.supportsTemporaryTables();
Dialect.generateTemporaryTableName();
Dialect.dropTemporaryTableAfterUse();
Dialect.getDropTemporaryTableString();
</code></pre>

<p>I've tried to browse git history for <code>Dialect.java</code>, but no luck. I found that something like
<code>MultiTableBulkIdStrategy</code> was created but I couldn't find any example of how to use it.</p>

<p>To the point...I have legacy code (using hibernate 4.3.11) which is doing batch delete from
multiple tables using temporary table. In those tables there may be 1000 rows, but also there may
be 10 milion rows. So just to make sure I don't kill DB with some crazy delete I create temp table where I put (using select query with some condition) 1000 ids at once
and then use this temp table to delete data from 4 tables. It's running in while cycle until all data based on some condition is not deleted.
Transaction is commited after each cycle.</p>

<p>To make it more complicated this code has to run on top of: mysql, mariadb, oracle, postgresql, sqlserver and h2.</p>

<p>It was done using native SQL, with methods mentioned above. But not I can't find a way how
to refactor it.</p>

<p>My first try was to create query using nested select like this:
<code>delete from TABLE where id in (select id from TABLE where CONDITION limit 1000)</code> but this is way slower as I have to run select query multiple times for each delete and <code>limit</code> is not supported in nested select in HQL.</p>

<p>Any ideas or pointers?</p>

<p>Thanks.</p>
","<p>The methods were present in <a href=""http://www.atetric.com/atetric/javadoc/org.hibernate/hibernate-core/4.3.11.Final/org/hibernate/dialect/Dialect.html"" rel=""nofollow noreferrer"">version 4.3.11</a> but removed in <a href=""http://www.atetric.com/atetric/javadoc/org.hibernate/hibernate-core/5.0.0.Final/org/hibernate/dialect/Dialect.html"" rel=""nofollow noreferrer"">version 5.0.0</a>. It seems a bit unusual that they were removed rather than deprecated - the background is on <a href=""https://hibernate.atlassian.net/browse/HHH-9724#commentauthor_67347_verbose"" rel=""nofollow noreferrer"">this Jira ticket</a>.</p>

<p>To quote from this:</p>

<blockquote>
  <p>Long term, I think the best approach is to remove the Dialect method
  intended to support table tabled in a piecemeal fashion and to make
  MultiTableBulkIdStrategy be a fully self-contained contract.</p>
</blockquote>

<p>The methods were removed in <a href=""https://github.com/hibernate/hibernate-orm/commit/ae43670290d05db28c322acb67431fe88db537d2"" rel=""nofollow noreferrer"">this commit</a>.</p>

<p>So it seems that <a href=""http://docs.jboss.org/hibernate/orm/5.0/javadocs/"" rel=""nofollow noreferrer""><code>getDefaultMultiTableBulkIdStrategy()</code></a> is the intended replacement for these methods - but I'm not entirely clear on how, as it currently has no Javadoc. Guess you could try to work it out from <a href=""https://github.com/hibernate/hibernate-orm/commit/ae43670290d05db28c322acb67431fe88db537d2#diff-a5703c084c928c20fafc09732a0f044aR323"" rel=""nofollow noreferrer"">the source code</a> ...or if all else fails, perhaps try to contact <a href=""https://stackoverflow.com/users/1082300/steve-ebersole"">Steve Ebersole</a>, who implemented the change?</p>
"
"Visual studio 2017 intellisense errors got mixed-up after crash","<p>During a heavy code-refactoring session, I got a BSOD (Blue Screen Of Death). After restart, Visual Studio started to exhibit a strange intellisense problem:</p>

<p>(I was in the midst of refactoring a file with few thousand lines of code, with about a hundred errors)</p>

<p>After a build, the errors were at the right locations. After fixing any of them, all intellisense errors moved around like crazy and became unusable. I needed another F6 (build) and wait until things sort out.</p>

<p>I deleted every non source controlled folder in my solution, deleted the cache, ... Nothing seemed to solve the problem.</p>
","<p>The problem turns out to be system time!!</p>

<p>After the crash, my system time went back a few hours.
After I fixed the time, the problem got solved.</p>

<p>PS: the reason for hour change is this: I've got a dual-boot Windows-Linux (Fedora). Fedora keeps the system time in UTC, while windows keeps it in Local time. So after any restart from Linux to Windows, I've got the wrong time.</p>
"
"Refactoring a Controller containing Many-to-many relationship","<p>I'm following a tutorial on making a blog and I was wondering how I can refactor some of the codes that look a mess. Specifically the many-to-many relationship while parsing in tags. Is there a better way to reduce this into a smaller function on the controller?</p>

<pre><code>  public ActionResult Create(int? id, string title, string body, DateTime datetime, string tags)
   {
      Post post = GetPost(id);
      post.Title = title;
      post.Body = body;
      post.Tags.Clear();
// I'D Like to refactor this point on to look something like this: ParseTags(tags); 
rather than this
      tags = tags ?? string.Empty;
     string[] tagNames = tags.Split(new char[]{' '}, StringSplitOptions.RemoveEmptyEntries);
            foreach(string tagName in tagNames)
              {
                post.Tags.Add(GetTag(tagNames));
              } 
       }

private Tag GetTag(string tagName)
    {
    return _context.Tags.Where(x =&gt; x.Name == tagName).FirstOrDefault() ??
    new Tag() { Name = tagName };
}
</code></pre>
","<p>Rather than creating a new method on the controller, you could encapsulate all the behaviour for parsing and searching for tags in a class, maybe something like this:</p>

<pre><code>public class Tags
{
    private readonly IEnumerable&lt;Tag&gt; contextTags;
    private readonly string rawTags;

    public Tags(string tags, IEnumerable&lt;Tag&gt; contextTags)
    {
        this.rawTags = tags ?? string.Empty;
        this.contextTags = contextTags;
    }

    public IEnumerable&lt;Tag&gt; ToList()
    {
        List&lt;Tag&gt; tags = new List&lt;Tag&gt;();

        string[] tagNames = this.rawTags.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);

        foreach (string tagName in tagNames)
        {
            tags.Add(this.GetTag(tagName));
        }

        return tags;
    }

    private Tag GetTag(string tagName)
    {
        return this.contextTags.FirstOrDefault(x =&gt; x.Name == tagName) ?? new Tag { Name = tagName };
    }
}
</code></pre>

<p>Then the Create method on the controller becomes:</p>

<pre><code>public ActionResult Create(int? id, string title, string body, DateTime datetime, string tags)
{
    Post post = GetPost(id);
    post.Title = title;
    post.Body = body;
    post.Tags.Clear();

    Tags tagsList = new Tags(tags, this._context.Tags);

    post.Tags = tagsList.ToList();
}
</code></pre>
"
"Converting code in Java 8 streams","<p>Is there any easy way to convert this code into java 8 using streams and forEach.</p>

<pre><code>List&lt;List&lt;IStitchable&gt;&gt; listOfEnvelopes = new ArrayList&lt;&gt;();
List&lt;IStitchable&gt; statementsInEnvelope = new ArrayList&lt;&gt;();
int totalPages = 0;

for(byte[] byteArray :byteArrays){
    totalPages = totalPages + getPagesInDocument(byteArray);

    if(totalPages/2&gt;MAX_SHEETS_FOR_OVERSIZE_ENVELOPE){
        totalPages = 0;
        listOfEnvelopes.add(statementsInEnvelope);
        tatementsInEnvelope = new ArrayList&lt;IStitchable&gt;();
    }

    statementsInEnvelope.add(createStitchableFromSnapshot(byteArray));
} 
</code></pre>

<p>I tried to do something like</p>

<pre><code>byteArrays.stream().forEach(byteArray-&gt;{
    totalPages = totalPages + getPagesInDocument(byteArray);            
    if(totalPages/2&gt;MAX_SHEETS_FOR_OVERSIZE_ENVELOPE){
        totalPages = 0;
        listOfEnvelopes.add(statementsInEnvelope);
        statementsInEnvelope = new ArrayList&lt;IStitchable&gt;();
    }
    statementsInEnvelope.add(createStitchableFromSnapshot(byteArray));
});
</code></pre>

<p>but then I cannot use <code>totalPages</code> and <code>statementsInEnvelope</code> within ForEach,
they cannot be accessed from the forEach scope<br/>
Lastly is there any cleaner way to refactor this thing. Any ideas would be appreciated.</p>
","<p>The simplest solution is to use <code>AtomicInteger</code>:</p>

<pre><code>List&lt;List&lt;IStitchable&gt;&gt; listOfEnvelopes = new ArrayList&lt;&gt;();     
List&lt;IStitchable&gt; statementsInEnvelope = new ArrayList&lt;&gt;();
AtomicInteger totalPages = new AtomicInteger();

byteArrays.stream().forEach(byteArray -&gt; {
  totalPages.addAndGet(getPagesInDocument(byteArray));

  if(totalPages.get() / 2 &gt; MAX_SHEETS_FOR_OVERSIZE_ENVELOPE){
    totalPages.set(0);
    listOfEnvelopes.add(new ArrayList&lt;&gt;(statementsInEnvelope));
    statementsInEnvelope.clear();
  }
  statementsInEnvelope.add(createStitchableFromSnapshot(byteArray));
});
</code></pre>
"
"React - passing refs as a prop","

<p>I am trying to manage a checkbox with react. The following code works well enough, but I want to refactor out the code in the render method so that it uses a Component. I want to pass the ref to that component, but I cant figure out how to do it.</p>



<pre><code>export default class AreRefsAwesomeCheckbox extends Component {
    constructor(props) {
        super(props);
        this.handleInputChange = this.handleInputChange.bind(this);
    }

    handleInputChange() {
        let data = {
            isFeatured: this.refs.check_me.checked
        };
        postJSON('/some/url', data);
    }


    componentDidMount() {
        const data = getJSON('/some/url');
        data.then(object =&gt; {
                this.refs.check_me.checked = object.will_i_have_a_nice_checkbox;
            }
        )
    }

    render() {
        return (
            &lt;div&gt;
                &lt;label&gt;
                    &lt;input ref=""check_me"" type=""checkbox"" 
                           onChange={this.handleInputChange}/&gt;
                    &lt;div&gt;Are refs good?&lt;/div&gt;
                &lt;/label&gt;

            &lt;/div&gt;
        );
    }
}
</code></pre>

<p>I was thinking about some thing like this </p>

<pre><code>const Checkbox = ({myRef, changeInput, checkboxText}) =&gt; {
    return (
        &lt;label&gt;
            &lt;input type=""checkbox"" ref={myRef} onChange={(event) =&gt; changeInput(event)}/&gt;
            &lt;div&gt; {checkboxText} &lt;/div&gt;
        &lt;/label&gt;)
};
</code></pre>

<p>And then putting this snippet in the render method</p>

<pre><code>&lt;Checkbox myRef=""check_me"" changeInput={this.handleInputChange} checkboxText=""Are refs good?""/&gt;
</code></pre>

<p>This obviously doesnt work. How do I do this? 
</p>


","<p>Pass a callback ref into the <code>Component</code>, like that:</p>

<pre><code>&lt;Checkbox myRef={ref =&gt; (this.checkbox = ref)} /&gt;
</code></pre>

<p>Oh, and by the way, please always use callback refs. <a href=""https://reactjs.org/docs/refs-and-the-dom.html#adding-a-ref-to-a-dom-element"" rel=""nofollow noreferrer"">Read more here</a>.</p>

<p>One more idea to consider for you: Move the <code>checked</code> value of the <code>checkbox</code> fully into the state of the <code>AreRefsAwesomeCheckbox</code> component and use <a href=""https://reactjs.org/docs/forms.html#controlled-components"" rel=""nofollow noreferrer"">a fully controlled component</a>. That's always better than a <code>ref</code> with bigger predictability and less surprises.</p>

<p>Full code:</p>

<pre><code>const Checkbox = ({myRef, changeInput, checkboxText}) =&gt; {
  return (
    &lt;label&gt;
      &lt;input
        type=""checkbox""
        ref={myRef}
        onChange={event =&gt; changeInput(event)}
      /&gt;
      &lt;div&gt; {checkboxText} &lt;/div&gt;
    &lt;/label&gt;
  )
}

export default class AreRefsAwesomeCheckbox extends Component {
  constructor(props) {
    super(props)
    this.handleInputChange = this.handleInputChange.bind(this)
  }

  handleInputChange() {
    let data = {
      isFeatured: this.refs.check_me.checked,
    }

    postJSON('/some/url', data)
  }

  componentDidMount() {
    const data = getJSON('/some/url')
    data.then(object =&gt; {
      // this.checkbox is the reference to the checkbox element you need
      this.checkbox.checked = object.will_i_have_a_nice_checkbox
    })
  }

  render() {
    return (
      &lt;div&gt;
        &lt;label&gt;
          &lt;Checkbox myRef={ref =&gt; (this.checkbox = ref)} /&gt;

          &lt;div&gt;Are refs good?&lt;/div&gt;
        &lt;/label&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre>
"
"import angular JSON object","<p>I have an angular 1.x controller with the following object:</p>

<pre><code>notificationTypes: [ { NotificationType: '*', NotificationTitle: 'All notifications' },
                     { NotificationType: '0', NotificationLabel: 'System Alert', NotificationTitle: 'System alerts' },
                     { NotificationType: '1', NotificationLabel: 'Pending Task', NotificationTitle: 'Pending tasks' },
                     { NotificationType: '2', NotificationLabel: 'Update', NotificationTitle: 'Updates' },
                     { NotificationType: '3', NotificationLabel: 'Missed Message', NotificationTitle: 'Missed messages' }
                    ],
</code></pre>

<p>It is used to populate a few lists on a single page.  However, I am now in a situation where I need to reuse it on other pages.  I could just copy it over to the appropriate pages, but I'd rather refactor it so both controllers work from the same list for better maintainability.  I've been trying to declare it on the 'MainApp' module as a constant, factory, and/or directive without success.  What am I missing?</p>
","<p>Use a factory to solve this problem. Data can persist in factories and services when changing pages. </p>

<pre><code>angular.module('App', [...])

.factory('NotificationFactory', function () {
    var notificationTypes: [ { NotificationType: '*', NotificationTitle: 'All notifications' },
                 { NotificationType: '0', NotificationLabel: 'System Alert', NotificationTitle: 'System alerts' },
                 { NotificationType: '1', NotificationLabel: 'Pending Task', NotificationTitle: 'Pending tasks' },
                 { NotificationType: '2', NotificationLabel: 'Update', NotificationTitle: 'Updates' },
                 { NotificationType: '3', NotificationLabel: 'Missed Message', NotificationTitle: 'Missed messages' }
                ];

    return notificationTypes;
})
</code></pre>
"
"How to resolve this github/heroku conflict","<p>I have an app on Heroku that I have had for a couple of years, but now I need to refactor some code and update some gems.</p>

<p>When I first started the app I was on a totally different machine. So I had to clone the github repo for that app.</p>

<p>Now I want to push the first changes but I get this error:</p>

<pre><code>set git remote heroku to https://git.heroku.com/alfa-blog.git
</code></pre>

<p>I thought it was asking me to do something like this:</p>

<pre><code>git remote add heroku https://git.heroku.com/alfa-blog.git
</code></pre>

<p>But I get this error:</p>

<pre><code>fatal: remote heroku already exists.
</code></pre>

<p>How do I resolve this? If there is anything unclear, please let me know so I may clarify.</p>

<p>Do I delete the origin one?</p>

<pre><code>heroku  https://git.heroku.com/alfa-blog.git (fetch)
heroku  https://git.heroku.com/alfa-blog.git (push)
origin  https://github.com/&lt;github-page&gt;/Alpha_Blog.git (fetch)
origin  https://github.com/&lt;github-page&gt;/Alpha_Blog.git (push)
</code></pre>

<p>Trying to rename remote repo:</p>

<pre><code>$ git remote rename https://git.heroku.com/alfa-blog.git https://github.com/ldco2016/Alpha_Blog.git
fatal: No such remote: https://git.heroku.com/alfa-blog.git
</code></pre>
","<p>You don't need to remove or rename anything, just <code>set-url</code> to the repo you are currently working in, like this:</p>

<pre><code>git remote set-url origin https://github.com/&lt;github-page&gt;Alpha_Blog.git
</code></pre>

<p>Then you should be able to push your new changes to your existing app on Heroku.</p>
"
"Android use unique onDestroy for all activities","<p>I have an app with several activities and the action to perform on destruction is actually the same, no matter what the Activity is at that moment (deleting some data and performing a HTTP call).<br>
Is there a way to have all activities share the <code>onDestroy</code> method?</p>

<p>Another solution would be to factorize a method in some other static class and have each Activity invoke it during destruction, but a trait-like behaviour would be actually nicer.</p>
","<p>Create an abstract BaseActivity, override the onDestroy, and all your other activities should just extend the BaseActivity?</p>

<p>Why go with singletons, statics, factories etc if what you are describing is a classic OOP trait? :)</p>
"
"Best way to DRY up window resize function","<p>This doesn't look DRY how could I refactor this more efficiently?</p>

<pre><code>var headerHeight = $('header').outerHeight();
var sliderHeight = $('.slick-slider').outerHeight();
$('.slider-container').css('height', sliderHeight - headerHeight);

$(window).resize(function() {
  clearTimeout(window.resizedComplete);
  window.resizedComplete = setTimeout(function() {
    var headerHeight = $('header').outerHeight();
    var sliderHeight = $('.slick-slider').outerHeight();
    $('.slider-container').css('height', sliderHeight -
      headerHeight);
  }, 250);
});
</code></pre>
","<p>The usual way: Make and use a reusable function:</p>

<pre><code>function doHeightStuff() {
    var headerHeight = $('header').outerHeight();
    var sliderHeight = $('.slick-slider').outerHeight();
    $('.slider-container').css('height', sliderHeight - headerHeight);
}
doHeightStuff();
$(window).resize(function() {
  clearTimeout(window.resizedComplete);
  window.resizedComplete = setTimeout(doHeightStuff, 250);
});
</code></pre>
"
"How can I refactor similar requests in React","<p>I have two similar functions in component:</p>

<pre><code>getSavedSearches() {
  $.ajax({
    url: '/api/v2/saved_searches',
    type: 'get',
    dataType: 'json',
    data: {
      manually: true,
      per: 4
    },
    success: (files) =&gt; {
      const savedSearches = files;
      this.setState({
        savedSearches
      })
    },
    error: (xhr, status, error) =&gt; {
      console.log('Saved searches error: ', error);
    }
  })
}

getRecentSearched() {
  $.ajax({
    url: '/api/v2/saved_searches',
    type: 'get',
    data: {
      manually: false,
      per: 4
    },
    success: (files) =&gt; {
      const recentSearched = files
      this.setState({
        recentSearched
      })
    },
    error: (xhr, status, error) =&gt; {
      console.log('Saved searches error: ', error);
    }
  })
}
</code></pre>

<p>How can I refactor these functions to avoid repeating?</p>

<p>Any help will be appreciated!</p>
","<p>Write a common method for api calling and in that function pass the url, callback method as arguments. Use that callback method to return the data to origin.</p>

<p>Like this:</p>

<pre><code>getSavedSearches() {
  apiCall('/api/v2/saved_searches', files =&gt; {
    const savedSearches = files;
    this.setState({
      savedSearches
    })
  })
}

getRecentSearched() {
  apiCall('/api/v2/saved_searches', files =&gt; {
    const recentSearched = files
    this.setState({
      recentSearched
    })
  })
}
</code></pre>

<p>Common method for api calling:</p>

<pre><code>apiCall(url, callback){
  $.ajax({
    url: url,
    type: 'get',
    data: {
      manually: false,
      per: 4
    },
    success: (files) =&gt; {
      callback(files)
    },
    error: (xhr, status, error) =&gt; {
      console.log('Saved searches error: ', error);
    }
  })
}
</code></pre>

<p><strong>Suggestion:</strong> We can make api calling function more generic by passing the method and data in argument as well.</p>

<p>Like this:</p>

<pre><code>apiCall(url, type, data, callback){
    $.ajax({
      url: url,
      type: type,
      data: data,
      success: (files) =&gt; {
        callback(files)
      },
      error: (xhr, status, error) =&gt; {
        console.log('Saved searches error: ', error);
      }
    })
}
</code></pre>
"
"Symfony Lock Component does not lock ‚Äì¬†how to fix?","<p>i upgraded recently to Symfony 3.4.x, refactor LockHandler because of deprecation warning and fall into strange behaviour.</p>

<p>Code in command before refactoring:</p>

<pre class=""lang-php prettyprint-override""><code>class FooCommand
{
    protected function configure() { /* ... does not matter ... */ }
    protected function lock() : bool
    {
        $resource = $this-&gt;getName();
        $lock     = new \Symfony\Component\Filesystem\LockHandler($resource);

        return $lock-&gt;lock();
    }
    protected function execute()
    {
        if (!$this-&gt;lock()) return 0;

        // Execute some task
    }
}
</code></pre>

<p>And it prevents to run two command at the same time ‚Äì¬†second just finishes without doing job. That is good.</p>

<p>But after suggested refactoring it allows to run many commands simultaneously. This is FAIL. How to prevent execution? New code:</p>

<pre class=""lang-php prettyprint-override""><code>class FooCommand
{
    protected function configure() { /* ... does not matter ... */ }
    protected function lock() : bool
    {
        $resource = $this-&gt;getName();
        $store    = new \Symfony\Component\Lock\FlockStore(sys_get_temp_dir());
        $factory  = new \Symfony\Component\Lock\Factory($store);
        $lock     = $factory-&gt;createLock($resource);

        return $lock-&gt;acquire();
    }
    protected function execute()
    {
        if (!$this-&gt;lock()) return 0;

        // Execute some task
    }
}
</code></pre>

<p>NB #1: I don't care about many servers or so, just one instance of application.</p>

<p>NB #2: If process was killed then new command must unlock and run.</p>
","<p>You must use the LockableTrait trait</p>

<pre><code>    use Symfony\Component\Console\Command\LockableTrait;
    use Symfony\Component\Console\Command\Command

    class FooCommand  extends Command
    {
        use LockableTrait;
.....
protected function execute(InputInterface $input, OutputInterface $output)
    {
        if (!$this-&gt;lock()) {
            $output-&gt;writeln('The command is already running in another process.');

            return 0;
        }
// If you prefer to wait until the lock is released, use this:
        // $this-&gt;lock(null, true);

        // ...

        // if not released explicitly, Symfony releases the lock
        // automatically when the execution of the command ends
        $this-&gt;release();

}
</code></pre>
"
"Inheriting from a template class in c++ with enum as template parameter","<p>I have some equal classes that contain enum with named constants (like Parts below) and text description for constants (like Parts but strings). Each source class looks like union (not c++ union :-) ) of two classes below. Want to remove code redundancy and got something like this for now:</p>

<pre><code>template&lt;class T&gt; class SomeBaseClass
{
public:
    std::string toString()
    {
        uint32_t pairsNum = pairs.size();
        for (uint32_t i = 0; i &lt; pairsNum; i++)
            if (pairs[i].first == name) {
                return pairs[i].second;
            }
        // exception will be here
        return std::string("""");
    }
    void fromString(std::string name)
    {
        uint32_t pairsNum = pairs.size();
        for (uint32_t i = 0; i &lt; pairsNum; i++)
            if (pairs[i].second == name) {
                this-&gt;name = pairs[i].first;
                return;
            }
        throw std::invalid_argument(name);
    }
    T get()
    {
        return name;
    }
    void set(T name)
    {
        this-&gt;name = name;
    }
private:
    T name;
    std::vector&lt;std::pair&lt;T, std::string&gt; &gt; pairs;
};

class Child: public SomeBaseClass&lt;Child::Parts&gt;
{
public:
    enum Parts { head, rightLeg, leftLeg, rightHand, leftHand, body };
    Child()
    { 
        /* filling SomeBaseClass::pairs by values will be here */
    }
};
</code></pre>

<p>But Child::Parts is nested type and not a user type for c++98 (can't use more than c++98 standard for this program) so compiler gives error (as expected). I don't want move out Parts from Child because it part of Child ideologically. Is there a beauty way to solve this situation?</p>
","<blockquote>
  <p>I don't want move out Parts from Child because it part of Child ideologically</p>
</blockquote>

<p>This doesn't mean it has to be stored right inside the <code>Child</code> class itself.
What you want to accomplish is impossible like that, C++98 or not. The common approach is to use <em>traits</em>:</p>

<pre><code>template &lt;typename&gt;
struct Child_traits;

class Child;

template &lt;&gt;
struct Child_traits&lt;Child&gt; {
   enum Parts { head, rightLeg, leftLeg, rightHand, leftHand, body };
};

template &lt;typename T&gt;
class SomeBaseClass {
   typedef typename Child_traits&lt;T&gt;::Parts Parts;

   // use Parts type
};

class Child : public SomeBaseClass&lt;Child&gt; { 
    typedef Child_traits&lt;Child&gt;::Parts Parts; // get the parts type to the child
};
</code></pre>

<p>The bond between <code>Child</code> and <code>Parts</code> is established by template specialization (also available in C++98): the <code>Child</code> type acts as a key to the right specialization containing the correct <code>Parts</code> type.</p>
"
"Avoid concurrent access to same queue element","<p>I'm reviewing/refactoring a queue that's going to be used internally by up to 20 people simultaneously but as of now, multiple people can access the first element ( We tried it locally clicking on the link at the same time. )</p>

<p>The flux is similar to this:</p>

<p><strong>views.py</strong></p>

<pre><code>[GET]
def list_operator(request, id):
  if request.POST:
    utilitary = Utilitary(id)
    pool = ThreadPool(processes=1)
    async_result = pool.apply_async(utilitary.recover_people, (id, ))
    return_val = async_result.get()
    person = People.objects.get(pk=return_val)
    return redirect('people:people_update', person.pk)
</code></pre>

<p><strong>utilitary.py</strong></p>

<p>This file has the method <code>recover_people</code> which performs around 4-5 queries (where people have <code>flag_allocated=False</code>) across multiple tables and sorts a list, to return the first element.
The final step is this one:</p>

<pre><code>for person in people:
  p_address = People_Address.objects.get(person_id=person.id)
  p_schedule = Schedules.objects.get(schedules_state=p_address.p_state)

  if datetime.now() &gt; parse_time(p_schedule.schedules_hour):
    person = People.objects.get(pk=person.id)
    person.flag_allocated = True
    person.date_of_allocation = datetime.now()
    person.save()
    return person.pk
</code></pre>

<p>Perhaps something in the Utilitary method's logic is wrong? Or I should be expecting this problem with this amount of people simultaneously calling this method?</p>

<p>Could using a cache help? I'm sorry, I'm new to django and mvc.</p>
","<p>In this case, it seems like a lot to select the ""person"" in the database again just to lock it in memory and then write it to the database. This action is not atomic.</p>

<p>You can have the record locked by other process between these actions:</p>

<blockquote>
<pre><code>person = People.objects.get(pk=person.id)
person.flag_allocated = True
person.date_of_allocation = datetime.now()
person.save()
</code></pre>
</blockquote>

<p>That is where your problem is. But... If you directly update the record on the database passing a condition on which the update will only write on a record where the <code>flag_allocated=False</code>, you just have to see if your update affected any row or not. If not, you go to the next person on the queue.</p>

<p>Something like:</p>

<pre><code>for person in people:
    rows = People.objects.filter(pk=person.id, flag_allocated=False).update(flag_allocated=True)
    if rows:
        break # Got the person... And nobody else will.
</code></pre>

<p>The update will have the record locked to write it to the allocation_flag (SQL principle). If two updates try to mess with the same row, one will do it first and then the second won't update anything and will try the next person.</p>
"
"Can I make my Entity Framework DbSet call my table valued function when selecting?","<p>I have many existing queries that use <code>DbSet&lt;dbo_Deal&gt;</code> and now have the requirement to filter out confidential deals for unauthorized users. I would like to know if there's a way to override the <code>DbSet&lt;dbo_Deal&gt;</code> so that it selects using a Table Valued parameter instead of its default behavior.</p>

<p>I created the following TVF that filters out confidential deals if the user does not have access:</p>

<pre><code>CREATE FUNCTION [dbo].[GetDeals](@UserKey int)
RETURNS TABLE
RETURN (
    SELECT d.*
    FROM dbo.Deal d
    WHERE d.Confidentiality = 0
    OR EXISTS(SELECT *
                FROM dbo.UserRole ur
                WHERE ur.UserKey = @UserKey
                AND ur.Role = 'Admin')
);
</code></pre>

<p>I have also added the following to my DbContext to call the SQL Function:</p>

<pre><code>[DbFunction(""MyDbContext"", ""GetDeals"")]
[CodeFirstStoreFunctions.DbFunctionDetails(DatabaseSchema = ""dbo"")]
public IQueryable&lt;dbo_Deal&gt; GetDeals()
{
    var userKeyParam = new System.Data.Entity.Core.Objects.ObjectParameter(""UserKey"", typeof(int)) { Value = _userKey };
    return ((System.Data.Entity.Infrastructure.IObjectContextAdapter)this).ObjectContext.CreateQuery&lt;dbo_Deal&gt;(""[MyDbContext].[GetDeals](@UserKey)"", userKeyParam);
}
</code></pre>

<p>I know I can refactor all my queries to just call this function, but it would be great if I could somehow instruct Entity Framework to use this function whenever it selects or joins to Deals. Is that possible?</p>
","<p>I wasn't able to get a solution working the way I wanted using a SQL Function, so instead I used this <a href=""http://patrickdesjardins.com/blog/using-a-filtereddbset-with-entity-framework-to-have-dynamic-filtering"" rel=""nofollow noreferrer"">FilteredDbSet</a> which wraps DbSet. All I had to do to implement it was to make the return type on my property in the DbContext a <code>FilteredDbSet</code> and then instantiate it in the constructor with my desired filter. I also made the private constructor in the class below public so I could mock it for unit testing. </p>

<p>This ended up being a very good solution for me because I avoided having to refactor all the existing Linq queries and any future queries will automatically get this behavior.</p>

<pre><code>public class FilteredDbSet&lt;TEntity&gt; : IDbSet&lt;TEntity&gt;, IOrderedQueryable&lt;TEntity&gt;, IListSource where TEntity : class
{
  private readonly DbSet&lt;TEntity&gt; _set;
  private readonly Action&lt;TEntity&gt; _initializeEntity;
  private readonly Expression&lt;Func&lt;TEntity, bool&gt;&gt; _filter;

  public FilteredDbSet(DbContext context, Expression&lt;Func&lt;TEntity, bool&gt;&gt; filter, Action&lt;TEntity&gt; initializeEntity)
    : this(context.Set&lt;TEntity&gt;(), filter, initializeEntity)
  {
  }

  public IQueryable&lt;TEntity&gt; Include(string path)
  {
    return _set.Include(path).Where(_filter).AsQueryable();
  }

  private FilteredDbSet(DbSet&lt;TEntity&gt; set, Expression&lt;Func&lt;TEntity, bool&gt;&gt; filter, Action&lt;TEntity&gt; initializeEntity)
  {
    _set = set;
    _filter = filter;
    _initializeEntity = initializeEntity;
  }

  public IQueryable&lt;TEntity&gt; Unfiltered()
  {
    return _set;
  }

  public TEntity Add(TEntity entity)
  {
    DoInitializeEntity(entity);
    return _set.Add(entity);
  }
  public void AddOrUpdate(TEntity entity)
  {
    DoInitializeEntity(entity);
    _set.AddOrUpdate(entity);
  }
  public TEntity Attach(TEntity entity)
  {
    DoInitializeEntity(entity);
    return _set.Attach(entity);
  }

  public TDerivedEntity Create&lt;TDerivedEntity&gt;() where TDerivedEntity : class, TEntity
  {
    var entity = _set.Create&lt;TDerivedEntity&gt;();
    DoInitializeEntity(entity);
    return entity;
  }

  public TEntity Create()
  {
    var entity = _set.Create();
    DoInitializeEntity(entity);
    return entity;
  }

  public TEntity Find(params object[] keyValues)
  {
    var entity = _set.Find(keyValues);
    if (entity == null)
      return null;


    return entity;
  }

  public TEntity Remove(TEntity entity)
  {
    if (!_set.Local.Contains(entity))
    {
      _set.Attach(entity);
    }
    return _set.Remove(entity);
  }


  public ObservableCollection&lt;TEntity&gt; Local
  {
    get { return _set.Local; }
  }

  IEnumerator&lt;TEntity&gt; IEnumerable&lt;TEntity&gt;.GetEnumerator()
  {
    return _set.Where(_filter).GetEnumerator();
  }

  IEnumerator IEnumerable.GetEnumerator()
  {
    return _set.Where(_filter).GetEnumerator();
  }

  Type IQueryable.ElementType
  {
    get { return typeof(TEntity); }
  }

  Expression IQueryable.Expression
  {
    get
    {
      return _set.Where(_filter).Expression;
    }
  }

  IQueryProvider IQueryable.Provider
  {
    get
    {
      return _set.AsQueryable().Provider;
    }
  }

  bool IListSource.ContainsListCollection
  {
    get { return false; }
  }

  IList IListSource.GetList()
  {
    throw new InvalidOperationException();
  }

  void DoInitializeEntity(TEntity entity)
  {
    if (_initializeEntity != null)
      _initializeEntity(entity);
  }

  public DbSqlQuery&lt;TEntity&gt; SqlQuery(string sql, params object[] parameters)
  {
    return _set.SqlQuery(sql, parameters);
  }
}
</code></pre>
"
"Refactor a condition","<p>There is a condition for a,b,c,d,e,f,g of type unsigned int given as follows:</p>

<pre><code>if ((a &gt; 0) and (b &lt; a) and (c &gt;= d))
{
    return ((e &lt; std::min(std::max(0, a - g), b)) and 
            (f &lt; std::min(d, std::max(0, c - g))));
}
</code></pre>

<p>I am looking for the way of refactoring the expression to make it more readable.</p>
","<p>Optimization was the wrong term, but the code can be rewritten to find a better (more reduced, or succinct to the business) logic.</p>

<pre><code>X &lt; min(Y, Z)    &lt;=&gt;    X &lt; Y and X &lt; Z
X &lt; max(Y, Z)    &lt;=&gt;    X &lt; Y or X &lt; Z            (less usefull)
</code></pre>

<p>Then possible rewrites are</p>

<pre><code>return ((e &lt; std::min(std::max(0, a - g), b)) and 
        (f &lt; std::min(d, std::max(0, c - g))));

return ((e &lt; std::max(0, a - g) and e &lt; b)) and 
        (f &lt; d and  f &lt; std::max(0, c - g))));

return (e &lt; 0 or e &lt; a - g)
       and e &lt; b
       and f &lt; d
       and (f &lt; 0 or f &lt; c - g);
</code></pre>

<p>Depending on other constraints this might be reducable.</p>

<p>I would rather make a function <code>between</code> for the hard to read min+max.</p>

<pre><code>return e &lt; minmax(b, a - g, 0) and 
       f &lt; minmax(d, c - g, 0);
</code></pre>

<p>I did not call this between, as maxmin is feasible too.</p>

<hr>

<p><strong><em>Added</em></strong></p>

<p>@Jarod pointed me to the fact, that the OP mentioned all numbers would be <strong>unsigned</strong>. Then</p>

<pre><code>max(a - g, 0)
</code></pre>

<p>probably should have been</p>

<pre><code>a &gt; g ? a - g : 0
</code></pre>
"
"Rails & ActiveRecord - refactoring multiple identical where clauses","<p>I'm on Rails 5.</p>

<p>I've got to deal with a pretty complex query with multiple identical where clauses : </p>

<pre><code>::AllocatedBudget.joins(:account_code, :budget, account_code: [:place],
                          budget: [:fiscal_year, :budget_state])
                    .where(immeuble:            { id: place.id })
                    .where(situation_budget:    { codesituation: ['A', 'V']})
                    .where(plan_comptable:      { supprime: 'false' })
                    .where(budget:              { supprime: 'false'})
                    .where(situation_budget:    { supprime: 'false' })
                    .where(budget_previsionnel: { supprime: 'false' })
                    .where(exercice_comptable:  { supprime: 'false' })
</code></pre>

<p>First, you must know that my models are connected to an old database with ugly names. I've noticed that ActiveRecord need the custom names instead the models's names to perform the queries. I don't know why but it works only that way... If somebody could explain that it would be nice ;)</p>

<p>My real question is : can I write it in a better way ? There is so many time the same where clause ""supprime =  'false' "".</p>

<p>Thanks a lot ! :)</p>
","<p>Finaly I tried the design pattern ""Query Object"" with a mix of the solution of AndrewSwerlick</p>

<pre><code>module QueryObject
  class AllocatedBudgetQuery

    def self.call(filters = {}, relation = ::AllocatedBudget.all)
      new(filters, relation).tap(&amp;:call)
    end

    # filter can have the key/value as follow (key are symbols) :
    # place_id/string
    # current_fiscal_year/boolean
    # budget_state/['A', 'V', '*']
    def initialize(filters = {}, relation = ::AllocatedBudget.all)
      @relation     = relation
      @filters      = filters
    end

    def call
      conditions = {
        budget_previsionnel: { supprime: 'false' },
        budget: { supprime: 'false' }
      }

      # place filter
      conditions = conditions.merge(immeuble: { id: @filters[:place_id] }) if @filters.key?(:place_id)

      # situation budget filter
      conditions = conditions.merge(situation_budget: { codesituation: @filters[:budget_state] }) if @filters.key?(:budget_state)

      # main extract
      @relation = @relation.joins(:account_code,
                                  account_code: [:place],
                                  budget: %i[fiscal_year budget_state])
                           .where(conditions)

      # current fiscal year filter
      @relation = @relation.where(""#{Date.today.to_s} between exercice_comptable.datedebutexercice and exercice_comptable.datefinexercice"") if @filters.key?(:current_fiscal_year)
    end
  end
end
</code></pre>
"
"Can I refactor these functions into one generic function?","<p>I have a dozen classes that inherit from the same baseclass. For each class, I want to change the state when a property updates, so I have a function called UpdateProperty(oldValue, newValue). I'm looking for a way to make these generic, so when I add a new class, I don't have to add a new function. 
This is what I have:</p>

<pre><code>    public TicketType UpdateProperty(TicketType oldValue, TicketType newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }

    public Layout UpdateProperty(Layout oldValue, Layout newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }

    public Division UpdateProperty(Division oldValue, Division newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }

    public MasterDataList UpdateProperty(MasterDataList oldValue, MasterDataList newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }

    public MasterDataListItem UpdateProperty(MasterDataListItem oldValue, MasterDataListItem newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }


    public Ticket UpdateProperty(Ticket oldValue, Ticket newValue)
    {
        if (oldValue != newValue &amp;&amp; ObjectState != ObjectState.New &amp;&amp; ObjectState != ObjectState.Deleted)
        {
            ObjectState = ObjectState.Changed;
        }
        return newValue;
    }
</code></pre>

<p>As you can see, they all do the same. Could someone point me in the right direction?</p>

<p>Also see <a href=""https://dotnetfiddle.net/xXgRuv"" rel=""nofollow noreferrer"">https://dotnetfiddle.net/xXgRuv</a></p>
","<p>I would not only set the ObjectState, but also the property value inside the method.</p>

<p>Place the method inside the base class.</p>

<pre><code>public abstract class BaseClass
{
    public ObjectState ObjectState { get; private set; }

    protected bool Set&lt;T&gt;( ref T field, T value )
    {
        if Equals( field, value ) return false;
        field = value;
        if ( ObjectState == ObjectState.Unchanged )
          ObjectState = ObjectState.Changed;
        return true;
    }
}
</code></pre>

<p>and in your inherited class</p>

<pre><code>public class Foo : BaseClass
{
    private TicketType _ticketType;
    public TicketType TicketType 
    {
        get =&gt; _ticketType; 
        set =&gt; Set( ref _ticketType, value );
    }
}
</code></pre>
"
"Hoverable / clickable tooltip using tooltip-is-open not working in directive","<p>Using ng-mouseover/ng-mouseleave together with tooltip-is-open to set the state of tooltip, i'm able to create a tooltip that is still open when hovered</p>

<p>However when I try to refactor it into a directive with </p>

<pre><code>        element.on('mouseover', hoverIn);
        element.on('mouseleave', hoverOut);
</code></pre>

<p>the event fire but tooltip is still closed when mouse hover on tooltip region</p>

<p>Here's the plunker for both</p>

<p><a href=""https://plnkr.co/edit/6U2Dge8srf8C8SRNkPVK?p=preview"" rel=""nofollow noreferrer"">https://plnkr.co/edit/6U2Dge8srf8C8SRNkPVK?p=preview</a></p>

<p>Edit : Using ng-mouseover/ng-mouseleave, it flickers when the mouse move out of the parent div into the child, so any suggestion to improve both is greatly welcome, thank you.</p>
","<p>I have found the solution to your issue.it's issue of scope update so you can forcefully update your scope using <code>$apply</code>
You can change your hoverIn and hoverOut function </p>

<pre><code>hoverIn = function () {
    scope.tooltipState = true; // remove isOpen from here
    scope.$apply(); // force to apply scope
    console.log(""Event Fired"");
};

hoverOut = function () {
    scope.tooltipState = false; // remove isOpen from here
    scope.$apply(); // force to apply scope
    console.log(""Event Fired"");
};
</code></pre>

<p>Here is update plnkr <a href=""https://plnkr.co/edit/qCRA39H3ynq99Gmkiy66?p=preview"" rel=""nofollow noreferrer"">update plnkr</a></p>
"
"Android Studio refactor revert all lambdas and other Java 8 features","<p>I have an Android library project with </p>

<pre><code> compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
</code></pre>

<p>It uses a lot of lambdas, try with resources and etc. </p>

<p>How could I <strong>downgrade</strong> sourceCompatibility &amp; targetCompatibility to <strong>Java 1.6</strong> instead? </p>

<p>Is there such functionality built in Android Studio IDE?</p>
","<p>You can replace the lambda by placing the cursor inside the <code>-&gt;</code> and pressing <kbd>Alt</kbd> + <kbd>Enter</kbd> then select ""Replace lambda with...""</p>

<p><a href=""https://i.stack.imgur.com/tjmjO.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/tjmjO.png"" alt=""enter image description here""></a></p>

<hr>

<p><strong>You can do it on an entire file</strong> by expanding the menu and selecting ""Fix all...""</p>

<p><a href=""https://i.stack.imgur.com/hUX7A.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/hUX7A.png"" alt=""enter image description here""></a></p>

<hr>

<p><strong>You can do it on the whole project</strong> by following the above steps, but instead click ""Run inspection on...""</p>

<p><a href=""https://i.stack.imgur.com/atire.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/atire.png"" alt=""enter image description here""></a></p>

<p>Select ""Whole project""</p>

<p><a href=""https://i.stack.imgur.com/4LqJZ.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/4LqJZ.png"" alt=""enter image description here""></a></p>

<p>Once the inspection finishes, right click on the ""Lambda can be replaced..."" section and select ""Replace lambda with...""</p>

<p><a href=""https://i.stack.imgur.com/0A3oL.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/0A3oL.png"" alt=""enter image description here""></a></p>
"
"How to share logic among functions?","<p>I came across with an issue when developing a code with some similar blocks inside my code. My question is: <strong>What is the best approach to share logic among functions?</strong></p>

<p>Example:</p>

<p>The functions below contains the same if/else logic. How can we refactor this code in order to have a more concise and maintainable code?</p>

<pre><code>// pseudo code...

const hirer = 'woman';

const getPositions = () =&gt; {
 if (hirer === 'woman') {
   getPositionsFromWomen();
   // do other stufs here...
 } else if (hirer === 'man') {
   getPositionFromMen();
   // do other stufs here...
 }
 // maybe other stufs here...
}


const hire = (hirer) =&gt; {
  if (hirer === 'woman') {
    increaseWomenHiringRate(hirer);
    // do other stufs here...
  } else if (hirer === 'man') {
    increaseMenHiringRate(hirer);
    // do other stufs here...
  }
 setPositionClosed();
}
</code></pre>
","<p>One fairly standard way is to <em>parameterize</em> the logic. In this case, perhaps by putting the logic in a function that accepts functions it will call for each logical branch:</p>

<pre><code>const hirer = 'woman';

const hirerDispatch = (hirer, ifWoman, ifMan) =&gt; hirer === 'woman' ? ifWoman() : ifMan();

const getPositions = () =&gt; {
  hirerDispatch(hirer, getPositionsFromWomen, getPositionFromMen);
  // maybe other stuff here...
};

const hire = (hirer) =&gt; {
  hirerDispatch(hirer, () =&gt; increaseWomenHiringRate(hirer), () =&gt; increaseMenHiringRate(hirer));
  setPositionClosed();
};
</code></pre>

<p>More complex parameterization might involve passing in an object with function properties for the branches, including arguments to pass along (so we don't need wrappers like we do in <code>hire</code>), etc., etc.</p>
"
"javascript separating document.getElementById for reusability","<p>I am trying to assign value to isSelected based on condition below. It worked fine beofre refactoring. It is failing once i refactored. What may be my mistake</p>

<p><strong>Working Code</strong></p>

<pre><code>    var isSelected= false;
    var temp = isSelected?(document.getElementById(""Link"").disabled = false): 
(document.getElementById(""Link"").disabled = true);
</code></pre>

<p><strong>Refactored code (Not working)</strong></p>

<pre><code>var isSelected= false;
var myLink = document.getElementById(""Link"").disabled;
var temp = isSelected?(myLink = false): (myLink = true);
</code></pre>
","<p>The <code>disabled</code> property is a primitive, when you assign it to a variable, you assign the actual value, and not the reference to the property.</p>

<p>Instead cache the reference to the element that was returned from <code>document.getElementById()</code>:</p>

<pre><code>var isSelected= false;
var myLink = document.getElementById(""Link"");
myLink.disabled = !isSelected;
</code></pre>
"
"How to align avatar with other links to the right?","<p>I have seen several ways to align text or even an image to the right, but when i try to align a simple avatar with some text, i cant get it to work.
It actually used to work until I switched to material-ui-next, now I can't get them to align properly. 
So what I have is
<a href=""https://i.stack.imgur.com/35QxX.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/35QxX.png"" alt=""enter image description here""></a>
but I want to have Text1 on the left (like it is) and Text2 and the Avatar next to each other, and aligned on the right. All in the same line.
Bellow is the render part I have so far, which was actually different many times, and my last trial was using <code>&lt;li&gt;</code>, although I don't think I need it in this case, but I open to suggestion.</p>

<p>this is the render for the top container:</p>

<pre><code>  render() {
      return (

        &lt;div className=""main-container""&gt;
            &lt;div className=""links-container""&gt;
                &lt;div className=""logo-container""&gt;Text1&lt;/div&gt;
                &lt;div className=""right-links-container""&gt;
                    &lt;ul className=""right-list-container""&gt;
                        &lt;li&gt;&lt;a href=""""&gt;Text2&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;AccountInfo /&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;


                &lt;/div &gt;
            &lt;/div&gt;
        &lt;/div&gt;
      );
    }
  }
</code></pre>

<p>this is the render for the avatar:</p>

<pre><code>render() {
        return (

            &lt;div className=""profile-container""&gt;
                &lt;Avatar
                    src=""https://www.shareicon.net/data/2016/08/05/806962_user_512x512.png""
                    size={30}
                    onClick={this.handleAvatarClick}
                        /&gt;

                &lt;Popover
                    open={this.state.showMenu}
                    anchorEl={this.state.anchorEl}
                    anchorOrigin={{horizontal: 'left', vertical: 'bottom'}}
                    targetOrigin={{horizontal: 'left', vertical: 'top'}}
                    onRequestClose={this.handleCloseAccountInfoMenu}
                &gt;

                &lt;MenuList role=""menu""&gt;
                    &lt;MenuItem &gt;My account&lt;/MenuItem&gt;
                    &lt;MenuItem &gt;Logout&lt;/MenuItem&gt;
                  &lt;/MenuList&gt;
                &lt;/Popover&gt;
            &lt;/div&gt;
        );
      }
</code></pre>

<p>and the css:</p>

<pre><code>.main-container {
    margin-top: 10px;
    margin-bottom: 10px;
    width: 100%
}
.links-container {
    margin: 15px;
    text-align: right;
}
.logo-container {
    float: left;
}

.right-list-container a {
    text-decoration:none;
}
.right-list-container li:nth-child(1) {
    text-decoration:none;
    height:30px;
    display:block;
    background-position:right;
    padding-right: 15px;
}
ul {
    list-style-type:none;
    padding:0px;
    margin:0px;
}

.accountinfo-menu {
    width: 200px;
}
.profile-container {
    clear: both;
    vertical-align: middle;
    display: inline;
}
</code></pre>

<p>I feel like I am doing too much and I should be rather simple, but I can get it to look the way I want. Any suggestions? I can easily refactor this whole thing if I am doing it all wrong. Thank you!</p>
","<p>Here is a short snippet using flexbox. I think this is what you need.</p>

<pre><code>render() {
      return (

        &lt;div className=""main-container""&gt;
            &lt;div className=""links-container flexbox""&gt;

                &lt;div className=""logo-container""&gt;Text1&lt;/div&gt;

                &lt;div className=""right-links-container""&gt;
                    &lt;ul className=""right-list-container flexbox""&gt;
                        &lt;li&gt;&lt;Avatar /&gt;&lt;/li&gt;
                        &lt;li&gt;&lt;a href=""""&gt;Text2&lt;/a&gt;&lt;/li&gt; 
                    &lt;/ul&gt;
                &lt;/div&gt;

            &lt;/div&gt;
        &lt;/div&gt;
      );
    }
  }
</code></pre>

<p>CSS:</p>

<pre><code>    .flexbox{
        display:-webkit-box;
        display:-moz-box;
        display:-ms-flexbox;
        display:flex;
    }



 .links-container{
    align-items:center;
    width:100%;
    }

    .logo-container{
    width:auto;
    }

    .right-list-container{
    margin-left:auto;
    width:auto;
    align-items:center;
    }

    .right-list-container li{
    margin-right:10px;
    }
</code></pre>

<p><a href=""https://jsfiddle.net/jungrupak/pvdzofa9/9/"" rel=""nofollow noreferrer"">checkout the demo here:</a></p>
"
"Why does Jest try running my whole app rather than the imported modules?","<p>When I am trying to test a react component, I get errors from other components that are not imported into the tested module. </p>

<p>I would expect these errors to occur if I had imported the module as I am currently refactoring a lot of code and haven't got round to these files yet.</p>

<p>It's almost as if Jest is running all of my components before testing.
Here is one of the test files that cause this issue: 
</p>

<pre><code>import React from 'react';
import { LoginPage } from 'components';

describe('Login Page', () =&gt; {
  it('should render', () =&gt; {
    expect(shallow(&lt;LoginPage /&gt;)).toMatchSnapshot();
  });
  it('should use background passed into props', () =&gt; {
    const image = 'bg.png';
    const expected = {
      backgroundImage: image
    };
    const wrapper = shallow(&lt;LoginPage background={image} /&gt;);
    expect(wrapper.prop('style')).toEqual(expected);
  });
});
</code></pre>

<p>Loginpage.js</p>

<pre><code>import React from 'react';
import { LoginForm } from 'components';
import './LoginPage.css';

type Props = { background: string , logInRequest: Function};

const LoginPage = ({ background, logInRequest }: Props) =&gt; (
  &lt;div className=""login-page"" style={{backgroundImage: background}}&gt;
    &lt;LoginForm submit={logInRequest}/&gt;
  &lt;/div&gt;
);
</code></pre>

<p>Here is <code>setupTests.js</code>
</p>

<pre><code>import Enzyme, { shallow, mount, render } from 'enzyme';
import Adapter from 'enzyme-adapter-react-16';
import localStorage from 'mock-local-storage';

Enzyme.configure({ adapter: new Adapter() });

global.requestAnimationFrame = function(callback) {
  setTimeout(callback, 0);
};

global.shallow = shallow;
global.mount = mount;
global.render = render;
console.log = () =&gt; ({});
</code></pre>

<p>Stack trace: </p>

<pre><code>  at invariant (node_modules/invariant/invariant.js:42:15)
  at wrapWithConnect (node_modules/react-redux/lib/components/connectAdvanced.js:101:29)
  at Object.&lt;anonymous&gt; (src/containers/ApplicationList/ApplicationList.js:8:42)
  at Object.&lt;anonymous&gt; (src/containers/index.js:9:41)
  at Object.&lt;anonymous&gt; (src/components/CustomerDashboard/CustomerDashboard.js:2:19)
  at Object.&lt;anonymous&gt; (src/components/index.js:14:43)
  at Object.&lt;anonymous&gt; (src/components/LoginPage/LoginPage.test.js:2:19)
      at &lt;anonymous&gt;
  at process._tickCallback (internal/process/next_tick.js:188:7)
</code></pre>

<p>From reading the stack trace, I can assume that Jest is checking the list of exports inside <code>components/index.js</code> and <code>containers/index.js</code>.</p>

<p>Why is jest concerned with errors coming from a list of exports? I am not importing <code>containers/ApplicationList</code> into <code>LoginPage</code>, it is only referenced as a dependency through the list of exports.</p>

<p>I have found that if I remove <code>CustomerDashboard</code> from the export list, the issue goes away which says to me it's not an issue with importing into <code>LoginPage</code></p>

<p>Should I be using a relative import like <code>import LoginPage from './LoginPage</code> with the test in the same directory as <code>LoginPage</code> rather than <code>import { LoginPage } from 'components'</code>?</p>
","<p>When you <code>import</code> a module, it will resolve all it's dependencies. Your <code>AppWrap</code> must import <code>PaymentAccountForm</code> at some point.</p>

<p>You can enable <a href=""https://facebook.github.io/jest/docs/en/configuration.html#automock-boolean"" rel=""nofollow noreferrer"">auto mock</a> to narrow the depth, or you can mock all sub module manually with <a href=""https://facebook.github.io/jest/docs/en/jest-object.html#jestmockmodulename-factory-options"" rel=""nofollow noreferrer"">jest.mock</a> both will replace module with a mocked version when it is being required.</p>
"
"How can I get value from observable","<p>I have this function in my Kotlin project. I'm using <code>ReactiveNetwork</code> -
 Android library listening network connection state and Internet connectivity with RxJava Observables. I'm new to reactive programming and now I need to refactor this method to use this in many places. How can I refactor this method to just return state of internet connectivity (isConnected)? </p>

<pre><code>private fun downloadProductIfConnected(arguments: Bundle){
    ReactiveNetwork.checkInternetConnectivity().subscribeOn(Schedulers.io())
            .observeOn(AndroidSchedulers.mainThread())
            .subscribe{ isConnected -&gt;
                if (isConnected){
                    downloadAndOpenProduct(arguments)
                }else{
                    displayConnectionErrorDialog(arguments)
                }
            }
}
</code></pre>
","<p>Can make use of <strong>Higher-order functions</strong> here, like below</p>

<pre><code>private fun downloadProductIfConnected(callback:(Boolean)-&gt;Any){
  ReactiveNetwork.checkInternetConnectivity().subscribeOn(Schedulers.io())
                .observeOn(AndroidSchedulers.mainThread())
                .subscribe{ isConnected -&gt; callback(isConnected) }
    }
</code></pre>

<p>You can call like this</p>

<pre><code>downloadProductIfConnected { isConnected-&gt; onConnectionResult(isConnected) }


fun onConnectionResult(isConnected: Boolean){
    //do something with isConnected
}
</code></pre>
"
"Refactoring case statements with ""with"" statements","<p>I have a triple nested to case statement. It's a complete abomination going on in this controller action.</p>

<p>But, I'm happy that I'm in this situation because IMO one of the best ways to learn is seeing code do the same thing in many different approaches. That leads me to this question.</p>

<p>How can I refactor this bit of code to use <code>with</code> statements instead of <code>case</code>? All of the examples I'm finding online are more trivial that this example.</p>

<h3>CODE:</h3>

<pre><code>   case Nba.get_todays_games do
      {:ok, games} -&gt;
        game_id = Map.get(games, ""games"")
          |&gt; Enum.random
          |&gt; Map.get(""id"")
          :timer.sleep(1000)

      case Nba.get_game_summary(game_id) do
        {:ok, game} -&gt;
          team_id = Map.take(game, [""away"", ""home""])
            |&gt; Enum.random
            |&gt; elem(1)
            |&gt; Map.get(""id"")
            :timer.sleep(1000)

        case Nba.get_team_roster(team_id) do
          {:ok, team} -&gt;
            player_id   = Map.get(team, ""players"")
              |&gt; Enum.random
              |&gt; Map.get(""id"")

            player_name = Map.get(team, ""players"")
              |&gt; Enum.find(fn %{""id"" =&gt; id} -&gt; player_id == id end)
              |&gt; Map.get(""full_name"")
        end
      end
    end 
</code></pre>

<p>I've noticed that I simply can't refactor like this:</p>

<pre><code>with {:ok, games} &lt;- Nba.get_todays_games,  
     {:ok, game}  &lt;- Nba.get_todays_games(game_id),
     {:ok, team}  &lt;- Nba.get_team_roster(team_id)
</code></pre>

<p>I obviously need to do the logic in between to get the game_id and team_id. Thanks for the help!</p>
","<p>Just intersperse the <code>with</code> clauses with what you need to evaluate, and you are all set:</p>

<pre><code>with {:ok, games} &lt;- Nba.get_todays_games,
     game_id &lt;- evaluate_game_id(),
     {:ok, game}  &lt;- Nba.get_todays_games(game_id),
     team_id &lt;- evaluate_team_id(),
     {:ok, team}  &lt;- Nba.get_team_roster(team_id)
</code></pre>

<p>My advice would be to extract evaluation inside separate private functions to increase the readability.</p>
"
"c# - How could I refactor this switch statement to use minimum number code lines?","<pre><code>switch (userSelection)
{
    case 1:
        Console.WriteLine("" You selected: List1"");
        listTitle = ""List1 Title"";
        validAnswer = true;
        break;
    case 2:
        Console.WriteLine("" You selected: List2"");
        listTitle = ""List2 Title"";
        validAnswer = true;
        break;
    case 3:
        Console.WriteLine("" You selected: List3"");
        listTitle = ""List3 Title"";
        validAnswer = true;
        break;
    case 4:
        Console.WriteLine("" You selected: List4"");
        listTitle = ""List4 Title"";
        validAnswer = true;
        break;
        default:
        Console.WriteLine("" Your selection is invalid. Please 
        try again."");
        break;
}
</code></pre>
","<p>If you mean that your title is really not <code>List1 Title</code> but something more realistic, you can store those titles in <code>Dictionary</code> object:</p>

<pre><code>Dictionary&lt;int, string&gt; titles = new Dictionary&lt;int,string&gt;();
titles.Add(1, ""List1 Title""); //Any title here
titles.Add(2, ""List2 Title""); //Any title here
titles.Add(3, ""List3 Title""); //Any title here
titles.Add(4, ""List4 Title""); //Any title here

if (userSelection &gt; 0 &amp;&amp; userSelection &lt; 5)
{
    Console.WriteLine("" You selected: List"" + userSelection);
    listTitle = titles[userSelection];
    validAnswer = true;
}
else
{
    Console.WriteLine("" Your selection is invalid. Please try again."");
}
</code></pre>
"
"IntelliJ suggests 'replace()' could be replaced by compiled java.util.regex.Pattern construct","<p>One particular IntelliJ IDEA inspection gets triggered when I have code like:</p>

<pre><code>string1 = string2.replace(string3, string4);
</code></pre>

<p>The inspection says:</p>

<blockquote>
  <p>'replace()' could be replaced by compiled java.util.regex.Pattern construct.</p>
</blockquote>

<p>And then offers to refactor the code for me, which results in using a constant literal Pattern.</p>

<p>I have this inspection turned on mainly for cases where I'm actually creating a regex dynamically. It can sometimes improve performance if I follow IntelliJ's suggestion. But in the case of <code>String.replace()</code> the argument is not a regex. Is it true that following IntelliJ's suggestion in this case would not result in any performance improvement at all, and all it would do is hurt readability?</p>

<p>Is it possible to turn it off for <code>String.replace()</code> but keep it on for <code>String.replaceAll()</code> and <code>String.replaceFirst()</code>? I couldn't see such an option.</p>
","<p>The implementation<sup>1</sup> of <code>String.replace(String, String)</code> simply delegates to <code>Pattern.compile(...).matcher(...).replaceAll(...)</code>.  So I can't imagine a situation where using an explicit <code>Pattern</code> in user code would be <strong>less</strong> performant (indeed, in many cases it's likely to end up <strong>more</strong> performant).  Readability is, of course, a different question!</p>

<p>I'm not sure it's possible to configure the IntelliJ inspection, but you can <a href=""https://www.jetbrains.com/help/idea/suppressing-inspections.html"" rel=""nofollow noreferrer"">suppress it</a> for individual statements, methods, or classes.</p>

<hr>

<p><sub>1. At least in Oracle's JDK8.</sub></p>
"
"How Make Conditional Row Connector in Talend?","<p>I have a Talend job where I have a Postgres input component running a row connector into a tFileOutputDelimited control so I can write the results of the database query to a CSV file with a header line. When there are no rows resulting from the query, it still writes the CSV file with just the header line. I'd prefer it did not write the file at all.</p>

<p>How can I put a condition on the row connector, or refactor this flow, so that it does not run the tFileOutputDelimited component when the Postgres query yields 0 rows?</p>
","<p>Check the option ""do not generate empty file"" on the tFileOutputDelimited' advanced settings. When there are no rows, the file won't be created.</p>
"
".Net Standard 2.0 Class Library produces error CS0246","<p>So I am working on a Asp.Net Core 2.0 web application. I am doing some refactoring and wanted to move some classes into a referenced class library. I did some reading and found that .Net Standard is the new way to go about that. </p>

<p>So I created a new .Net Standard 2.0 Class library then created my class. I was able to compile the code just fine. I referenced the library in my Asp.Net Core 2.0 web app and everything was fine until I tried to use the class. It's just a simple model class no logic just properties. </p>

<p>When I try to use it I get  error CS0246: The type or namespace name 'LoginRequest' could not be found (are you missing a using directive or an assembly reference?). I have no idea what I am doing wrong. Any help at all would be greatly appreciated. </p>

<p>Thanks in advance</p>
","<p>I have gone through the same flaw. If you are adding a new file in .NET Standard library then you need to restart the Visual Studio to make that file's code come into effect. However, your intelisense will work without any VS restart.</p>

<p>Alternatively, you can add your class to an already existing file.</p>
"
"Most concise way to parse a three-digit number in Haskell (Trifecta)","<p>What is the idiomatic way parse three consecutive digits into a string?</p>

<p>The following works, but does not scale:</p>

<pre><code>threeDigits :: Parser Int
threeDigits = do
    d1 &lt;- digit
    d2 &lt;- digit
    d3 &lt;- digit
    return (digitToInt d1 * 100 + digitToInt d2 * 10 + digitToInt d3)
</code></pre>

<p>More generally, how can this scale for N numbers?</p>
","<p>Use <a href=""http://hackage.haskell.org/package/base-4.10.1.0/docs/Text-ParserCombinators-ReadP.html#v:count"" rel=""nofollow noreferrer""><code>count</code></a>.</p>

<pre><code>digits :: Int -&gt; Parser Int
digits n = read &lt;$&gt; count n digit
</code></pre>
"
"R + dplyr: most efficient refactoring of Booleans?","<p>I am working on a dataset of 300,000 items with 300 columns. I've been using dplyr for a lot of my dataset manipulation.</p>

<p>I'm importing the data as a CSV file with readr. There are quite a lot of optional boolean fields which are stored in the CSV character format as 'Y', 'N' or """". I currently import those as factors with readr.</p>

<p>I'm then trying to convert them to booleans. Been tri-state, I've done this as follows:</p>

<pre><code>importedData &lt;- dplyr::mutate(importedData,
    bar &lt;- (foo == 'Y'),
    bar &lt;- dplyr::if_else(
      foo,
      NA,
      bar),
    foo = NULL)
...repeated for about 30 fields.
)

importedData &lt;- dplyr::rename(importedData,
  foo = bar)
</code></pre>

<p>Is there a more efficient way to do this? Bonus marks for doing it in a single pass (ie so the variable is replaced in-place without the second rename call and/or so it can be phrased using tidyeval semantics).</p>
","<p>I am assuming that you have a large dataset and want to efficiently use available RAM. Here's something you could do:</p>

<pre><code>colsOfInterest &lt;- (""var1"", ""var2"", ""var3"")

for(i in colsOfInterest){
    importedData[i] &lt;- ifelse(is.na(importedData[i]),NA,
                              ifelse(importedData[i] == ""Y"", TRUE, FALSE))
    gc()
}
</code></pre>

<p>The call to <code>gc()</code> will ensure that you keep reusing the RAM that is available after each pass over a variable of interest to you. I have found that explicitly calling Garbage Collector is useful when you have RAM constraints. You are also replacing in-place instead of creating a total new set of variables, deleting old ones and renaming new to old variable names.</p>

<p>HTH!!</p>
"
"Unable to retrieve metadata error on add controller process","<p>I am currently working on a MVC Asp.net 5 project. I am using a code-first design. Here is my TrackerModels file.</p>

<pre><code>public class TrackerModels : DbContext
{
    public TrackerModels()
        : base(""name=TrackerModels"")
    {
    }

    public System.Data.Entity.DbSet&lt;ProjectTracker.Models.Project&gt; Projects { get; set; }
}

public class Project
{
    [Key]
    public int Id { get; set; }

    [Display(Name = ""Project"")]
    [Required]
    public string ProjectName { get; set; }
}

public class Group
{
    [Key]
    public int Id { get; set; }

    [Display(Name = ""Group Name"")]
    [Required]
    public string GroupName { get; set; }

    [ForeignKey(""ProjectId"")]
    [Required]
    public virtual Project ProjectId { get; set; }
}
</code></pre>

<p>Here is are my connection strings</p>

<pre><code>&lt;add name=""DefaultConnection"" connectionString=""Data Source=(LocalDb)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\aspnet-ProjectTracker-20171207081108.mdf;Initial Catalog=aspnet-ProjectTracker-20171207081108;Integrated Security=True"" providerName=""System.Data.SqlClient"" /&gt;
&lt;add name=""TrackerModels"" connectionString=""data source=(LocalDb)\MSSQLLocalDB;initial catalog=ProjectTracker.Models.TrackerModels;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework"" providerName=""System.Data.SqlClient"" /&gt;
</code></pre>

<p></p>

<p>I am trying to make a controller. See below for the settings I am using.</p>

<p><a href=""https://i.stack.imgur.com/bHAGc.png"" rel=""nofollow noreferrer"">Add Controller Dialog</a></p>

<p>But during the auto-generating part is going on I get the following error</p>

<p><a href=""https://i.stack.imgur.com/Sd5vZ.png"" rel=""nofollow noreferrer"">Controller Creation Error</a></p>

<p>I've been searching around the forum here but I haven't found an exact match to this error. However even similar issues and their corresponding fixes aren't working for me. This includes adding the Key attributes, DbSet, etc.</p>

<p>Any help would be appreciated along with any good sites/resources that may allow to learn why this happened.</p>

<p><strong>Update 1</strong>
I refactored my group class to the following but I still get the same error message.</p>

<pre><code>public class Group
{
    [Key]
    public int Id { get; set; }

    [Display(Name = ""Group Name"")]
    [Required]
    public string GroupName { get; set; }

    [Required]
    public int ProjectId { get; set; }


    [ForeignKey(""ProjectId"")]
    public virtual Project Project{ get; set; }
}
</code></pre>

<p><strong>Update 2</strong>
Turns out that I had to restart VS in order for it to not error out with the above fix. This is now working after restarting VS.</p>
","<p>Your foreign key should be an <code>int</code>. Restructure your <code>Group</code> class as follows:</p>

<pre><code>public class Group
{
    [Key]
    public int Id { get; set; }

    [Display(Name = ""Group Name"")]
    [Required]
    public string GroupName { get; set; }

    [Required]
    public int ProjectId { get; set; }

    [ForeignKey(""ProjectId"")]
    public virtual Project Project { get; set; }
}
</code></pre>
"
"Python implementation of the 24 game","<p>Below is my attempt to implement the 24 game in Python 2, I tried to follow the requirements specified from leetcode: <a href=""https://leetcode.com/problems/24-game/description/"" rel=""nofollow noreferrer"">https://leetcode.com/problems/24-game/description/</a></p>

<p>My approach is basically check all the permutations of the 4 provided numbers against all the permutations of 3 operations out of 4 (add, subtract, multiply and divide). </p>

<p>I used <code>iteratools.product()</code> to get the permutations of the operations because there could be repeated operations.</p>

<p>I have two questions:</p>

<ol>
<li>I am not sure if the 3 blocks of code inside my inner for loop cover all the cases, if it does, how can I prove that? For instance, I am not sure if I should check <code>((W op (X op Y) op Z))</code> or not.</li>
<li>I think in the worst case there would be 24 * 64 * 9 = 13824 calculations. Can the number of calculations be reduced? </li>
</ol>

<hr>

<pre><code>import itertools
class Solution(object):
    def judgePoint24(self, nums):
        """"""
        :type nums: List[int]
        :rtype: bool
        """"""
        Ops = list(itertools.product([add,sub,mul,div], repeat=3))
        for ns in set(itertools.permutations(nums)):
            for ops in Ops:
                # W = ns[0], X = ns[1], Y = ns[2], Z = ns[3]

                # (((W op X) op Y) op Z)
                result = ops[0](ns[0], ns[1])
                result = ops[1](result, ns[2])
                result = ops[2](result, ns[3])
                if 23.99 &lt; result &lt; 24.01:
                    return True

                # (Z op (Y op (W op X)))
                result = ops[0](ns[0], ns[1])
                result = ops[1](ns[2], result)
                result = ops[2](ns[3], result)
                if 23.99 &lt; result &lt; 24.01:
                    return True

                # ((W op X) op (Y op Z))
                result1 = ops[0](ns[0], ns[1])
                result2 = ops[1](ns[2], ns[3])
                result = ops[2](result1, result2)
                if 23.99 &lt; result &lt; 24.01:
                    return True
        return False

def add (a, b):
    return a+b
def sub (a, b):
    return a-b
def mul (a, b):
    return a*b
def div (a, b):
    if b == 0:
        return 0
    return a/float(b)
</code></pre>
","<p>Here are some general pointers.</p>

<ol>
<li>You can <a href=""https://docs.python.org/dev/library/functools.html#functools.lru_cache"" rel=""nofollow noreferrer"">cache</a> the result of some computations. This is probably not required in your case, but you should know how to trade off memory vs. time.</li>
<li>You can avoid repeated calculations (the expression <code>ops[0](ns[0], ns[1])</code> is evaluated three times in every iteration). Get the result once and insert it in further expressions.</li>
<li>The last point leads to a more general consideration: each expression can be represented as a <a href=""https://en.wikipedia.org/wiki/Binary_expression_tree"" rel=""nofollow noreferrer"">tree</a>. Right now you're brute-forcing all possible trees in an (almost) random order. Is there a way to do it in a ""smarter"" order? Sure! If the first two numbers are <code>9</code> and <code>9</code>, and you are at <code>9*9+(x op y)</code>, then it doesn't matter which operation you pick and what the remaining two numbers are - you will not be able to get down to 24. Try to think of more ""stop conditions"" when you don't need to continue evaluating.</li>
</ol>
"
"python manage.py makemigrations gives attributeError: module 'django.views.debug' has no attribute 'TECHNICAL_500_TEMPLATE' error","<p>I am setting my project as said in </p>

<p><a href=""https://github.com/vintasoftware/django-react-boilerplate"" rel=""nofollow noreferrer"">this project from github</a></p>

<p>Steps I took..</p>

<p>Started the project by this command
django-admin startproject theprojectname --extension py,yml,json --name Procfile,README.md,.env.example --template=<a href=""https://github.com/vintasoftware/django-react-boilerplate/archive/boilerplate-release.zip"" rel=""nofollow noreferrer"">https://github.com/vintasoftware/django-react-boilerplate/archive/boilerplate-release.zip</a></p>

<p>then i installed the pip packages</p>

<p>pip install -r requirements-to-freeze.txt
Saved them</p>

<p>pip freeze > requirements.txt</p>

<p>Ran the npm update commands</p>

<p>npm update --save
 npm update --save-dev</p>

<p>cp goDiary/settings/local.py.example goDiary/settings/local.py
cp .env.example .env
and after that</p>

<p>python manage.py makemigrations</p>

<p>And I have almost same code except that I refactored the name</p>

<p>After <code>making pip install -r requirements.txt</code></p>

<p>And the output when I am making the migrations is this</p>

<p>Are my confs correct?</p>

<pre><code>(myvenv2) shubhendu@shubhendu-HP-Pavilion-g6-Notebook-PC:/home/goDiary$ python manage.py makemigrations
Traceback (most recent call last):
  File ""manage.py"", line 27, in &lt;module&gt;
    execute_from_command_line(sys.argv)
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/django/core/management/__init__.py"", line 371, in execute_from_command_line
    utility.execute()
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/django/core/management/__init__.py"", line 347, in execute
    django.setup()
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/django/__init__.py"", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/django/apps/registry.py"", line 89, in populate
    app_config = AppConfig.create(entry)
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/django/apps/config.py"", line 90, in create
    module = import_module(entry)
  File ""/usr/lib/python3.5/importlib/__init__.py"", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File ""&lt;frozen importlib._bootstrap&gt;"", line 986, in _gcd_import
  File ""&lt;frozen importlib._bootstrap&gt;"", line 969, in _find_and_load
  File ""&lt;frozen importlib._bootstrap&gt;"", line 958, in _find_and_load_unlocked
  File ""&lt;frozen importlib._bootstrap&gt;"", line 673, in _load_unlocked
  File ""&lt;frozen importlib._bootstrap_external&gt;"", line 665, in exec_module
  File ""&lt;frozen importlib._bootstrap&gt;"", line 222, in _call_with_frames_removed
  File ""/home/goDiary/myvenv2/lib/python3.5/site-packages/fixmydjango/__init__.py"", line 22, in &lt;module&gt;
    original_TECHNICAL_500_TEMPLATE = debug.TECHNICAL_500_TEMPLATE
AttributeError: module 'django.views.debug' has no attribute 'TECHNICAL_500_TEMPLATE'
</code></pre>

<p>This is my</p>

<blockquote>
  <p>manage.py file</p>
</blockquote>

<pre><code>#!/usr/bin/env python

import os
import sys

from decouple import config


if __name__ == ""__main__"":
    settings_module = config('DJANGO_SETTINGS_MODULE', default=None)

    if sys.argv[1] == 'test':
        if settings_module:
            print(""Ignoring config('DJANGO_SETTINGS_MODULE') because it's test. ""
                  ""Using 'goDiary.settings.test'"")
        os.environ.setdefault(""DJANGO_SETTINGS_MODULE"", ""goDiary.settings.test"")
    else:
        if settings_module is None:
            print(""Error: no DJANGO_SETTINGS_MODULE found. Will NOT start devserver. ""
                  ""Remember to create .env file at project root. ""
                  ""Check README for more info."")
            sys.exit(1)
        os.environ.setdefault(""DJANGO_SETTINGS_MODULE"", settings_module)

    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv)
</code></pre>

<blockquote>
  <p>My wsgi.py</p>
</blockquote>

<pre><code>""""""
WSGI config for goDiary project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/1.10/howto/deployment/wsgi/
""""""

import os

from django.core.wsgi import get_wsgi_application

from whitenoise.django import DjangoWhiteNoise


os.environ.setdefault(""DJANGO_SETTINGS_MODULE"", ""config.settings.base"")

application = get_wsgi_application()
application = DjangoWhiteNoise(application)
</code></pre>
","<p>For those who might fall into this same issue, the discussion is happening on the project's github page, at <a href=""https://github.com/vintasoftware/django-react-boilerplate/issues/166"" rel=""nofollow noreferrer"">https://github.com/vintasoftware/django-react-boilerplate/issues/166</a></p>

<p>If you just want the answer, it's probably related to a wrong version of Django. Check if you've installed Django 1.11 and not Django 2.0 or some other version :)</p>
"
"Refactoring to make an Angular component better","<p>I have the following Angular component written in Typescript:</p>

<pre><code>export class ItemsComponent implements OnInit {

@Input()
invoice: Document;

@Input()
declaration: Document;

private invoiceName: string;
private declarationName: string;

constructor(private dataService: DataService) {
}

ngOnInit(): void {
    this.getInvoiceName(this.invoice);
    this.getDeclarationName(this.declaration);
}

getDeclarationName(declaration: Document) {
    this.dataService.getDocumentName(declaration.id)
        .subscribe((name) =&gt; this.declarationName = name);
}

getInvoiceName(invoice: Document) {
    this.dataService.getDocumentName(invoice.id)
        .subscribe((name) =&gt; this.invoiceName = name);
}
</code></pre>

<p>I have two items of the same type but I get them as inputs from different components and then I use them in my html template separately.
What I have right now is fine and works, but I find it too repetitive and it smells to me. </p>

<p>Do you have any idea how I can refactor it, so that I get just one method like <code>getDocumentName</code> for example and I can call it once inside the <code>onInit</code> but get the names of my <code>invoice</code> and my <code>declaration</code> separately? </p>
","<p>You can do something like this </p>

<pre><code>ngOnInit(): void {
    this.getDocumentNames();
}

getDocumentNames() {
    this.dataService.getDocumentName(this.declaration.id)
        .subscribe((name) =&gt; this.declarationName = name);
    this.dataService.getDocumentName(this.invoice.id)
        .subscribe((name) =&gt; this.invoiceName = name);
}
</code></pre>

<p>Then on the dataservice level you can do a share to optimize the http calls. </p>

<p>Or since you want to retrieve multiple names at the same time you can consider changing the dataService to support a method that receives an array of Ids and make only one call on the component </p>
"
"Can't find collision with JavaFx shape afrer perspective transform","<p>I have a group of rectangles (or polygons) with dynamicly calculated perspective transform (applied via drag'n'drop). The problem is that coordinates of rectangles are not up to date after this transform and I can't find collision with cars centers. <a href=""https://i.stack.imgur.com/WhWym.jpg"" rel=""nofollow noreferrer"">zones</a></p>

<p>As you can see on image, wrong zones are green because before drag'n'drop rectangles where on top left of imageVeiw.</p>

<p>Here how I'm trying to find collision:</p>

<pre><code>  rectGrpoup.getChildren().forEach(child -&gt; {
        final Predicate&lt;Car&gt; carInZone = car -&gt; {
            final Bounds boundsInLocal = mainController.getImageView().getBoundsInLocal();
            //different image size when detect and display
            Point fixedScalePoint = scaleService.fixScale(new Point(car.getLastCenter()), screenSize, new ScreenSize(boundsInLocal.getHeight(), boundsInLocal.getWidth()));
            //I need help in next line
            return Shape.intersect((Rectangle) child, new Rectangle(fixedScalePoint.getX(), fixedScalePoint.getY(), 10, 10)).getBoundsInLocal().getWidth() != -1;
        };

        if (cars.stream().anyMatch(carInZone)) {
          child.setFill(Color.GREEN);
          } else {
          child.setFill(Color.RED);
        }
    });
</code></pre>

<p>Where child is rectangle (or I can refactor for polygon) from group. 
Child has cordinates before transform, so predicate doesn't work.</p>

<p><a href=""https://youtu.be/AUQpFq58mgA"" rel=""nofollow noreferrer"">Presentation of program work</a></p>

<p>p.s. I can provide any code if it help</p>
","<p>PerspectiveTransform in JavaFX in fact extends class Effect and has nothing similar with real transformations (e.x. Rotate). </p>

<p>And the main difference is described in jdoc of the class: </p>

<blockquote>
  <p><p>
    Note that this effect does not adjust the coordinates of input events
    or any methods that measure containment on a {@code Node}.
    The results of mouse picking and the containment methods are undefined
    when a {@code Node} has a {@code PerspectiveTransform} effect in place.</p>
</blockquote>

<p>This means that changes on your shape are shown visually, but coordinates are not being updated.</p>

<p>Other solutions: </p>

<ul>
<li>Work with really 3D, e.x. - reach same effect with PerspectiveCamera</li>
<li>Get same effect with real transformations like rotation and zoom </li>
</ul>
"
"Why does my Redux reducer refactor fail?","<p>Here is an example of what I'm attempting to do:</p>

<pre><code>const setView = state =&gt; payload =&gt; ({ ...state, view: payload });

const reducers = {
  SET_VIEW: setView
};

export default (state = initialState, action) =&gt; reducers[action.type](state)(action.payload);
</code></pre>

<p>Unfortunately, I get the following error:</p>

<blockquote>
  <p>Uncaught TypeError: reducers[action.type] is not a function</p>
</blockquote>

<p>What exactly am I doing wrong?  <code>reducers</code> is an object literal with functions.  </p>
","<p>This is quite an obscure issue actually. The reason is because, per <a href=""http://redux.js.org/docs/api/createStore.html"" rel=""nofollow noreferrer"">the Redux documentation on <code>createStore</code></a>:</p>

<blockquote>
  <p>When a store is created, <strong>Redux dispatches a dummy action</strong> to your reducer to populate the store with the initial state. You are not meant to handle the dummy action directly. Just remember that your reducer should return some kind of initial state if the state given to it as the first argument is undefined, and you're all set.</p>
</blockquote>

<p>And this dummy action mentioned by the documentation just so happens to <a href=""https://github.com/reactjs/redux/blob/master/src/createStore.js#L261"" rel=""nofollow noreferrer"">be this line the source</a>:</p>

<pre><code>dispatch({ type: ActionTypes.INIT })
</code></pre>

<p>Here, <code>ActionTypes.INIT</code> is essentially the string <code>@@redux/INIT</code> followed by a random string of numbers and periods.</p>

<p>Thus, when you create the store with <code>createStore</code>, a dummy action is dispatched to your reducer, <strong>and that action type does not exist in your <code>reducers</code> object</strong>, thus you get the error that undefined isn't a function. That's why you <em>always</em> have a default case in your reducer. For example, with a switch statement, you always return state as a default case:</p>

<pre><code>switch(action.type) {
  ‚Ä¶
  default:
    return state;
}
</code></pre>

<p>The default case allows for the catching of actions such as the dummy action dispatched by Redux itself. The same principle applies to your code:</p>

<pre><code>export default (state = initialState, action) =&gt; reducers[action.type] ? reducers[action.type](state)(action.payload) : state;
</code></pre>

<p>This checks to see if the reducer actually exists in the <code>reducers</code> object. If it does, it calls the reducer. If not, just like in the default case, the state is just returned.</p>
"
"Add custom fields as cart item meta and order item meta in WooCommerce","<p>This is a plugin on how to add add cart item meta &amp; order item meta for my WooCommerce order. Initially my code below worked well for input type=text. It returns the label for value and the inputed value. </p>

<p>On conversion to <code>type=checkbox</code> the code returns <code>label</code> and <code>value=""on""</code> for those that are checked. </p>

<p>I would like to return the only <strong>value names of checked values</strong> (ignore the values unchecked). </p>

<p>A refactor to help include more checkboxes options would be helpful to reduce written code.</p>

<p>My code:</p>

<pre><code>&lt;?php
    global $woocommerce, $product, $post;

        add_action( 'woocommerce_before_add_to_cart_button', 'add_fields_before_add_to_cart' );

        function add_fields_before_add_to_cart( ) {
            ?&gt;

            &lt;div class=""simple-selects""&gt;
                &lt;div class=""col-md-6""&gt;
                    &lt;h3&gt;Main meals&lt;/h3&gt;
                    &lt;p&gt;&lt;input type=""checkbox"" name=""mm_chicken_cutlet_bento"" id=""mm_chicken_cutlet_bento""&gt;&lt;?php _e( ""Chicken Cutlet Bento"", ""aoim""); ?&gt;&lt;/p&gt;
                    &lt;p&gt;&lt;input type=""checkbox"" name=""mm_roasted_pork_rib_bento"" id=""mm_roasted_pork_rib_bento""&gt;&lt;?php _e( ""Roasted Pork Rib Bento"", ""aoim""); ?&gt;&lt;/p&gt;
                &lt;/div&gt;
            &lt;/div&gt;        

            &lt;?php
        }

        /**
         * Add data to cart item
         */
        add_filter( 'woocommerce_add_cart_item_data', 'add_cart_item_data', 25, 2 );
        function add_cart_item_data( $cart_item_meta, $product_id ) {

            if ( isset( $_POST ['mm_chicken_cutlet_bento'] ) &amp;&amp; isset( $_POST ['mm_roasted_pork_rib_bento'] ) ) {
                $custom_data  = array() ;
                $custom_data [ 'mm_chicken_cutlet_bento' ]    = isset( $_POST ['mm_chicken_cutlet_bento'] ) ?  sanitize_text_field ( $_POST ['mm_chicken_cutlet_bento'] ) : """" ;
                $custom_data [ 'mm_roasted_pork_rib_bento' ] = isset( $_POST ['mm_roasted_pork_rib_bento'] ) ? sanitize_text_field ( $_POST ['mm_roasted_pork_rib_bento'] ): """" ;
                $cart_item_meta ['custom_data']     = $custom_data ;
            }

            return $cart_item_meta;
        }

        /**
         * Display custom data on cart and checkout page.
         */
        add_filter( 'woocommerce_get_item_data', 'get_item_data' , 25, 2 );
        function get_item_data ( $other_data, $cart_item ) {
            if ( isset( $cart_item [ 'custom_data' ] ) ) {
                $custom_data  = $cart_item [ 'custom_data' ];

                $other_data[] = array( 'name' =&gt; 'Chicken Cutlet Bento', 'display'  =&gt; $custom_data['mm_chicken_cutlet_bento'] );
                $other_data[] = array( 'name' =&gt; 'Roasted Pork Rib Bento', 'display'  =&gt; $custom_data['mm_roasted_pork_rib_bento'] );
            }

            return $other_data;
        }

        /**
         * Add order item meta.
         */
        add_action( 'woocommerce_add_order_item_meta', 'add_order_item_meta' , 10, 2);
        function add_order_item_meta ( $item_id, $values ) {
            if ( isset( $values [ 'custom_data' ] ) ) {
                $custom_data  = $values [ 'custom_data' ];
                wc_add_order_item_meta( $item_id, 'Chicken Cutlet Bento', $custom_data['mm_chicken_cutlet_bento'] );
                wc_add_order_item_meta( $item_id, 'Roasted Pork Rib Bento', $custom_data['mm_roasted_pork_rib_bento'] );
            }
        }

?&gt;
</code></pre>
","<blockquote>
  <p><strong>Update</strong> <em>(related to comments)</em>: </p>
  
  <ul>
  <li><strong>Limit the functionality to only one product ID</strong></li>
  <li>Add all checkboxes values as a coma separated string</li>
  </ul>
</blockquote>

<p>To get easily the label names of your checkboxes as values and to ""refactor to help include more checkboxes options would be helpful to reduce written code"" I have added a simple function where you will set the key/value pairs for each checkbox you want to display and process‚Ä¶</p>

<p>So I have revisited all your code:</p>

<pre><code>// HERE set the array of pairs keys/values for your checkboxes
function custom_checkboxes(){
    return array(
        'mm_chicken_cutlet_bento'       =&gt; __( ""Chicken Cutlet Bento"", ""aoim""),
        'mm_roasted_pork_rib_bento'     =&gt; __( ""Roasted Pork Rib Bento"", ""aoim""),
    );
}

// Displaying the checkboxes
add_action( 'woocommerce_before_add_to_cart_button', 'add_fields_before_add_to_cart' );
function add_fields_before_add_to_cart( ) {
    global $product;
    if( $product-&gt;get_id() != 2 ) return; // Only for product ID ""2""

    ?&gt;
    &lt;div class=""simple-selects""&gt;
        &lt;div class=""col-md-6""&gt;
            &lt;h3&gt;&lt;?php _e(""Main meals"", ""aoim""); ?&gt;&lt;/h3&gt;
            &lt;?php foreach( custom_checkboxes() as $key =&gt; $value ): ?&gt;
                &lt;p&gt;&lt;input type=""checkbox"" name=""&lt;?php echo $key; ?&gt;"" id=""&lt;?php echo $key; ?&gt;""&gt;&lt;?php echo ' ' . $value; ?&gt;&lt;/p&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;?php
}


// Add data to cart item
add_filter( 'woocommerce_add_cart_item_data', 'add_cart_item_data', 25, 2 );
function add_cart_item_data( $cart_item_data, $product_id ) {
    if( $product_id != 2 ) return $cart_item_data; // Only for product ID ""2""

    // Set the data for the cart item in cart object
    $data = array() ;

    foreach( custom_checkboxes() as $key =&gt; $value ){
        if( isset( $_POST[$key] ) )
            $cart_item_data['custom_data'][$key] = $data[$key] = $value;
    }
    // Add the data to session and generate a unique ID
    if( count($data &gt; 0 ) ){
        $cart_item_data['custom_data']['unique_key'] = md5( microtime().rand() );
        WC()-&gt;session-&gt;set( 'custom_data', $data );
    }
    return $cart_item_data;
}


// Display custom data on cart and checkout page.
add_filter( 'woocommerce_get_item_data', 'get_item_data' , 25, 2 );
function get_item_data ( $cart_data, $cart_item ) {
    if( $cart_item['product_id'] != 2 ) return $cart_data; // Only for product ID ""2""

    if( ! empty( $cart_item['custom_data'] ) ){
        $values =  array();
        foreach( $cart_item['custom_data'] as $key =&gt; $value )
            if( $key != 'unique_key' ){
                $values[] = $value;
            }
        $values = implode( ', ', $values );
        $cart_data[] = array(
            'name'    =&gt; __( ""Option"", ""aoim""),
            'display' =&gt; $values
        );
    }

    return $cart_data;
}

// Add order item meta.
add_action( 'woocommerce_add_order_item_meta', 'add_order_item_meta' , 10, 3 );
function add_order_item_meta ( $item_id, $cart_item, $cart_item_key ) {
    if ( isset( $cart_item[ 'custom_data' ] ) ) {
        $values =  array();
        foreach( $cart_item[ 'custom_data' ] as $key =&gt; $value )
            if( $key != 'unique_key' ){
                $values[] = $value;
            }
        $values = implode( ', ', $values );
        wc_add_order_item_meta( $item_id, __( ""Option"", ""aoim""), $values );
    }
}
</code></pre>

<p><em>This code goes in function.php file of your active child theme (or theme) or also in any plugin file.</em></p>

<p>Tested and works. </p>

<hr>

<p>You will get something like this:</p>

<p><a href=""https://i.stack.imgur.com/Shgh4.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/Shgh4.png"" alt=""enter image description here""></a></p>

<blockquote>
  <p>I have added ""Option"", as label to avoid the value repetition‚Ä¶ </p>
</blockquote>
"
"Using PowerMockito how do I verify a constructor was called, with a specific set of arguments","<p>Note: In anticipation of those that would like to point out the bad design of having code which constructs objects inside it, rather than via dependency injection, or factories, which are easily mocked; I am dealing with writing tests for legacy code, where refactoring the code into a more modern design is not an option.</p>

<p>I have a command method that when it executes will construct three objects in the class MyObjectWrapper, which is dependent on another class MyObject. In the test, both of these classes and the 6 objects are all mocked. Consider the following code:</p>

<pre><code>@RunWith(PowerMockRunner.class)
@PrepareForTest(MyCommand.class)
public class MyCommandTest {

    @Mock public MyObject objectOne;
    @Mock public MyObject objectTwo;
    @Mock public MyObject objectThree;

    @Mock public MyObjectWrapper wrapperOne;
    @Mock public MyObjectWrapper wrapperTwo;
    @Mock public MyObjectWrapper wrapperThree;

    private MyCommand command;

    @Before public void beforeEach() {
        command = new MyCommand();
        MockitoAnnotations.initMocks(this);
        initialiseWrapper(wrapperOne, objectOne, true, false);
        initialiseWrapper(wrapperTwo, objectTwo, false, false);
        initialiseWrapper(wrapperThree, objectThree, true, true);
    }

    private void initialiseWrapper(MyObjectWrapper wrapperMock, MyObject objMock, boolean option1, boolean option2) {
        wrapperMock = PowerMockito.mock(MyObjectWrapper.class);
        PowerMockito.whenNew(MyObjectWrapper.class)
            .withParameters(MyObject.class, Boolean.class, Boolean.class)
            .withArguments(objMock, option1, option2)
            .thenReturn(wrapperMock);
    }

    @Test public void testConstructoresCalled() throws Exception {
        command.execute();

        VERIFY constructor with arguments: objectOne, true, false
        VERIFY constructor with arguments: objectTwo, false, false
        VERIFY constructor with arguments: objectThree, true, true
    }
}
</code></pre>

<p>I know that I could confirm that the constructor was called 3 times with:</p>

<pre><code>PowerMockito.verifyNew(MyObjectWrapper.class, times(3));
</code></pre>

<p>However I need to confirm that the constructors were called, with the three passed in arguments. Is it possible to do this?</p>
","<p><a href=""https://static.javadoc.io/org.powermock/powermock-api-mockito/1.6.3/org/powermock/api/mockito/PowerMockito.html#verifyNew-java.lang.Class-"" rel=""nofollow noreferrer"">PowerMockito.html#verifyNew</a> returns a <code>ConstructorArgumentsVerification</code>, so use the returned object, see <a href=""https://static.javadoc.io/org.powermock/powermock-api-mockito/1.6.3/org/powermock/api/mockito/verification/ConstructorArgumentsVerification.html"" rel=""nofollow noreferrer""><code>ConstructorArgumentsVerification</code> javadoc</a></p>
"
"States in TabStackNavigator?","<p>It seems like TabNavigator doesn't have it's own state. Is there any way to use <code>state</code> or <code>props</code>? </p>

<p>I want to show <code>the number of unread notification</code> on the Notification TabIcon. </p>

<pre><code>export default TabNavigator(
  {
    ...
    Noti: {
      screen: NotificationStackNavigator,
    },
    ...
  },
  {
    navigationOptions: ({ navigation }) =&gt; ({
      header: null,
      tabBarIcon: ({ focused }) =&gt; {
        const { routeName } = navigation.state;
        let iconName;
        switch (routeName) {
          ...
          case 'Noti':
            iconName = 'ios-notifications';
            break;
          ...
        }
        ...
        if(iconName == 'ios-notifications') {
          return (
            &lt;IconBadge
              MainElement={
                &lt;Ionicons
                  name={iconName}
                  size={30}
                  style={{ marginBottom: -3 }}
                  color={focused ? Colors.tabIconSelected : Colors.tabIconDefault}/&gt;
              }
              BadgeElement={
                &lt;Text style={{color:'#FFFFFF'}}&gt;
                    {{this.state.notifications}} // my goal
                &lt;/Text&gt;
              }
              IconBadgeStyle={{
                backgroundColor: '#f64e59',
                position: 'absolute',
                right:-10,
                top:0,
                }}
            /&gt;
          );
        }
        ...
</code></pre>

<p>Please let me know if anything is unclear. Thanks in advance</p>

<p><strong>UPDATE</strong> I'm planning to refactor my TabNavigator. Is this what you're trying to say?</p>

<pre><code>export default TabNavigator( 

to 

const MainTabNavigator = TabNavigator(

class MainTabNavigator extends Component {
    state = {notification}

export default connect(...)(MainTabNavigator);
</code></pre>

<p><strong>UPDATE 2</strong> MainTabNavigator's Top Level component is another TabNavigator. Is there any other solution? </p>

<pre><code>const RootTabNavigator = TabNavigator ({
    Auth: {
      screen: AuthStackNavigator,
    },
    Welcome: {
      screen: WelcomeScreen,
    },
    Main: {
      screen: MainTabNavigator,
    },
</code></pre>
","<p>You can pass additional custom props via <code>screenprops</code></p>

<pre><code>const TabNav = TabNavigator({
  // config
});

&lt;TabNav
  screenProps={/* this prop will get passed to the screen components as this.props.screenProps */}
/&gt;
</code></pre>

<p>The full documentation is <a href=""https://reactnavigation.org/docs/navigators/tab"" rel=""nofollow noreferrer"">here</a></p>
"
"How to deal with old transactions when dealing with restoring purchases?","<p>I'm currently developing and testing my app with a sandbox user. Even though the transactions have been completed, when I try to <code>Restore Purchases</code>, I get as much as 32 old transactions from the queue. </p>

<p>Essentially I would like to alert as in <code>Your purchase is being restored. Upon completion this dialog will close.</code> and dismiss it when it's finished.</p>

<pre><code>private func showRestoreInProgressAlert() {
        let alert = UIAlertController(title: ""Restoring Purchase"", message: ""Your purchase history is being restored. Upon completion this dialog will close."", preferredStyle: .alert)
        present(alert, animated: true, completion: nil)

        NotificationCenter.default.addObserver(self, selector: #selector(dismissRestoreInProgressAlert(notification:)), name: SubscriptionService.restoreSuccessfulNotification, object: nil)
    }
</code></pre>

<p>You may recognise this method below from <code>SKPaymentTransactionObserver</code>. Once the notification <code>.restoreSuccessfulNotification</code> has been sent, the alert would be dismissed as expected. But because there are 32 transactions in the queue, the popup keeps appearing and disappearing 32 times.</p>

<pre><code>func handleRestoredState(for transaction: SKPaymentTransaction, in queue: SKPaymentQueue) {
        print(""Purchase restored for product id: \(transaction.payment.productIdentifier)"")
        queue.finishTransaction(transaction)
        SubscriptionService.shared.uploadReceipt { (success) in
            DispatchQueue.main.async {
                NotificationCenter.default.post(name: SubscriptionService.restoreSuccessfulNotification, object: nil)
            }
        }
    }


func paymentQueue(_ queue: SKPaymentQueue,
                      updatedTransactions transactions: [SKPaymentTransaction]) {

        for transaction in transactions {
            switch transaction.transactionState {
            case .purchasing:
                handlePurchasingState(for: transaction, in: queue)
            case .purchased:
                handlePurchasedState(for: transaction, in: queue)
            case .restored:
                handleRestoredState(for: transaction, in: queue)
            case .failed:
                handleFailedState(for: transaction, in: queue)
            case .deferred:
                handleDeferredState(for: transaction, in: queue)
            }
        }
    }
</code></pre>

<p>I already finish the transactions both in <code>handlePurchasedState</code> and <code>handleRestoredState</code> like this:</p>

<pre><code>queue.finishTransaction(transaction)
</code></pre>

<p>So why do I still have so many old transactions sitting in the queue, whenever I click restore purchases?</p>

<p><strong>UPDATE</strong></p>

<p>This could be indeed an issue with the sandbox.</p>

<p>I tried to do a count but that doesn't help, simply because not all these transactions seem to be restorable.</p>

<p>I did the ""hard-reset"":</p>

<pre><code>for transaction: AnyObject in SKPaymentQueue.default().transactions {
            guard let currentTransaction: SKPaymentTransaction = transaction as? SKPaymentTransaction else {return}
            SKPaymentQueue.default().finishTransaction(transaction as! SKPaymentTransaction)
        }
</code></pre>

<p>Now it seems that slowly the transactions are reducing to zero, which means Sandbox is now losing them.</p>

<p>Why is <code>SKPaymentQueue.default().finishTransaction()</code> working, but <code>queue.finishTransaction()</code> didn't? Should I refactor my code to use <code>SKPaymentQueue.default().finishTransaction()</code> instead to be on the safe side? Or is that just a bad day with the IAP sandbox?</p>
","<p>Restoration re-delivers all purchases to your transaction observer delegate. That is the intended behaviour. </p>

<p>However, displaying the alert in the way that you want is quite straight-forward. </p>

<ol>
<li><p>When the user starts the restore operation, display the alert. </p></li>
<li><p>Then, once all items are restored, you will get a call to the <a href=""https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver/1506101-paymentqueuerestorecompletedtran"" rel=""nofollow noreferrer""><code>paymentQueueRestoreCompletedTransactionsFinished</code></a> delegate method. In this method you can dismiss your alert. </p></li>
</ol>
"
"cocos2d-x menu item error with callback function","<p>I have this code from 5 years ago: </p>

<pre><code>CCMenuItemSprite* quitItem = CCMenuItemSprite::create(quitLabel,quitLabel2,quitLabel3,this,menu_selector(ClearScene::call_quitItem));
</code></pre>

<p>I'm refactoring the code and migrate to the latest cocos2d-x. The above example keeps giving me error: </p>

<pre><code>error: invalid static_cast from type 'void (MyScene::*)()' to type 'cocos2d::SEL_SCHEDULE {aka void (cocos2d:Ref::*)(float)}'
</code></pre>

<p>I have tried using <code>CC_CALLBACK_n</code> but still not working. (similar to <code>HelloWorld.cpp</code> file: </p>

<pre><code>auto closeItem = MenuItemImage::create(""CloseNormal.png"",""CloseSelected.png"",CC_CALLBACK_1(HelloWorld::menuCloseCallback, this));
</code></pre>
","<p>looks like param issue. Does your <code>call_quitItem</code> takes <code>Ref* sender</code>? I remember it was optional in <code>v1.x</code></p>
"
"How to store data via relationship in constructor of SQLAlchemy model?","<p>How to add objects in the constructor with relationship? The id is not yet ready when constructor is evaluated. In simpler cases it is possible to just provide a list, calculated beforehand. In the example below I tried to say there is a <code>complex_cls_method</code>, in a way it is more like black box.</p>

<pre><code>from sqlalchemy import create_engine, MetaData, Column, Integer, String, ForeignKey
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import relationship
from sqlalchemy.orm import sessionmaker

DB_URL = ""mysql://user:password@localhost/exampledb?charset=utf8""

engine = create_engine(DB_URL, encoding='utf-8', convert_unicode=True, pool_recycle=3600, pool_size=10)
session = sessionmaker(autocommit=False, autoflush=False, bind=engine)()

Model = declarative_base()


class User(Model):
    __tablename__ = 'user'
    id = Column(Integer, primary_key=True)
    simple = Column(String(255))
    main_address = Column(String(255))
    addresses = relationship(""Address"",
                             cascade=""all, delete-orphan"")

    def __init__(self, addresses, simple):
        self.simple = simple
        self.main_address = addresses[0]
        return  # because the following does not work
        self.addresses = Address.complex_cls_method(
            user_id_=self.id,  # &lt;-- this does not work of course
            key_=""address"",
            value_=addresses
        )


class Address(Model):
    __tablename__ = 'address'
    id = Column(Integer, primary_key=True)
    keyword = Column(String(255))
    value = Column(String(255))
    user_id = Column(Integer, ForeignKey('user.id'), nullable=False)
    parent_id = Column(Integer, ForeignKey('address.id'), nullable=True)

    @classmethod
    def complex_cls_method(cls, user_id_, key_, value_):
        main = Address(keyword=key_, value="""", user_id=user_id_, parent_id=None)
        session.add_all([main])
        session.flush()
        addrs = [Address(keyword=key_, value=item, user_id=user_id_, parent_id=main.id) for item in value_]
        session.add_all(addrs)
        return [main] + addrs


if __name__ == ""__main__"":
    # Model.metadata.create_all(engine)
    user = User([u""address1"", u""address2""], ""simple"")
    session.add(user)
    session.flush()

    # as it can't be done in constructor, these additional statements needed 

    user.addresses = Address.complex_cls_method(
        user_id_=user.id,
        key_=""address"",
        value_=[u""address1"", u""address2""]
    )
    session.commit()
</code></pre>

<p>The question is, is there syntactically elegant (and technically sound) way to do this with User's constructor, or is it safer to just call a separate method of User class after session.flush to add desired objects to relationships (as in the example code)?</p>

<p>Giving up on constructor altogether is still possible, but less desirable option as resulting signature change would require significant refactorings.</p>
","<p>Instead of manually flushing and setting ids etc. you could let SQLAlchemy handle persisting your object graph. You'll just need one more <a href=""http://docs.sqlalchemy.org/en/latest/orm/self_referential.html"" rel=""nofollow noreferrer"">adjacency list relationship</a> in <code>Address</code> and you're all set:</p>

<pre><code>class User(Model):
    __tablename__ = 'user'
    id = Column(Integer, primary_key=True)
    simple = Column(String(255))
    main_address = Column(String(255))
    addresses = relationship(""Address"",
                             cascade=""all, delete-orphan"")

    def __init__(self, addresses, simple):
        self.simple = simple
        self.main_address = addresses[0]
        self.addresses = Address.complex_cls_method(
            key=""address"",
            values=addresses
        )


class Address(Model):
    __tablename__ = 'address'
    id = Column(Integer, primary_key=True)
    keyword = Column(String(255))
    value = Column(String(255))
    user_id = Column(Integer, ForeignKey('user.id'), nullable=False)
    parent_id = Column(Integer, ForeignKey('address.id'), nullable=True)
    # For handling parent/child relationships in factory method
    parent = relationship(""Address"", remote_side=[id])

    @classmethod
    def complex_cls_method(cls, key, values):
        main = cls(keyword=key, value="""")
        addrs = [cls(keyword=key, value=item, parent=main) for item in values]
        return [main] + addrs    

if __name__ == ""__main__"":
    user = User([u""address1"", u""address2""], ""simple"")
    session.add(user)
    session.commit()
    print(user.addresses)
</code></pre>

<p>Note the absence of manual flushes etc. SQLAlchemy automatically figures out the required order of insertions based on the object relationships, so that dependencies between rows can be honoured. This is a part of the <a href=""http://docs.sqlalchemy.org/en/latest/orm/session_basics.html"" rel=""nofollow noreferrer"">Unit of Work</a> pattern.</p>
"
"What's the difference between Character.toUpperCase() and Character.toTitleCase()","<p>I was refactoring some of my old code and then I found out that I'd used <code>Character.toTitleCase()</code> method at some point and couldn't help myself wondering if <code>Character.toUpperCase()</code> would be better.</p>

<p>I read their descriptions and didn't see any basic difference:</p>

<blockquote>
  <p><a href=""https://docs.oracle.com/javase/8/docs/api/java/lang/Character.html#toUpperCase-char-"" rel=""nofollow noreferrer"">toUpperCase</a></p>
  
  <p>Converts the character
  argument to uppercase using case mapping information from the
  UnicodeData file. Note that
  Character.isUpperCase(Character.toUpperCase(ch)) does not always
  return true for some ranges of characters, particularly those that are
  symbols or ideographs.</p>
  
  <p>In general, String.toUpperCase() should be used to map characters to
  uppercase. String case mapping methods have several benefits over
  Character case mapping methods. String case mapping methods can
  perform locale-sensitive mappings, context-sensitive mappings, and 1:M
  character mappings, whereas the Character case mapping methods cannot.</p>
  
  <p>Note: This method cannot handle supplementary characters. To support
  all Unicode characters, including supplementary characters, use the
  toUpperCase(int) method.</p>
</blockquote>

<p>and</p>

<blockquote>
  <p><a href=""https://docs.oracle.com/javase/8/docs/api/java/lang/Character.html#toTitleCase-char-"" rel=""nofollow noreferrer"">toTitleCase</a></p>
  
  <p>Converts the character argument to titlecase using case mapping
  information from the UnicodeData file. If a character has no explicit
  titlecase mapping and is not itself a titlecase char according to
  UnicodeData, then the uppercase mapping is returned as an equivalent
  titlecase mapping. If the char argument is already a titlecase char,
  the same char value will be returned. Note that
  Character.isTitleCase(Character.toTitleCase(ch)) does not always
  return true for some ranges of characters.</p>
  
  <p>Note: This method cannot handle supplementary characters. To support
  all Unicode characters, including supplementary characters, use the
  toTitleCase(int) method.</p>
</blockquote>

<p>Then I tried to test them like this:</p>

<pre><code>public class Test {
  public static void main(String... args) {

    String originalString = ""abcdefghijklmnopqrstuvwxyz123546-.,/*&amp;%+"";
    StringBuilder upperCaseStringBuilder = new StringBuilder();
    StringBuilder titleCaseStringBuilder = new StringBuilder();

    for (int i = 0; i &lt; originalString.length(); i++) {
      upperCaseStringBuilder.append(Character.toUpperCase(originalString.charAt(i)));
      titleCaseStringBuilder.append(Character.toTitleCase(originalString.charAt(i)));
    }

    System.out.println(""Original String : "" + originalString);
    System.out.println(""UpperCase result: "" + upperCaseStringBuilder.toString());
    System.out.println(""TitleCase result: "" + titleCaseStringBuilder.toString());
  }
}
</code></pre>

<p>This is the output:</p>

<pre><code>Original String : abcdefghijklmnopqrstuvwxyz123546-.,/*&amp;%+
UpperCase result: ABCDEFGHIJKLMNOPQRSTUVWXYZ123546-.,/*&amp;%+
TitleCase result: ABCDEFGHIJKLMNOPQRSTUVWXYZ123546-.,/*&amp;%+
</code></pre>

<p>So I couldn't understand the difference between these two methods. As I said before, I used <code>toTitleCase()</code> in my code to capitalize a <code>String</code>. </p>

<p>Are there any key difference which I didn't consider and which may lead my code to behave other than expected in some special cases?</p>
","<p>Standard ASCII characters are so boring!  Here's something <a href=""https://en.wikipedia.org/wiki/Digraph_(orthography)#In_Unicode"" rel=""nofollow noreferrer"">more exciting</a>:</p>

<pre><code>System.out.println(Character.toTitleCase('«≥'));  // «≤
System.out.println(Character.toUpperCase('«≥'));  // «±
</code></pre>

<p><a href=""https://ideone.com/w2uesU"" rel=""nofollow noreferrer"">Live demo.</a></p>
"
"Is it possible to store a chunk of JS in a variable?","<p>I realize this might go into the ""worst practices"" column but as an experiment I'm trying to refactor a function to the smallest length possible.</p>

<p>The following two lines work great.</p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>let prefix = document.querySelectorAll("".box"")[0];
prefix.style.position = ""absolute"";</code></pre>
</div>
</div>
</p>

<p>But when I tried to include code with the target it imploded.<br>
<div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>let prefix = 'document.querySelectorAll("".box"")[0].style.position';
[prefix] = ""absolute"";</code></pre>
</div>
</div>
</p>

<p>Is something like that even possible or have I crossed the line into a no-go zone?  Thanks so much for any shove in the right direction!</p>
","<p>You could return the code from a function handle as follow;</p>

<pre><code>var prefix=function(position){
    document.querySelectorAll("".box"")[0].style.position=position;
};
</code></pre>

<p>you can use it like this;</p>

<pre><code>prefix(""absolute"");
</code></pre>
"
"angularjs - refactor XMLHttpRequest to $http","<p>I want the following code </p>

<pre><code>var request = new XMLHttpRequest();
    request.open(""PUT"", dbServer + ""/configItemAdd"");
    request.send(new FormData(form));
    request.onreadystatechange = function () {
        if(request.readyState == 4 &amp;&amp; request.status == 200) {   window.location.reload(); }
};
</code></pre>

<p>to look like this </p>

<pre><code>     const fd = new FormData(form);
     $http({
         method: 'PUT',
         url: dbServer + ""/configItemAdd"",
         data: fd
     }).then(function (resp){
         window.location.reload();
     });
</code></pre>

<p>the problem is I get two error messages:
with just labels and no file input I get 
SyntaxError: Unexpected token # in JSON at position 0</p>

<p>and with file input I get 
PayloadTooLargeError: request entity too large</p>

<p>the XMLHttpRequest code is working with and without input files.
Please help :S</p>
","<p>You have to add an extra header i.e. <code>{'Content-Type': 'multipart/form-data'}</code> to your request</p>

<pre><code>const fd = new FormData(form);
 $http({
     method: 'PUT',
     url: dbServer + ""/configItemAdd"",
     Content-Type: 'multipart/form-data'
     data: fd
 }).then(function (resp){
     window.location.reload();
 });
</code></pre>
"
"Unable to delete project from Eclipse Oxygen workspace","<p>When trying to delete a project from Eclipse Oxygen, nothing happens and an exception is written in the logs.
I simply right-click on a project in the package explorer and I choose the 'delete' option. I am using Eclipse Oxygen.1a (4.7.1a). Here is the complete build information :</p>

<pre>
Eclipse Platform
Version: Oxygen.1a (4.7.1a)
Build id: M20171009-0410
OS: Linux, v.4.13.0-19-generic, x86_64 / gtk 3.22.25</pre>

<p>Here is a sample stack trace :</p>

<pre>!ENTRY org.eclipse.ui 4 0 2017-12-20 12:40:25.379
!MESSAGE Unhandled event loop exception
!STACK 0
org.eclipse.e4.core.di.InjectionException: java.lang.NullPointerException
        at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:65)
        at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:305)
        at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:239)
        at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132)
        at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:152)
        at org.eclipse.core.commands.Command.executeWithChecks(Command.java:494)
        at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:487)
        at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:210)
        at org.eclipse.ui.internal.handlers.LegacyHandlerService.executeCommandInContext(LegacyHandlerService.java:442)
        at org.eclipse.ui.internal.ide.actions.LTKLauncher.runCommand(LTKLauncher.java:96)
        at org.eclipse.ui.internal.ide.actions.LTKLauncher.openDeleteWizard(LTKLauncher.java:48)
        at org.eclipse.ui.actions.DeleteResourceAction.run(DeleteResourceAction.java:449)
        at org.eclipse.jdt.internal.ui.refactoring.reorg.DeleteAction.run(DeleteAction.java:194)
        at org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:271)
        at org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:249)
        at org.eclipse.jface.action.Action.runWithEvent(Action.java:473)
        at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:565)
        at org.eclipse.jface.action.ActionContributionItem.lambda$4(ActionContributionItem.java:397)
        at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:86)
        at org.eclipse.swt.widgets.Display.sendEvent(Display.java:5268)
        at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1348)
        at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4522)
        at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:4107)
        at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1150)
        at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)
        at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1039)
        at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:153)
        at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:680)
        at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)
        at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:594)
        at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:148)
        at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:151)
        at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)
        at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)
        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)
        at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:653)
        at org.eclipse.equinox.launcher.Main.basicRun(Main.java:590)
        at org.eclipse.equinox.launcher.Main.run(Main.java:1499)
        at org.eclipse.equinox.launcher.Main.main(Main.java:1472)
Caused by: java.lang.NullPointerException
        at org.eclipse.ltk.ui.refactoring.resource.DeleteResourcesWizard$DeleteResourcesRefactoringConfigurationPage.createControl(DeleteResourcesWizard.java:93)
        at org.eclipse.ltk.internal.ui.refactoring.RefactoringWizardDialog2.createContents(RefactoringWizardDialog2.java:627)
        at org.eclipse.jface.window.Window.create(Window.java:426)
        at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1096)
        at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:179)
        at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
        at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:203)
        at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:122)
        at org.eclipse.ltk.internal.ui.refactoring.actions.DeleteResourcesHandler.execute(DeleteResourcesHandler.java:41)
        at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:291)
        at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:92)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:55)
        ... 44 more</pre>

<p>Any idea how to solve this issue ? Or any work-around ?</p>
","<p>As I suspected the issue was related to the GUI, I tried running eclipse with GTK 2 instead of GTK 3. So I added the following lines to <code>eclipse.ini</code> :</p>

<pre>--launcher.GTK_version
2</pre>

<p>And the problem was gone. I could again delete projects without any problem.<br />
Here is my complete build information :</p>

<pre>Eclipse Platform
Version: Oxygen.1a (4.7.1a)
Build id: M20171009-0410
OS: Linux, v.4.13.0-19-generic, x86_64 / gtk 2.24.31</pre>
"
"How to implement the new PrismApplication to replace the Bootstrapper class","<p>Since the <code>Bootstrapper</code> Class is obsolete with Prism 7 I would like to change my C# WPF App using the <code>PrismApplication</code> Class.</p>

<p>Does anybody know how to refactor a Prism 6 App using the <code>Bootstrapper : UnityBootstrapper</code> to the new <code>PrismApplication</code>?</p>

<p>I¬¥m asking because the documentation regarding those pre-releases is pretty limited and I am not the best in understanding what I need to do from just looking at the Prism source code. </p>
","<p>It depends on what your bootstrapper does, but <code>Prism.Unity.PrismApplication</code> has similar methods to override, so you should be able to copy the code over from the bootstrapper. Probably you only need <code>RegisterTypes</code> and <code>CreateShell</code>. Remember to update <code>App.xaml</code> to change the type of your application...</p>

<p><code>App.xaml</code> should be something like this:</p>

<pre><code>&lt;prism:PrismApplication x:Class=""WpfApp1.App""
                        x:ClassModifier=""internal"" 
                        xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
                        xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""
                        xmlns:prism=""http://prismlibrary.com/""/&gt;
</code></pre>

<p>and for completeness' sake, <code>App.xaml.cs</code>:</p>

<pre><code>internal partial class App
{
    protected override void RegisterTypes(IContainerRegistry containerRegistry)
    {
        throw new NotImplementedException();
    }

    protected override Window CreateShell()
    {
        throw new NotImplementedException();
    }
}
</code></pre>
"
"Declare existing functions as async?","<p>I use a function called setConf for testing. Sometimes it's really convenient if I can use it to start a promise chain, sometimes I just need need it to return the value.</p>

<p>Is it possible to declare an existing function as async? What I would like to do but it doesn't work is:</p>

<pre><code>const setConf = (conf) =&gt; {
  mainConf = Object.assign(mainConf , conf)
  return mainConf 
}

module.exports.asyncSetConf = async setConf
module.exports.setConf = setConf
</code></pre>

<p>this I currently have </p>

<pre><code>exports.asyncSetConf = async (conf) =&gt; {
  mainConf = Object.assign(mainConf , conf)
  return mainConf 
}

exports.setConf = (conf) =&gt; {
  mainConf = Object.assign(mainConf , conf)
  return mainConf 
}
</code></pre>

<p>The code is identical, It seems kinda silly not to be able to refactor this</p>
","<p>First off, a function declared with the <code>async</code> keyword returns a promise.  So you either want your function to return a promise or you don't.  There is no such thing as a function that is declared with the <code>async</code> keyword that sometimes returns a promise and sometimes doesn't.</p>

<p>Second off, if you have no asynchronous code in your function, then it's generally making things more complicated, not less complicated to wrap synchronous operations in an asynchronous interface, so there's generally no reason to do that.</p>

<p>Third off, if you just want to sometimes use <code>setConf()</code> to start a promise chain, you can simply wrap it with <code>Promise.resolve()</code> when you want to do that:</p>

<pre><code>Promise.resolve(setConf(...)).then(f).then(g).catch(...)
</code></pre>

<p>Of course, you don't necessarily need to do that either because if <code>f()</code> is asynchronous and returns a promise,  you could just do this:</p>

<pre><code>f(setConfg(...)).then(g).catch(...)
</code></pre>

<p>If you find yourself using <code>Promise.resolve(setConf(...))</code> a lot, then you can just make a utility function for it:</p>

<pre><code>function setConfPromise(...args) {
    return Promise.resolve(setConf(..args))
}
</code></pre>

<blockquote>
  <p>Is it possible to declare an existing function as async?</p>
</blockquote>

<p>You can change its declaration or you can wrap it with another function.  You can't dynamically make it sometimes with <code>async</code> behavior and sometimes not.  You need two separate functions for that.</p>

<p>You could wrap it like this:</p>

<pre><code>module.exports.asyncSetConf = function(...args) {
    return Promise.resolve(setConf(...args));
}
module.exports.setConf = setConf
</code></pre>

<hr>

<p>FYI, <code>async</code> should only be used when actually needed.  Some notes about its usage:</p>

<ol>
<li>You should never use <code>async</code> when there no actual asynchronous code involved.  Putting an asynchronous interface on synchronous code just makes use of the function more complicated than required.</li>
<li>Use <code>async</code> when you want to use <code>await</code> inside the function.</li>
<li>Use <code>async</code> when you to force automatically returning a promise and have some exceptions automatically caught and turned into a rejected promise.  </li>
</ol>

<p>Personally, I'd only ever use <code>async</code> when I want to use <code>await</code> inside the function.</p>

<p>You do not need to use <code>async</code> just to return a promise.  You can do that the ""old-fashioned"" way by just returning a promise.</p>

<p>Using <code>async</code> does not make any synchronous code suddenly run asynchronously (a common newbie assumption).  It doesn't change synchronous code at all.  It forces the return value to be a promise which the caller has to use either <code>await</code> or <code>.then()</code> with to get the value from which will force a ""next tick"" execution on the <code>.then()</code>, but if the code in the function was all synchronous, it will still execute synchronously - <code>async</code> doesn't change that.</p>
"
"Is there a more elegant way to get random not used item from list using java 8?","<p>Function to be refactored...</p>

<pre><code>&lt;T&gt; T notUsedRandomItem(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {
    return allItems.stream()
            .filter(item -&gt; !usedItems.contains(item))
            .sorted((o1, o2) -&gt; new Random().nextInt(2) - 1)
            .findFirst()
            .orElseThrow(() -&gt; new RuntimeException(""Did not find item!""));
}
</code></pre>

<p>Function might be used like this...</p>

<pre><code>System.out.println(
            notUsedRandomItem(
                    Arrays.asList(1, 2, 3, 4), 
                    Arrays.asList(1, 2)
            )
    ); // Should print either 3 or 4
</code></pre>

<p>Edit: Collected suggested implementations and tested efficiency by running them against Person lists.</p>

<p>edit2: Added missing equals method to Person class.</p>

<pre><code>import java.util.*;
import java.util.concurrent.TimeUnit;
import java.util.function.BiFunction;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

import static java.util.stream.Collectors.toList;

class Functions {

    &lt;T&gt; T notUsedRandomItemOriginal(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {
        return allItems.stream()
                .filter(item -&gt; !usedItems.contains(item))
                .sorted((o1, o2) -&gt; new Random().nextInt(2) - 1)
                .findFirst()
                .orElseThrow(() -&gt; new RuntimeException(""Did not find item!""));
    }

    &lt;T&gt; T notUsedRandomItemByAomin√®(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {
        List&lt;T&gt; distinctItems = allItems.stream()
                .filter(item -&gt; !usedItems.contains(item))
                .collect(toList());

        if (distinctItems.size() == 0) throw new RuntimeException(""Did not find item!"");

        return distinctItems.get(new Random().nextInt(distinctItems.size()));
    }

    &lt;T&gt; T notUsedRandomItemByEugene(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {

        // this is only needed because your input List might not support removeAll
        List&lt;T&gt; left = new ArrayList&lt;&gt;(allItems);
        List&lt;T&gt; right = new ArrayList&lt;&gt;(usedItems);

        left.removeAll(right);

        return left.get(new Random().nextInt(left.size()));
    }

    &lt;T&gt; T notUsedRandomItemBySchaffner(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {

        Set&lt;T&gt; used = new HashSet&lt;&gt;(usedItems);
        List&lt;T&gt; all = new ArrayList&lt;&gt;(allItems);

        Collections.shuffle(all);

        for (T item : all) if (!used.contains(item)) return item;

        throw new RuntimeException(""Did not find item!"");
    }
}

public class ComparingSpeedOfNotUsedRandomItemFunctions {

    public static void main(String[] plaa) {
        runFunctionsWith(100);
        runFunctionsWith(1000);
        runFunctionsWith(10000);
        runFunctionsWith(100000);
        runFunctionsWith(200000);
    }

    static void runFunctionsWith(int itemCount) {

        TestConfiguration testConfiguration = new TestConfiguration();
        Functions functions = new Functions();

        System.out.println(""Function execution time with "" + itemCount + "" items..."");

        System.out.println(""Schaffner: "" +
                testConfiguration.timeSpentForFindingNotUsedPeople(
                        itemCount, (allPeople, usedPeople) -&gt;
                                functions.notUsedRandomItemBySchaffner(allPeople, usedPeople)
                ));

        System.out.println(""Eugene: "" +
                testConfiguration.timeSpentForFindingNotUsedPeople(
                        itemCount, (allPeople, usedPeople) -&gt;
                                functions.notUsedRandomItemByEugene(allPeople, usedPeople)
                ));

        System.out.println(""Aomin√®: "" +
                testConfiguration.timeSpentForFindingNotUsedPeople(
                        itemCount, (allPeople, usedPeople) -&gt;
                                functions.notUsedRandomItemByAomin√®(allPeople, usedPeople)
                ));

        System.out.println(""Original: "" +
                testConfiguration.timeSpentForFindingNotUsedPeople(
                        itemCount, (allPeople, usedPeople) -&gt;
                                functions.notUsedRandomItemOriginal(allPeople, usedPeople)
                ));
    }

}

class TestConfiguration {

    Long timeSpentForFindingNotUsedPeople(int numberOfPeople, BiFunction&lt;List&lt;Person&gt;, List&lt;Person&gt;, Person&gt; function) {

        ArrayList&lt;Person&gt; people = new ArrayList&lt;&gt;();
        IntStream.range(1, numberOfPeople).forEach(i -&gt; people.add(new Person()));
        Collections.shuffle(people);

        List&lt;Person&gt; halfOfPeople =
                people.stream()
                        .limit(numberOfPeople / 2)
                        .collect(Collectors.toList());

        Collections.shuffle(halfOfPeople);

        long before = System.nanoTime();
        Person foundItem = function.apply(people, halfOfPeople);
        long after = System.nanoTime();

        // Return -1 if function do not return valid answer
        if (halfOfPeople.contains(foundItem))
            return (long) -1;

        return TimeUnit.MILLISECONDS.convert(after - before, TimeUnit.NANOSECONDS);
    }

    class Person {
        public final String name = UUID.randomUUID().toString();

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;

            Person person = (Person) o;

            return name != null ? name.equals(person.name) : person.name == null;
        }

        @Override
        public int hashCode() {
            return name != null ? name.hashCode() : 0;
        }
    }
}
</code></pre>

<p>Results:</p>

<pre><code>Function execution time with 100 items...
Schaffner: 0
Eugene: 1
Aomin√®: 2
Original: 5
Function execution time with 1000 items...
Schaffner: 0
Eugene: 14
Aomin√®: 13
Original: 5
Function execution time with 10000 items...
Schaffner: 2
Eugene: 564
Aomin√®: 325
Original: 348
Function execution time with 20000 items...
Schaffner: 3
Eugene: 1461
Aomin√®: 1418
Original: 1433
Function execution time with 30000 items...
Schaffner: 3
Eugene: 4616
Aomin√®: 2832
Original: 4567
Function execution time with 40000 items...
Schaffner: 4
Eugene: 10889
Aomin√®: 4903
Original: 10394
</code></pre>

<p><strong>Conclusion</strong></p>

<p>When list size reach 10000 items then so far only Schaffner's implementation is usable.</p>

<p>And because it's fairly simple to read I will pick it as the most elegant solution.</p>
","<p>You should use <code>HashSet</code>s to improve performance:</p>

<pre><code>&lt;T&gt; T notUsedRandomItem(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {

    Set&lt;T&gt; used = new HashSet&lt;&gt;(usedItems);
    Set&lt;T&gt; all = new HashSet&lt;&gt;(allItems);

    all.removeIf(used::contains); // or all.removeAll(used)

    if (all.isEmpty()) throw new RuntimeException(""Did not find item!"");

    int skip = new Random().nextInt(all.size());
    Iterator&lt;T&gt; it = all.iterator();
    for (int i = 0; i &lt; skip; i++) it.next();

    return it.next();
}
</code></pre>

<p>This removes elements from the <code>all</code> set if they belong to the <code>used</code> set. As <code>Set.removeIf</code> and <code>Set.contains</code> are being used, the removal of elements is optimal w.r.t performance. Then, a random number of elements is skipped in the resulting set, and finally, the next element of the set is returned.</p>

<hr>

<p>Another approach is to shuffle the <code>all</code> list first and then simply iterate and return the first element that doesn't belong to the <code>used</code> set:</p>

<pre><code>&lt;T&gt; T notUsedRandomItem(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {

    Set&lt;T&gt; used = new HashSet&lt;&gt;(usedItems);
    List&lt;T&gt; all = new ArrayList&lt;&gt;(allItems);

    Collections.shuffle(all);

    for (T item : all) if (!used.contains(item)) return item;

    throw new RuntimeException(""Did not find item!"");
}
</code></pre>

<hr>

<p>EDIT: Checking the last snippet of code, I now realize that there's no need to shuffle the whole list. Instead, you could randomize the indices of the <code>allItems</code> list and return the first element that doesn't belong to the <code>used</code> set:</p>

<pre><code>&lt;T&gt; T notUsedRandomItem(List&lt;T&gt; allItems, List&lt;T&gt; usedItems) {

    Set&lt;T&gt; used = new HashSet&lt;&gt;(usedItems);

    return new Random().ints(allItems.size(), 0, allItems.size())
        .mapToObj(allItems::get)
        .filter(item -&gt; !used.contains(item))
        .findAny()
        .orElseThrow(() -&gt; new RuntimeException(""Did not find item!""));
}
</code></pre>
"
"SQLAlchemy: querying all objects with no direct relationship","<p>I am new to ORM, so any comment are appreciated. Using the following code, I am trying to get all <strong>Contacts</strong> that are related to certain <strong>Classification</strong>. </p>

<pre><code>Base = declarative_base()

contact_category_association_table = Table('contact_category_association', Base.metadata,
    Column('contact_id', Integer, ForeignKey('contacts.id')),
    Column('category_id', Integer, ForeignKey('contact_categories.id'))
)

class Contact(Base):
    __tablename__ = 'contacts'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    categories = relationship('ContactCategory', secondary=contact_category_association_table)


class ContactCategory(Base):
    __tablename__ = 'contact_categories'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    contacts = relationship('Contact', secondary=contact_category_association_table)
    classification_id = Column(Integer, ForeignKey('contact_classification.id'))
    classification = relationship('ContactClassification', back_populates='categories')


class ContactClassification(Base):
    __tablename__ = 'contact_classification'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    categories = relationship('ContactCategory', back_populates='classification')
</code></pre>

<p>Using the following SQL I managed to get a result close to my need. However, I could not translate that using sqlalchemy ORM. </p>

<pre><code>select * from contacts c
join contact_categories cc,  contact_category_association cca, contact_classification ccl
where c.id = cca.contact_id and cc.id = cca.category_id and ccl.id = cc.classification_id;
</code></pre>

<p>The result I am seeking is a dict object. The key will be the id or name of the classification. The value will be a list of contacts.</p>

<h2><strong>Update:</strong></h2>

<p>To elaborate more. Each contact is categorized by their profession (ContactCategory). The relation between contact and category is many-to-many. Categories are being classified (or group) into classes. Each category can belong to 1 class (one-to-many). The following are an example data:</p>

<pre><code>Contacts
1|Alpha
2|Bear
3|Cel
4|Deer
5|Elk

ContactCategory
1|Builder|2
2|Carpenter|2
3|Metal Works|2
4|Networking &amp; Cabling|1
5|Gypsum|2

ContactClassification
1|Electronics
2|Building &amp; Decor
3|Plumping &amp; Piping

contact_category_association
1|1
1|2
2|2
3|4
4|2
4|5
5|5
</code></pre>

<p>Using ORM, I want to get the following result it possible (as python dict object):</p>

<pre><code>result = {
'Electronics': [&lt;Cel&gt;],
'Building &amp; Decor': [&lt;Alpha&gt;, &lt;Bear&gt;, &lt;Deer&gt;, &lt;Elk&gt;],
'Plumping &amp; Piping': []
}
</code></pre>

<p>Where the key is the class name and the value is a list of contacts that belong to each class (through the category). </p>

<p>I am sorry if the table names are confusing. I am in refactoring process of a side-project and got no time to rename the tables yet. </p>

<p>You help is appreciated. </p>
","<p>Not exactly what you had in mind since empty results will not be included, but in general you could query <code>contact_classification.name, contacts.*</code> tuples and group in Python:</p>

<pre><code>from collections import defaultdict

query = session.query(ContactClassification.name, Contact).\
    join('categories', 'contacts')

result = defaultdict(list)

for klass, contact in query:
    result[klass].append(contact)
</code></pre>
"
"How to remove a connected action?","<p>Learning iOS development and followed the tutorial on Apple's web site. After I have connected a button to the view controller code (by ctl-drag), I decided to rename the action. Instead of refactoring, I removed the section of code and reconnect (by ctl-drag). Now the app crashed everytime I tried to run it because it is still looking for the old action.</p>

<p>How do I resolve this situation instead of creating a new project?</p>

<p>I am using Xcode 9.</p>
","<p>You can remove action in this manner here you will find two action like this already connected to old one so just remove that and it will disappear and connect to new one<a href=""https://i.stack.imgur.com/sfkOg.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/sfkOg.png"" alt=""enter image description here""></a></p>
"
"Start intensive POST in background service getting crashes","<p>So there is a background <strong>Service</strong> which creates <strong>Runnable</strong> objects as soon as GPS <strong>Location</strong> is changed. <code>Runnable</code> contains <code>HTTPConnection</code> to make POST and twice send broadcast message via <code>sendBroadcast()</code>.</p>

<p><strong>So the problem I am facing if there is no chance to send data by this scheme something happened and app craches.</strong></p>

<p>Any clue to refactor code or may be change approach to <code>TaskAsync</code> and <strong>cancel pending</strong> <code>TaskAsync</code> when new <code>TaskAsync</code> is ready?</p>

<p>Any clue?</p>

<pre><code>import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.location.Location;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.Handler;
import android.os.HandlerThread;
import android.os.IBinder;
import android.text.format.DateFormat;
import android.util.Log;

import com.google.gson.Gson;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Date;


public class gps_service2 extends Service {
    private static final String TAG = ""GPS SERVICE"";
    private LocationManager mLocationManager = null;
    private static final int LOCATION_INTERVAL = 10000;
    private static final float LOCATION_DISTANCE = 10f;
    Context context;

    private class LocationListener implements android.location.LocationListener
    {
        Location mLastLocation;

        public LocationListener(String provider)
        {
            Log.e(TAG, ""LocationListener "" + provider);
            mLastLocation = new Location(provider);
        }

        @Override
        public void onLocationChanged(Location location)
        {
            Log.e(TAG, ""onLocationChanged: "" + location);

            try
            {
                ComplexPreferences complexPreferences = ComplexPreferences.getComplexPreferences(context, ""App_Settings"", 0);
                AppSettings appSettings = complexPreferences.getObject(""App_Settings"", AppSettings.class);
                if (appSettings != null) {

                    LocationItem locationItem = new LocationItem();
                    locationItem.DeviceID = appSettings.getDeviceID();
                    locationItem.Latitude =  Double.toString(location.getLatitude());
                    locationItem.Longitude = Double.toString(location.getLongitude());
                    Date d = new Date();
                    CharSequence timeOfRequest = DateFormat.format(""yyyy-MM-dd HH:mm:ss"", d.getTime()); // YYYY-MM-DD HH:mm:ss
                    locationItem.TimeOfRequest = timeOfRequest.toString();
                    locationItem.SerialNumber = appSettings.getSerialNumber();


                    Gson gson = new Gson();
                    String requestObject = gson.toJson(locationItem);
                    String url = appSettings.getIpAddress() + ""/api/staff/savedata"";
                    makeRequest(url, requestObject, dLocation);
                }
            }
            catch (Exception ex)
            {                
            } 
        }

        @Override
        public void onProviderDisabled(String provider)
        {
            Log.e(TAG, ""onProviderDisabled: "" + provider);
        }

        @Override
        public void onProviderEnabled(String provider)
        {
            Log.e(TAG, ""onProviderEnabled: "" + provider);
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras)
        {
            Log.e(TAG, ""onStatusChanged: "" + provider);
        }
    }

    LocationListener[] mLocationListeners = new LocationListener[] {
            new LocationListener(LocationManager.GPS_PROVIDER),
            new LocationListener(LocationManager.NETWORK_PROVIDER)
    };

    @Override
    public IBinder onBind(Intent arg0)
    {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId)
    {
        Log.e(TAG, ""onStartCommand"");
        super.onStartCommand(intent, flags, startId);
        return START_STICKY;
    }

    @Override
    public void onCreate()
    {
        context = this;
        Log.e(TAG, ""onCreate"");
        initializeLocationManager();
        try {
            mLocationManager.requestLocationUpdates(
                    LocationManager.NETWORK_PROVIDER, LOCATION_INTERVAL, LOCATION_DISTANCE,
                    mLocationListeners[1]);
        } catch (java.lang.SecurityException ex) {
            Log.i(TAG, ""fail to request location update, ignore"", ex);
        } catch (IllegalArgumentException ex) {
            Log.d(TAG, ""network provider does not exist, "" + ex.getMessage());
        }
        try {
            mLocationManager.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER, LOCATION_INTERVAL, LOCATION_DISTANCE,
                    mLocationListeners[0]);
        } catch (java.lang.SecurityException ex) {
            Log.i(TAG, ""fail to request location update, ignore"", ex);
        } catch (IllegalArgumentException ex) {
            Log.d(TAG, ""gps provider does not exist "" + ex.getMessage());
        }
    }

    @Override
    public void onDestroy()
    {
        Log.e(TAG, ""onDestroy"");
        super.onDestroy();
        if (mLocationManager != null) {
            for (int i = 0; i &lt; mLocationListeners.length; i++) {
                try {
                    mLocationManager.removeUpdates(mLocationListeners[i]);
                } catch (Exception ex) {
                    Log.i(TAG, ""fail to remove location listners, ignore"", ex);
                }
            }
        }
    }

    private void initializeLocationManager() {
        Log.e(TAG, ""initializeLocationManager"");
        if (mLocationManager == null) {
            mLocationManager = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);
        }
    }

    public static double round(double value, int places) {
        if (places &lt; 0) throw new IllegalArgumentException();
        BigDecimal bd = new BigDecimal(value);
        bd = bd.setScale(places, RoundingMode.HALF_UP);
        return bd.doubleValue();
    }

    public void makeRequest(String uri, String json, DLocation dLocation) {

        HandlerThread handlerThread = new HandlerThread(""URLConnection"");
        handlerThread.start();
        Handler mainHandler = new Handler(handlerThread.getLooper());
        Runnable myRunnable = createRunnable(uri, json, dLocation);
        mainHandler.post(myRunnable);
    }

    private Runnable createRunnable(final String uri, final String data,final DLocation dLocation){

        Runnable aRunnable = new Runnable(){
            public void run(){
                try {
                    //Connect
                    HttpURLConnection urlConnection;
                    urlConnection = (HttpURLConnection) ((new URL(uri).openConnection()));
                    urlConnection.setDoOutput(true);
                    urlConnection.setRequestProperty(""Content-Type"", ""application/json"");
                    urlConnection.setRequestProperty(""Accept"", ""application/json"");
                    urlConnection.setRequestMethod(""POST"");
                    urlConnection.connect();

                    //Write
                    OutputStream outputStream = urlConnection.getOutputStream();
                    BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(outputStream, ""UTF-8""));
                    try {
                        writer.write(data);
                    } catch (IOException e) {
                        e.printStackTrace();
                        Log.d(TAG,""–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –±—É—Ñ–µ—Ä –¥–ª—è –ø–µ—Ä–µ–∂–∞—á–∏ –ø–æ HTTP"");
                    }
                    writer.close();
                    outputStream.close();

                    //Read
                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream(), ""UTF-8""));

                    String line = null;
                    StringBuilder sb = new StringBuilder();

                    while ((line = bufferedReader.readLine()) != null) {
                        sb.append(line);
                    }

                    bufferedReader.close();
                    String result = sb.toString();

                    Log.d(TAG, result);

                    Intent iResult = new Intent(""location_update"");

                    DLocation dLocation = new DLocation();                    
                    iResult.putExtra(""result"", dLocation);
                    sendBroadcast(iResult);                   

                }catch( Exception err){
                    err.printStackTrace();
                    Log.d(TAG, ""HTTP "" + err.getMessage());
                }
            }
        };

        return aRunnable;
    }
}
</code></pre>
","<p>Runnable is just an interface, when you create a thread using Runnable interface basically it will run under the the thread where it created, in here runnable associate with UI thread, as per google documentation Network calls must be in a worker thread not in UI thread. </p>

<p><strong>Then Why it runs on emulator</strong><br>
android had DVM(dalvik virtual machine),it works like JVM but instead of .class file DVM uses .dex extension, so may the device had older or newer version of DVM.</p>

<p><strong>Fix</strong><br>
Use android's AsyncTask for network calls. android(DVM) had limited resources compare to JVM, when it comes to thread, so better use AsyncTask  </p>

<p><a href=""https://stackoverflow.com/a/22580454/3879214"">check this answer too</a> </p>

<p><strong>AsyncTask code for passing JSON to server, and get responds as callback</strong> </p>

<pre><code>public class WebService extends AsyncTask&lt;String,String,String&gt; {
private static final String TAG=""SyncToServerTAG"";




private String urlString;
private JSONObject jsonObject=null;
private int screenId=1;

public WebService(String url) {
    this.urlString=url;
}

public WebService(Context context, String url, JSONObject jsonObject) {
    this.urlString = url;
    this.jsonObject = jsonObject;
}

@Override
protected String doInBackground(String... strings) {
    try {
        URL url = new URL(urlString);
        HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
        urlConnection.setChunkedStreamingMode(0);
        urlConnection.setConnectTimeout(5000);
        urlConnection.setRequestProperty(""Content-Type"", ""application/json; charset=UTF-8"");
        urlConnection.setDoOutput(true);
        urlConnection.setDoInput(true);
        urlConnection.setRequestMethod(""POST"");
        if(jsonObject!=null) {
            OutputStream os = urlConnection.getOutputStream();
            os.write(jsonObject.toString().getBytes(""UTF-8""));
        }

        InputStream in = new BufferedInputStream(urlConnection.getInputStream());
        BufferedReader br = new BufferedReader(new InputStreamReader(
                (urlConnection.getInputStream())));

        String output="""";
        while (true) {
            String line=br.readLine();
                Log.d(TAG,line+"" "");
            if(line!=null)
                output+=line;
            else
                break;
        }

        in.close();
        urlConnection.disconnect();
        JSONObject j;
        if(output.equals(""""))
            publishProgress(""Server give null"");
        else {
            j=new JSONObject(output);
            return output;
        }
        return output;
    } catch (MalformedURLException e) {
        e.printStackTrace();
        publishProgress(e.toString());
    } catch (IOException e) {
        e.printStackTrace();
        publishProgress(e.toString());
    } catch (JSONException e) {
        e.printStackTrace();
        publishProgress(e.toString());
    }
    return null;
}

@Override
protected void onProgressUpdate(String... values) {
    super.onProgressUpdate(values);
    fireError(values[0]);
}

@Override
protected void onPostExecute(String s) {
    super.onPostExecute(s);
    if(s!=null) {
        try {
            JSONObject jsonObject=new JSONObject(s);
            fireComplete(0, jsonObject);
        } catch (JSONException e) {
            e.printStackTrace();
            fireError(""Non acceptable responds from server [""+urlString+""]"");
        }
    }
}

public interface OnWebCompleteListener{
    void onComplete(JSONObject result, int dataSource);
    void onError(String error);
}
private OnWebCompleteListener onWebCompleteListener;
private void fireComplete(int sourse,JSONObject cache){
    if(onWebCompleteListener!=null)
        onWebCompleteListener.onComplete(cache,sourse);
}
private void fireError(String message){
    if(onWebCompleteListener!=null)
        onWebCompleteListener.onError(message);
}
public void start(OnWebCompleteListener onWebCompleteListener){
    if(onWebCompleteListener==null)
        throw new RuntimeException(""You must provide non-null value as start listener"");
    this.onWebCompleteListener=onWebCompleteListener;
    execute((String)null);
}

}
</code></pre>

<p><strong>Usage</strong><br></p>

<pre><code>    WebService webService=new WebService(context,""url"",jsonObject);
    webService.start(new WebService.OnWebCompleteListener() {
    @Override
    public void onComplete(JSONObject result, int dataSource) {

    }

    @Override
    public void onError(String error) {

    }
    });
</code></pre>
"
"Naming DTO and Entity classes","<p>I have two sets of classes in my spring application - DTOs and Entities.</p>

<p>After reading Clean Code by Uncle Bob, I have got hooked on to the naming things right more than ever before.</p>

<p>I sat down refactoring a one of my Spring projects and I am not sure if adding DTO suffix for DTO classes is the right thing to do. If not, then how do you differentiate between DTO and Entity classes. I do use Service and Repository suffixes for my service classes and repository interfaces.</p>

<p>Merely keeping them under different packages with same names is not helpful esp. when they are are to be used in same scope.</p>

<p>Note: Not sure if this is a precise question to be asked on Stackoverflow.</p>
","<p>If you read <a href=""http://www.corej2eepatterns.com/TransferObject.htm"" rel=""nofollow noreferrer"">Core J2EE Patterns, 2nd Edition</a>, it is called <strong>Transfer Object</strong> with all the sample codes having the <code>TO</code> suffix.  You can also have a look at Oracle's <a href=""http://www.oracle.com/technetwork/java/transferobject-139757.html"" rel=""nofollow noreferrer"">Core J2EE Patterns</a> site.</p>

<p>To sum up: You should use either <code>DTO</code> or <code>TO</code> as a suffix to any transfer object you use in your business tier. </p>
"
"AngularJS TypeAhead - take a different attribute for ng-model","<p><a href=""http://jsfiddle.net/H7LA4/275/"" rel=""nofollow noreferrer"">http://jsfiddle.net/H7LA4/275/</a></p>

<p>I want to display the id of the selected state instead of the state name above the input box. How can I refactor the code to show the id of the selected state? </p>

<pre><code>&lt;div ng-app=""myApp""&gt;
    &lt;div class='container-fluid' ng-controller=""TypeaheadCtrl""&gt; &lt;pre&gt;State: {{selected}}&lt;/pre&gt;

        &lt;input class=""input-large"" type=""text"" ng-model=""selected"" typeahead=""state.name for state in states | filter:$viewValue | limitTo:8""&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>JS</p>

<pre><code>angular.module('myApp', ['ui.bootstrap']);

function TypeaheadCtrl($scope) {

    $scope.selected = undefined;
    $scope.states = [{name: 'Alabama',id: 1}, {name: 'New York',id: 2}, {name: 'Calafornia',id: 3}];
}
</code></pre>
","<p>I would use</p>

<p><em>typeahead-on-select</em> </p>

<p>callback to have more control and do extra computations if needed</p>

<p>HTML</p>

<pre><code>&lt;div ng-app=""myApp""&gt;
    &lt;div class='container-fluid' ng-controller=""TypeaheadCtrl""&gt; 
      &lt;pre&gt;State: {{selectedId}}&lt;/pre&gt;

        &lt;input 
        class=""input-large"" 
        type=""text"" 
        ng-model=""selected"" 
        typeahead=""state.name for state in states | filter:$viewValue | limitTo:8""
        typeahead-on-select=""onSelect($item)""&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>JS</p>

<pre><code>angular.module('myApp', ['ui.bootstrap']);

function TypeaheadCtrl($scope) {

    $scope.selected = undefined;
    $scope.states = [{name: 'Alabama',id: 1}, {name: 'New York',id: 2}, {name: 'Calafornia',id: 3}];

    $scope.onSelect = function ($item, $model, $label, $even) {
        $scope.selectedId = $item.id
    }
}
</code></pre>
"
"Can you reuse options defined in other commands using commander.js?","<p>So I have several commands and they all use the same options.</p>

<p>For example..</p>

<pre><code>program.command('hello')
    .option('--foo &lt;name&gt;', 'this is the foo option and requires a name')
    .option('--bar', 'this is the bar option and takes no arguments')
    .action(options =&gt; {
        // do stuff here...
    });

program.command('world')
    .option('--foo &lt;name&gt;', 'this is the foo option and requires a name')
    .option('--bar', 'this is the bar option and takes no arguments')
    .action(options =&gt; {
        // do stuff here...
    });
</code></pre>

<p>I'd like to refactor this and define the options once. However, action taken for each command may differ. </p>

<p>Is there a way to declare options once and use them for any/all commands defined?</p>
","<p>The solution I came up with only works for commands that have the same exact options. To work with unique options, you would have to probably extend the solution I found, or maybe there is another way as well.</p>

<p>What I came up with:</p>

<pre><code>[
    {
        name: 'hello',
        method: 'hiMethod'
    },
    {
        name: 'world',
        method: 'woMethod',
    },
].forEach(cmd =&gt; {
    program.command(cmd.name)
        .option('--foo &lt;name&gt;', 'this is the foo option and requires a name')
        .option('--bar', 'this is the bar option and takes no arguments')
        .action(options =&gt; {
            // do stuff here...
            // I can use `cmd.method` for unique actions for each command
        });
});
</code></pre>

<p>This solution worked for me :)</p>
"
"Creating Sum/Total rows by user in sql query for csv/excel report","<p>The query below pulls in data to form a 'report' but it's basically just line items of numbers grouped by 
CSR agent. What it does is accurate and correct, and after the query I save the results as a CSV. However,
it's only giving me the individual records, so I have to put it into excel and use formulas to insert a
'Totals' row that basically sums up the columns I need to be totalled. </p>

<p>This sql query runs in a php script, but I'm not sure the best way to go about modifying any of this so that 
I can total those columns for each user. It would somehow have to say 'This is the end of records for user 7200
so insert row of totals for user 7200 and then move on to records for user 7206' or something to that effect.</p>

<p>The screenshot shows the report as it is, using ""x's"" and null spaces instead of 1 or 0, so in my excel formulas
I usuall have a count IF ""x"" variable. I'm hoping I can do something similar with this script. The query and 
screenshot are below.</p>

<p>Here is the fiddle: <a href=""http://sqlfiddle.com/#!9/b6a568/1"" rel=""nofollow noreferrer"">http://sqlfiddle.com/#!9/b6a568/1</a></p>

<p>The output of the fiddle is the output of the exact query, the only difference is the script puts it into csv.</p>

<p>I'm just hoping there's a way to create a 'Totals' row for each user that will add up the number of ""x's"" and 
the amount of seconds for duration and hold time.</p>

<p>Any suggestions to how I can refactor this are greatly appreciated.</p>

<pre><code>$result = mysqli_query($conn2,
    ""SELECT
          FirstN
          , LastN
        , Extension
        , Recieved
        , Recieved_Known
        , Outbound
        , Outbound_Known
        , Missed_No_VM
        , Missed_VM
        , Missed_Known
        , Calling_Number
        , Called_Number
        , Start_Time
        , End_Time
        , Talk_Time_Seconds
        , Hold_Time_Seconds

        FROM (
          SELECT distinct
           firstn
           , lastn
           , c.extension
           , CASE WHEN LEGTYPE1 = 2 AND ANSWERED = 1 THEN 'x' ELSE '' END AS Recieved
           , case when LEGTYPE1 = 2 and answered = 1 and CALLINGPARTYNO = k.phone_number then 'x' ELSE '' end as Recieved_Known
           , CASE WHEN LEGTYPE1 = 1 then 'x' ELSE '' end  AS Outbound
           , case when  FINALLYCALLEDPARTYNO = kn.long_number then 'x' ELSE '' end as Outbound_Known
           , case when legtype1 = 2 and answered = 0 and finallycalledpartyno  not like '%oice%' then 'x' ELSE '' end as Missed_No_VM
           , case when finallycalledpartyno like '%oice%' then 'x' ELSE '' end as Missed_VM
           , case when legtype1 = 2 and ANSWERED = 0 and CALLINGPARTYNO = k.phone_number then 'x' ELSE '' end as
            Missed_Known
           , a.CALLINGPARTYNO AS Calling_Number
           , a.FINALLYCALLEDPARTYNO AS Called_Number
           , b.starttime as Start_Time
           , b.endtime as End_Time
           , b.duration as Talk_Time_Seconds
           , a.holdtimesecs as Hold_Time_Seconds

          FROM ambition.session a
            INNER JOIN ambition.callsummary b ON a.NOTABLECALLID = b.NOTABLECALLID
            right join jackson_id.users c on a.callingpartyno = c.extension or a.finallycalledpartyno = c.extension
            LEFT JOIN ambition.known_numbers k ON a.callingpartyno = k.phone_number
        left join ambition.known_numbers kn on a.finallycalledpartyno = kn.long_number
                WHERE a.ts &gt;= '2017-12-07' -- curdate()
                and(a.CALLINGPARTYNO in (select extension from ambition.ambition_users) OR a.finallycalledpartyno IN (select extension from ambition.ambition_users))
          ) x
          order by extension;"") or die(mysqli_error( $conn2));
</code></pre>

<p>Screenshot for good measure:</p>

<p><a href=""https://i.stack.imgur.com/VwNNE.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/VwNNE.png"" alt=""enter image description here""></a></p>
","<p>I am not sure how do you uniquely identify the user. I am assuming that the extension is unique for each user. Based on that I come up with the following query:</p>

<pre><code>SELECT
          Extension
        , Recieved
        , Recieved_Known
        , Outbound
        , Outbound_Known
        , Missed_No_VM
        , Missed_VM
        , Missed_Known
        , Talk_Time_Seconds
        , Hold_Time_Seconds

      FROM (
          SELECT distinct
           c.extension
           , sum(CASE WHEN LEGTYPE1 = 2 AND ANSWERED = 1 THEN 1 ELSE 0 END) AS Recieved
           , sum(case when LEGTYPE1 = 2 and answered = 1 and CALLINGPARTYNO = k.phone_number then 1 ELSE 0 end) as Recieved_Known
           , sum(CASE WHEN LEGTYPE1 = 1 then 1 ELSE 0 end)  AS Outbound
           , sum(case when  FINALLYCALLEDPARTYNO = kn.long_number then 1 ELSE 0 end) as Outbound_Known
           , sum(case when legtype1 = 2 and answered = 0 and finallycalledpartyno  not like '%oice%' then 1 ELSE 0 end) as Missed_No_VM
           , sum(case when finallycalledpartyno like '%oice%' then 1 ELSE 0 end) as Missed_VM
           , sum(case when legtype1 = 2 and ANSWERED = 0 and CALLINGPARTYNO = k.phone_number then 1 ELSE 0 end) as
            Missed_Known
           , sum(b.duration) as Talk_Time_Seconds
           , sum(a.holdtimesecs) as Hold_Time_Seconds

          FROM session a
        INNER JOIN callsummary b ON a.NOTABLECALLID = b.NOTABLECALLID
        right join users c on a.callingpartyno = c.extension or a.finallycalledpartyno = c.extension
        LEFT JOIN known_numbers k ON a.callingpartyno = k.phone_number
        left join known_numbers kn on a.finallycalledpartyno = kn.long_number
          WHERE a.ts &gt;= '2017-12-07' -- curdate()
          and(a.CALLINGPARTYNO in (select extension from ambition_users) OR a.finallycalledpartyno IN (select extension from ambition_users))
        group by c.extension    
      ) x

          order by extension;
</code></pre>

<p>The above query, at least, will give you some idea on how to solve the problem. </p>
"
"Axios interceptor in vue 2 JS using vuex","<p>I store token after success login call in vuex store like this:</p>

<pre><code>axios.post('/api/auth/doLogin.php', params, axiosConfig)
    .then(res =&gt; {
        console.log(res.data); // token
        this.$store.commit('login', res.data);
    })
</code></pre>

<p>axiosConfig is file where I only set baseURL <code>export default { baseURL: 'http://localhost/obiezaca/v2' }</code> and params is just data sent to backend.</p>

<p>My vuex file looks is:</p>

<pre><code>import Vue from 'vue';
import Vuex from 'vuex';

Vue.use(Vuex);

export const store = new Vuex.Store({
    state: {
        logged: false,
        token: ''
    },
    mutations: {
        login: (state, response) =&gt; {
            state.logged = true;
            state.token = response;
            console.log('state updated');
            console.log('state.logged flag is: '+state.logged);
            console.log('state.token: '+state.token);
        },
        logout: (state) =&gt; {
            state.logged = false;
            state.token = '';
        }
    }
});
</code></pre>

<p>It is working correctly, I can re-render some of content in my SPA basing on <code>v-if=""this.$store.state.logged""</code> for logged user. I'm able to access <code>this.$store.state.logged</code> from any component in my entire app.</p>

<p>Now I want to add my token to every request which call my rest API backend. I've created basic axios http interceptor which looks like this:</p>

<pre><code>import axios from 'axios';

axios.interceptors.request.use(function(config) {
    const token = this.$store.state.token;
    if(token) {
        config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
}, function(err) {
    return Promise.reject(err);
});
</code></pre>

<p>Now I have 2 problems/questions about it.</p>

<ol>
<li>I know that it is available to use <code>this.$store.state.logged</code> or <code>this.$store.state.token</code> across every component but can I use it same way in single javascript file?</li>
<li>Where should I execute/start my interceptor javascript file? It is independent file which lays in my app main folder but I am not calling it anywhere, in angularJS which I was working before, I had to add <code>$httpProvider.interceptors.push('authInterceptorService');</code> in config but I don't know how to do same thing in vue architecture. So where should I inject my interceptor?</li>
</ol>

<p><strong>EDIT</strong></p>

<p>I followed <em>GMaiolo</em> tips I added </p>

<pre><code>import interceptor from './helpers/httpInterceptor.js';
interceptor();
</code></pre>

<p>to my main.js file and I refactor my interceptor to this:</p>

<pre><code>import axios from 'axios';
import store from '../store/store';

export default function execute() {
    axios.interceptors.request.use(function(config) {
        const token = this.$store.state.token;
        if(token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    }, function(err) {
        return Promise.reject(err);
    });
}
</code></pre>

<p>Result of this changes is that every already existing backend calls ( GET ) which don't need token to work stopped working but it is logical because I didn't clarified to which request it should add token so it is trying to add it everywhere and in my interceptor something is still wrong and that is why every already exisitng request stopped working.</p>

<p>When I try to do backend POST call in browser console I still get this error:</p>

<blockquote>
  <p>TypeError: Cannot read property '$store' of undefined</p>
</blockquote>

<p>Although I import store to my interceptor file. Any ideas? I can provide some more information if any needed.</p>

<p>I additionally add screenshot of this main, store and interceptor tree structure so you can see that I'm importing fron correct path:</p>

<p><a href=""https://i.stack.imgur.com/QuTEB.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/QuTEB.png"" alt=""path""></a></p>
","<h1><strong>1.</strong></h1>

<p>First of all I'd use a <a href=""https://vuex.vuejs.org/en/modules.html"" rel=""nofollow noreferrer"">Vuex Module</a> as this Login/Session behavior seems to be ideal for a <code>Session</code> module. After that (which is totally optional) you can set up a <a href=""https://vuex.vuejs.org/en/getters.html"" rel=""nofollow noreferrer"">Getter</a> to avoid accessing the <code>state</code> itself from outside Vuex, you'd would end up with something like this:</p>

<pre><code>state: {
  // bear in mind i'm not using a module here for the sake of simplicity
  session: {
    logged: false,
    token: ''
  } 
},
getters: {
  // could use only this getter and use it for both token and logged
  session: state =&gt; state.session,
  // or could have both getters separated
  logged: state =&gt; state.session.logged,
  token: state =&gt; state.session.token
},
mutations: {
  ...
}
</code></pre>

<p>With those getters set, you can get the values a bit easier from components. With either using <code>this.$store.getters.logged</code> (or the one you'd want to use) or using the <code>mapGetters</code> helper from Vuex [for more info about this you can check the <em>getters</em> docs]:</p>

<pre><code>import { mapGetters } from 'vuex'
export default {
  // ...
  computed: {
    ...mapGetters([
      'logged',
      'token'
    ])
  }
}
</code></pre>

<h1><strong>2.</strong></h1>

<p>I like to run Axios' interceptors along with Vue instantation in <code>main.js</code> creating, importing and executing an <code>interceptors.js</code> helper. I'd leave an example so you get an idea, but, then again, this is my own preference:</p>

<p><strong><em>main.js</em></strong></p>

<pre><code>import Vue from 'vue';
import store from 'Src/store';
import router from 'Src/router';
import App from 'Src/App';

// importing the helper
import interceptorsSetup from 'Src/helpers/interceptors'

// and running it somewhere here
interceptorsSetup()

/* eslint-disable no-new */
new Vue({
    el: '#app',
    router,
    store,
    template: '&lt;App/&gt;',
    components: { App }
});
</code></pre>

<p><strong><em>interceptors.js</em></strong></p>

<pre><code>import axios from 'axios';
import store from 'your/store/path/store'

export default function setup() {
    axios.interceptors.request.use(function(config) {
        const token = store.state.token;
        if(token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    }, function(err) {
        return Promise.reject(err);
    });
}
</code></pre>

<p>And there you'd end up having all the behavior cleanly encapsulated.</p>
"
"Does Google Cloud ML Engine trainer have to be explicitly aware of Google Cloud Storage URIs?","<p>I am trying to use an existing TensorFlow model, which I have so far run locally, with Google Cloud ML Engine. </p>

<p>The model currently obtains its training data by passing filesnames such as <code>my_model.train</code> and <code>my_model.eval</code> into <a href=""https://www.tensorflow.org/api_docs/python/tf/data/TextLineDataset"" rel=""nofollow noreferrer""><code>tf.data.TextLineDataset</code></a>.  These filenames are now hardcoded in the model's trainer, but I plan to refactor it such that it obtains them as <a href=""https://cloud.google.com/ml-engine/docs/training-overview#params"" rel=""nofollow noreferrer"">training application parameters</a> (along with <code>--job-dir</code>) on the command line instead; e.g. like so:</p>

<pre><code>my_trainer.pl --job-dir job \
  --filename-train my_model.train --filename-eval my_model.eval
</code></pre>

<p>This should then also allow me to run the trainer with Clould ML Engine locally:</p>

<pre><code>gcloud ml-engine local train \
  --job-dir job
  ...
  -- \
  --filename-train my_model.train \
  --filename-eval my_model.eval
</code></pre>

<p>Am I making correct assumptions so far and could I also run the same trainer in Google's cloud (after uploading my dataset files into <code>my_bucket</code>) by replacing local filenames with Google Cloud Storage <code>gs:</code> URIs e.g. like so :</p>

<pre><code>gcloud ml-engine local train \
  --job-dir job
  ...
  -- \
  --filename-train gs://my_bucket/my_model.train \
  --filename-eval gs://my_bucket/my_model.eval
</code></pre>

<p>I other worlds, can <code>tf.data.TextLineDataset</code> handle <code>gs:</code> URIs as ""filenames"" transparently, or do I have to include special code in my trainer for processing such URIs beforehand?</p>
","<p>Yes, tf.read_file and tf.TextLineReader and tf.data.TextLineDataset all handle GCS implicitly.  Just make sure you pass in GCS URLs of the gs://my_bucket/path/to/data.csv as the ""filename""</p>

<p>One thing to be careful about:  always use os.path.join() to combine ""directory"" names and ""file"" names.  While most Linux distributions handle paths like /some/path//somefile.txt by ignoring the repeated slash, GCS (being a key-value store) considers it different from /some/path/somefile.txt.  So, use os.path.join to make sure you are not repeating directory separators.</p>
"
"Coding standard with multiple if condition","<p>I need to set data in entity based on on some condition.</p>

<p>I have used below to set data</p>

<pre><code>if (StringUtils.isNotBlank(customerVO.getGender())) {
    mstCustomer.setGender(customerVO.getGender());
}
if (StringUtils.isNotBlank(customerVO.getBirthDate())) {
    mstCustomer.setDob(DateUtils.getUtilDate(customerVO.getBirthDate()));
}

if (StringUtils.isNotBlank(customerVO.getAdd1())) {
    mstCustomer.setAddress1(customerVO.getAdd1());
}
if (StringUtils.isNotBlank(customerVO.getAdd2())) {
    mstCustomer.setAddress2(customerVO.getAdd2());
}
if (StringUtils.isNotBlank(customerVO.getAdd3())) {
    mstCustomer.setAddress3(customerVO.getAdd3());
}
if (StringUtils.isNotBlank(customerVO.getPincode())) {
    mstCustomer.setPinCode(customerVO.getPincode());
}
if (StringUtils.isNotBlank(customerVO.getStateName())) {
    MstState state = mstStateRepository.findByName(customerVO.getStateName());
    mstCustomer.setMstState(state);
}

if (StringUtils.isNotBlank(customerVO.getCity())) {
    MstCity city = mstCityRepository.findByName(customerVO.getCity());
    mstCustomer.setMstCity(city);
}

if (StringUtils.isNotBlank(customerVO.getIdentificationType())) {
    mstCustomer.setIdentificationType(customerVO.getIdentificationType());
}

if (StringUtils.isNotBlank(customerVO.getIdentificationData())) {
    mstCustomer.setIdentificationData(customerVO.getIdentificationData());
}

MstStatus mstStatus = mstStatusRepository.findOne(MstStatusEnum.CUST_ACTIVE.getStatusCode());
if (mstStatus != null) {
    mstCustomer.setMstStatus(mstStatus);
}

if (!StringUtils.isBlank(customerVO.getMaritalStatus())) {
    mstCustomer.setMaritalStatus(customerVO.getMaritalStatus());
}
if (StringUtils.isBlank(customerVO.getWeddingAnniversary())) {
    mstCustomer.setWeddingAnniversary(DateUtils.getDateFromString(customerVO.getWeddingAnniversary()));
}

if (StringUtils.isNotBlank(customerVO.getMotherTongue())) {
    mstCustomer.setMotherTongue(customerVO.getMotherTongue());
}
if (StringUtils.isNotBlank(customerVO.getFamilySize())) {
    mstCustomer.setFamilySize(Integer.valueOf(customerVO.getFamilySize()));
}
if (StringUtils.isNotBlank(customerVO.getAdultsSize())) {
    mstCustomer.setAdultsSize(Integer.valueOf(customerVO.getAdultsSize()));
}
if (StringUtils.isNotBlank(customerVO.getNoOfKids())) {
    mstCustomer.setNoOfKids(Integer.valueOf(customerVO.getNoOfKids()));
}
if (StringUtils.isNotBlank(customerVO.getChilddob1())) {
    mstCustomer.setChilddob1(DateUtils.getDateFromString(customerVO.getChilddob1()));
}
if (StringUtils.isNotBlank(customerVO.getChilddob2())) {
    mstCustomer.setChilddob2(DateUtils.getDateFromString(customerVO.getChilddob2()));
}
if (StringUtils.isNotBlank(customerVO.getProfession())) {
    mstCustomer.setProfession(customerVO.getProfession());
}
</code></pre>

<p>But sonar throwing this exception : <code>Refactor this method to reduce its Cognitive Complexity from 27 to the 15 allowed.</code></p>

<p>Please suggest what is the best way to refactor above code.</p>
","<p>Seems pretty doable using lambdas:</p>

<pre><code>private void setIfNotBlank(String value, Consumer&lt;String&gt; setter)  {
    setConditionally(value, setter, StringUtils::isNotBlank);
}

// if you don't need non-string arguments you can inline this method
private &lt;T&gt; void setConditionally(T value, Consumer&lt;T&gt; setter, Predicate&lt;T&gt; shouldSet) {
    if (shouldSet.test(value)) setter.accept(value);
}
</code></pre>

<p>Then, </p>

<pre><code>if (StringUtils.isNotBlank(customerVO.getBirthDate())) {
    mstCustomer.setDob(DateUtils.getUtilDate(customerVO.getBirthDate()));
}

if (StringUtils.isNotBlank(customerVO.getCity())) { 
    MstCity city = mstCityRepository.findByName(customerVO.getCity()); 
    mstCustomer.setMstCity(city); 
}
</code></pre>

<p>would become</p>

<pre><code>setIfNotBlank(customerVO.getBirthDate(), birthDate -&gt; mstCustomer.setDob(DateUtils.getUtilDate(birthDate)));
setIfNotBlank(customerVO.getCity(), cityName -&gt; { 
    MstCity city = mstCityRepository.findByName(cityName); 
    mstCustomer.setMstCity(city); 
});
</code></pre>
"
"Module aliases in bazel","<p>Bazel uses location based referencing scheme. However, if you want to move your modules around, this creates a problem with refactorings. Is it possible to emulate a logical naming scheme, similar to one in maven i.e. package.module.submodule?</p>
","<p>There isn't a mechanism exactly like this in bazel, but I have two suggestions:</p>

<ol>
<li><p>Move the package, and rename every reference to the old package to the new package. You can use <code>bazel query</code> to find the dependencies on a package. If you have only a few references to the old package, that's pretty easy, but if you have many references then that's harder. You can use a tool like <a href=""https://github.com/bazelbuild/buildtools/tree/master/buildozer"" rel=""nofollow noreferrer"">buildozer</a> to do the renaming automatically.</p></li>
<li><p>Move the package, and create a BUILD file where the old package was with <a href=""https://docs.bazel.build/versions/master/be/general.html#alias"" rel=""nofollow noreferrer""><code>alias()</code> rules</a> to each target in the new package. This might be annoying to maintain though.</p></li>
</ol>
"
"clean architecture - what is the correct way to do data model mapping?","<p>I have read this impressive <a href=""https://overflow.buffer.com/2017/12/21/even-map-though-data-model-mapping-android-apps/"" rel=""nofollow noreferrer"">article</a> on data modeling in android with clean architecture and MVP. </p>

<p>Now i would like to refactor some existing models that i have in my domain so that they for one do not contain parcelable code (android code) and are streamlined to work in the specific view.  You know sometimes we have to alter the model so that it works in a view like for example to get the selected position in a RecyclerView we would add a field called ""selectedPosition"" to the model.  There are many times we need to change the model and then we end up with models that are not pure and a little hard to maintain.  </p>

<p>Specifically i have 3 model data for 3 payment systems i am using. All the fields in the 3 models come back different. they have different names for the fields.  Can someone show me an example of the architecture used to make all 3 models use a common model ?</p>
","<p><strong>Data model</strong></p>

<p>I am sure that your 3 models for 3 payment systems have common features. So you can take this features and put it to interface. Each of your models must implement this interface. In your case it should display a data model. </p>

<p>For example: </p>

<pre><code>class Info {
    int id;
    String cardNumber;
    .......
}

interface ITransactionable { //or abstract class with the common func and prop
    void addUserWithCard(String cardNumber, String name);
    boolean makeTransaction(\*some params*\);
    Info getPaymentUserInfo();
}

class Model1/2/3 implements ITransactionable {
    \*In each case methods doing different job but give you same result, 
      you can take info for your models from servers, clouds, db...*\
}
</code></pre>

<p><strong>Domain model</strong></p>

<p>Domain model represent your business logic, manipulating of your data model.</p>

<pre><code>class DonationService {
    ITransactionable paymentService;
    DonationService(ITransactionable paymentService) {
        this.paymentService = paymentService
    }
    Info makeDonation(int money) {
        paymentService.addUserWithCard(""4546546545454546"", ""Vasya"");
        paymentService.makeTransaction(money);
        return paymentService.getPaymentUserInfo();
    }
    ........
}
</code></pre>

<p>Each layer must give to next something like API.</p>

<p><strong>Presentation</strong></p>

<p>For example can fill recyclerView with data of each transaction. And take events from view like get detail info about transaction or make new transaction.</p>

<p>You can check this for watching how it can be realized: <a href=""https://github.com/android10/Android-CleanArchitecture"" rel=""nofollow noreferrer"">https://github.com/android10/Android-CleanArchitecture</a></p>
"
"Can I get a reference to the current `ICakeContext` in my Cake build script?","<p>I'm refactoring a Cake build script, and decided to introduce a class to hold some build settings that get passed around a lot and/or that exist in the global scope.</p>

<p>Some of the settings come from arguments, and are set using the <code>Argument&lt;T&gt;(string name, string defaultValue)</code> syntax. </p>

<p>I'd like to create something like this:</p>

<pre><code>var context = BuildContext.FromArguments();
</code></pre>

<p>For that I need acquire an instance of the current ICakeContext. The reason for that I believe is that all methods defined in cake scripts become methods of a custom-built <code>ICakeContext</code> that probably inherits from <code>CakeContext</code> and thus can call all of its (extension) methods, but once you define a class, it becomes a nested class that no longer has access to nice helpers like <code>Argument&lt;T&gt;(name, defaultValue)</code>.</p>

<p>I was hoping I could either do <code>ICakeContext.Current</code> or simply pass <code>this</code> as in <code>BuildContext.FromArguments(this)</code> or something similar.</p>

<p>But the keyword <code>this</code> is not allowed at that level of a Cake script (not sure why, is the top level a static method?</p>

<p>So, the question is: how do I get a reference to the current <code>ICakeContext</code>?</p>
","<p>The reason that <code>this</code> does not work, is because of the way Roslyn implements scripting, and there is no concept of <code>this</code> in the script's outer scope.</p>

<p>You can access the context in a couple of different ways.</p>

<p><strong>From a <code>Task</code>:</strong></p>

<pre><code>Task(""MyTask"")
  .Does(ctx =&gt;
{
    BuildContext.FromArguments(ctx);
});
</code></pre>

<p><strong>From <code>Setup</code>/<code>Teardown</code>:</strong></p>

<pre><code>Setup(ctx =&gt;
{
    BuildContext.FromArguments(ctx);
});

Teardown(ctx =&gt;
{
    BuildContext.FromArguments(ctx);
});
</code></pre>

<p><strong>From <code>TaskSetup</code>/<code>TaskTeardown</code>:</strong></p>

<pre><code>TaskSetup(ctx =&gt;
{
    BuildContext.FromArguments(ctx);
});

TaskTeardown(ctx =&gt;
{
    BuildContext.FromArguments(ctx);
});
</code></pre>

<p><strong>From the outer script scope:</strong></p>

<pre><code>#load ""somefile.csx""

BuildContext.FromArguments(Context);
</code></pre>
"
"Initialise PointCloudT::Ptr class member","<p>I'm trying to refactor the <a href=""http://pointclouds.org/documentation/tutorials/interactive_icp.php"" rel=""nofollow noreferrer"">point cloud tutorial code</a> into OO form.</p>

<p>Here's my class structure</p>

<pre><code>class PclRegister {
private:
    // The point clouds we will be using
    PointCloudT::Ptr cloud_in;  // Original point cloud
    PointCloudT::Ptr cloud_tr;  // Transformed point cloud
    PointCloudT::Ptr cloud_icp; // ICP output point cloud
    pcl::console::TicToc time;
public:
    void registerFixedSurface(std::string path);
    Eigen::Matrix4d applyTransformation();
    void performIcp(Eigen::Matrix4d transform, int iterations);
    void print4x4Matrix(const Eigen::Matrix4d &amp; matrix);
};
</code></pre>

<p>and usage</p>

<pre><code>goicpz::PclRegister pclRegister;
pclRegister.registerFixedSurface(argv[1]);
Eigen::Matrix4d transform = pclRegister.applyTransformation();
pclRegister.performIcp(transform, iterations);
</code></pre>

<p>However I get the following runtime error</p>

<pre><code>Assertion failed: (px != 0), function operator*, file /project/build/Boost/install/include/boost/smart_ptr/shared_ptr.hpp, line 704.
</code></pre>

<p>I believe my private class members are not initialised correctly but I am not sure how to fix this. I tried adding a constructor and initialising them there (this is my Java background coming into play) but that does not seem to be legal C++.</p>

<p>I had a look <a href=""https://stackoverflow.com/questions/3127454/how-do-c-class-members-get-initialized-if-i-dont-do-it-explicitly"">here</a> and it says uninitialised references will not compile and objects are implicitly initialised. So I am a bit lost.</p>

<p>Can someone point me in the right direction?</p>

<p><strong>Edit</strong></p>

<p>I tried the constructor </p>

<pre><code>PclRegister() {
    cloud_in = new PointCloudT;
}
error: no viable overloaded '=' cloud_in = new PointCloudT;
</code></pre>
","<p>You have to initialize the your shared_ptr properly. If you can do that in your constructor, do it like that:</p>

<pre><code>PclRegister()
  : cloud_in(new PointCloudT),
    cloud_tr(new PointCloudT),
    cloud_icp(new PointCloudT)
{}
</code></pre>

<p>If you want to initialize or update the pointers at a later stage you could probably use something like this:</p>

<pre><code>cloud_in = PointCloudT::Ptr(new PointCloudT)
</code></pre>
"
"Vuex getter and array reduce","<p>I'm trying to code some getters to calculate a part total and a per item total. But when I refactored the code to use array.reduce, the partTotal returned undefined.</p>

<p>Can you help me to know why this works:</p>

<pre><code>getters: {

    calcPart: (state, getters) =&gt; part =&gt; {

        let total = 0.0

        for (let i = 0, length = part.items.length; i &lt; length; i++) {
            total += getters.calcItem(part.items[i])
        }

        return total

    },

    calcItem: state =&gt; item =&gt; {
        return parseFloat(item.value1) * parseFloat(item.value2)
    },

}
</code></pre>

<p>And why this does not work (calcPart returns ""undefined""):</p>

<pre><code>getters: {

    calcPart: (state, getters) =&gt; part =&gt; {
        return part.items.reduce((acc, item) =&gt; { acc + getters.calcItem(item) }, 0.0)
    },

    calcItem: state =&gt; item =&gt; {
        return parseFloat(item.value1) * parseFloat(item.value2)
    },

}
</code></pre>

<p>Has it something to do with the fact of reduce is an async function?</p>

<p>Thanks in advance!</p>
","<p>You need to return inside braces.</p>

<p>Change this line:</p>

<pre><code>return part.items.reduce((acc, item) =&gt; { acc + getters.calcItem(item) }, 0.0)
</code></pre>

<p>To this one:</p>

<pre><code>return part.items.reduce((acc, item) =&gt; { return acc + getters.calcItem(item) }, 0.0)
</code></pre>

<p>You can also avoid the undefined result by just removing the braces:</p>

<pre><code>return part.items.reduce((acc, item) =&gt; acc + getters.calcItem(item), 0.0)
</code></pre>

<p>Side note: Type semicolons.</p>
"
"PyCharm: is this kind of automatic signature refactoring possible?","<p>A Python code of a project has a lot of function definitions and calls like:</p>

<pre><code>def some_function(a, b="""", c=0, d=None, e=""something""):
    # whatever
    pass

some_function(""a"", ""b"", 1, e=""something else"")
</code></pre>

<p>This is very hairy (bad practice - missing context, etc) and I would like to automatically change it to:</p>

<pre><code>some_function(a=""a"", b=""b"", c=1, e=""something else"")
</code></pre>

<p><em>(well, the first positional argument can maybe stay as is in some cases)</em></p>

<p>In many cases, keyword parameters are in a different order, so those can also be arranged according to the function definition order:</p>

<pre><code>def some_method(self, a, b=1, c=2): pass
obj.some_method(a, c=12, b=0) -&gt; obj.some_method(a, b=0, c=12)
</code></pre>

<p>Can PyCharm with it's Refactor > Change signature be of any help?</p>

<p>Well, PyCharm does the kw arguments reordering, but does not change positional arguments to keyword arguments (in calls). Is it just current limitation or am I missing some way to do it automatically?</p>
","<p>Here one way:</p>

<ol>
<li><p>Put cursor to the function definition and Refactor > Change signature</p></li>
<li><p>Add some dummy argument (eg, <code>REMOVEME</code>) with default value right before the first argument, which should be kw argument, but after all positional arguments (without default values)</p></li>
<li><p>Refactor</p></li>
<li><p>Go to the signature refactoring again, remove dummy argument and refactor.</p></li>
</ol>

<p>Now all the calls are using positional arguments where due, properly reordered.</p>

<p>NB: Does not work 100%, in some cases leaves commas around, which is probably a bug. Plus sometimes strip <code>**kwargs</code> in calls...</p>
"
"How should I refactor code using Optional and ifPresent(...) to... not?","<p>I'm very new to Java. I'm faced with two classes, <code>FooRequest</code> and <code>BarRequest</code>. (Simplified for this question, of course.)</p>

<pre><code>public class FooRequest {

    private String a;
    private String b;
    private String c;
    private DateTime x;
    private DateTime y;
    private BigDecimal z;

    // ... and more members

    // ... getters and setters for each member
}
</code></pre>

<p>And the other class:</p>

<pre><code>public class BarRequest {

    private Optional&lt;DateTime&gt; x;
    private Optional&lt;DateTime&gt; y;
    private Optional&lt;BigDecimal&gt; z;

    // ... getters and setters for each member
}
</code></pre>

<p>These were written by different people, one preferring null checks upon use, the other preferring <code>Optional</code>. But because <code>FooRequest</code> has many more members, is in widespread use, and completely covers all of <code>BarRequest</code>'s members, I'm tasked with getting rid of <code>BarRequest</code>, using the more popular <code>FooRequest</code> instead.</p>

<p>Now, at first I thought I might just ""upgrade"" <code>FooRequest</code>'s members (at least the 3 used by <code>BarRequest</code>) to <code>Optional&lt;&gt;</code>. However, this caused numerous compilation issues (basically, everywhere <code>FooRequest</code> was returned or used). I learned <code>Optional&lt;T&gt;</code> cannot drop-in replace <code>T</code>.</p>

<p>My team-lead confirmed it was not practical to keep <code>Optional&lt;&gt;</code>. To minimize changes, we'd want to rewrite any code previously using <code>Optional&lt;&gt;</code>. For example,</p>

<pre><code>request.getDateBegin().ifPresent((dateBegin) -&gt; {
  if (!dateBegin.equals(ad.startDate())) {
    // ...
  }
}
</code></pre>

<p>Here's my attempt at converting this:</p>

<pre><code>if (request.getDateBegin() != null) {
  DateTime dateBegin = request.getDateBegin();
  if (!dateBegin.equals(ad.startDate())) {
    // ...
  }
}
</code></pre>

<p>Is this correct? Am I missing something by simply doing a <code>null</code> comparison? Is there any way to use a lambda expression inside and avoid creating a <code>DateTime</code> temporary?</p>
","<pre><code>if (request.getDateBegin() != null) {
  DateTime dateBegin = request.getDateBegin();
  if (!dateBegin.equals(ad.startDate())) {
    // ...
  }
}
</code></pre>

<p>can be replaced with </p>

<pre><code>Optional.ofNullable(request.getDateBegin())
            .filter(date -&gt; !date.equals(ad.startDate()))
            .ifPresent(date -&gt; {
                // ... whatever
            });
</code></pre>
"
"Updating AJAX success with dynamic data","<p>I am not very good with JavaScript, but am trying to better myself. I am refactoring a script that has 2 virtually identical AJAX calls. The only difference between the two is what's being done inside the success function.</p>

<p>If I wanted to use one AJAX function instead of 2, how would I go about 'injecting' one or the other blocks of code into what would be the single success function?</p>

<p>Here is what I have right now.</p>

<pre><code>$("".one"").click(function() {
  $.ajax({
    url      : ""upload.asp"",
    type     : ""POST"",
    data     : $(""#upload"").serialize(),
    dataType : 'json',
    cache    : false,
    success  : function(data) {
      // do some stuff here
    }
  });
});

$("".two"").click(function() {
  $.ajax({
    url      : ""upload.asp"",
    type     : ""POST"",
    data     : $(""#upload"").serialize(),
    dataType : 'json',
    cache    : false,
    success  : function(data) {
      // do some different stuff here
    }
  });
});
</code></pre>
","<p>Maybe something the following will help:</p>

<pre><code>methodOne = function(data) {
  // do some stuff
};
methodTwo = function(data) {
  // do some different stuff
};

$("".one, .two"").click(function() {
  var callback = function(){};
  if ($(this).hasClass('one')) {
    callback = methodOne;
  else if ($(this).hasClass('two')) {
    callback = methodTwo;
  }
  $.ajax({
    url      : ""upload.asp"",
    type     : ""POST"",
    data     : $(""#upload"").serialize(),
    dataType : 'json',
    cache    : false,
    success  : callback
  });
});
</code></pre>
"
"helm installation: Package emacs '24.4' unavailable","<p>While installing helm in emacs, I have come across the error</p>

<blockquote>
  <p>Package emacs '24.4' unavailable </p>
</blockquote>

<p>I am a noob to emacs and I have seen <a href=""https://stackoverflow.com/questions/16177807/js2-refactor-from-melpa-package-emacs-24-1-is-unavailable"">similar questions</a> on stack, but the solution offered there doesn't not solve the problem. </p>

<blockquote>
  <p>Type M-x locate-library RET package to find where Emacs is getting its package.el from. The path it shows should end with lisp/emacs-lisp/package.elc. If it doesn't, try getting rid of the indicated file (or changing the load path so Emacs doesn't find it).</p>
</blockquote>

<p>Can somebody help?</p>

<p>Below is my init.el file (configuration file)</p>

<pre><code>;; https://blog.aaronbieber.com/2015/05/24/from-vim-to-emacs-in-
fourteen-days.html 

(require 'package)

(add-to-list 'package-archives '(""org"" . ""http://orgmode.org/elpa/""))
(add-to-list 'package-archives '(""marmalade"" . ""http://marmalade-repo.org/packages/""))
(add-to-list 'package-archives '(""melpa"" . ""http://melpa.org/packages/""))
(add-to-list 'package-archives '(""melpa-stable"" .  ""http://stable.melpa.org/packages/""))

(setq package-enable-at-startup nil)
(package-initialize)
</code></pre>

<p>My emacs version is 24.3.1 fresh install. I have loaded the init file a few times. I am on ubuntu 14.04</p>
","<p>You're trying to install something which requires that you are running Emacs 24.4 or later.</p>

<p>Hence you getting the error </p>

<blockquote>
  <p>Package emacs '24.4' unavailable</p>
</blockquote>

<p>because</p>

<blockquote>
  <p>My emacs version is 24.3.1</p>
</blockquote>

<p>You'll need to upgrade to a newer version of Emacs if you want to install that package.</p>
"
"There is an HTML2Jade converter, is there a JADE2HTML converter","<p>I am looking at a code-base from Google which includes <code>JADE (PUG) templates</code>, and want to convert the <code>JADE code back</code> to <strong>plain old HTML</strong> as part of a larger refactor.<br>
I see a couple libs for <code>HTML-&gt;JADE</code> but none for <code>JADE-&gt;HTML</code>.  </p>

<p>Is there a <code>JADE-&gt;HTML</code> converter out there?</p>
","<p>That's what Jade (Pug) does:</p>

<p><a href=""http://jade-lang.com/command-line"" rel=""nofollow noreferrer"">http://jade-lang.com/command-line</a></p>

<pre><code>$ jade &lt; my.jade &gt; my.html
</code></pre>
"
"Why does `animation-direction: reverse` not work for my CSS keyframe animation?","<p>I'm trying to use <code>animation-direction: reverse</code> to refactor my CSS keyframe animation. I have a container div when clicked will toggle an ""active"" class on it via jQuery which triggers the animation (forward or backward depending on the ""active"" state). The forward and backward animations are exactly the same thing except the keyframes are in the reverse order. I figured that <code>animation-direction: reverse</code> would enable me to refactor it by just using one animation and reversing it for the other, but it's not working the way I thought it would. </p>

<p>Link to codepen (without using <code>animation-direction: reverse</code>):
<a href=""https://codepen.io/soultrust/pen/gogKjN"" rel=""nofollow noreferrer"">https://codepen.io/soultrust/pen/gogKjN</a></p>

<p>The following markup and CSS (Sass) code snippet is the way it works now without reverse. </p>

<pre><code>&lt;div class=""container""&gt;
  &lt;div class=""line""&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>&nbsp;</p>

<pre><code>$width-height: 100px;
$duration: 1s;
$line-width: 10%;
$animation-distance: $width-height * .45;

@keyframes line-in {
  0% { transform: translateY(-$animation-distance); }
  50% { transform: translateY(0); }
  100% { transform: rotate(-135deg); }
}

@keyframes line-out {
  0% { transform: rotate(-135deg); }
  50% { transform: translateY(0); }
  100% { transform: translateY(-$animation-distance); }
}

.container {
  margin: 10rem auto 0;
  width: $width-height;
  height: $width-height;
  position: relative;
  border: 1px solid black;

  &amp;.active {
    .line {
      animation-name: line-in;
      animation-direction: normal;
    }
  }
}

.line {
  width: 100%;
  height: $line-width;
  position: absolute;
  top: 45%;
  background-color: orange;
  animation-direction: normal;
  animation-name: line-out;
  animation-duration: $duration;
  animation-fill-mode: forwards;
}
</code></pre>

<p>When I change the ""active"" animation to following, animations in both directions stop working. </p>

<pre><code>&amp;.active {
  .line {
    animation-name: line-out;
    animation-direction: reverse;
  }
}
</code></pre>

<p>I believe it has something to do with using the same animation because if I just set the <code>animation-direction: reverse</code> and use <code>animation-name: line-in</code>, it correctly plays the line-in animation in reverse. </p>
","<p>Very good question. You have already noticed that <code>animation-direction: reverse;</code> does work. You where very close to figuring out this css quirkiness all by yourself.</p>

<p>There are some additional rules to take note off.</p>

<ul>
<li>When removing/replacing a css animation, the animation will start from 0%,</li>
<li>When you set <code>reverse</code> (while not changing the actual animation), the animation will continue from whatever % it was at.</li>
</ul>

<p>So when you clicked the element and set the <code>line-out</code> animation:</p>

<ul>
<li>The animation will start from 0%</li>
<li>Play in whatever direction you've set.</li>
</ul>

<p>When only applying a new animation direction:</p>

<ul>
<li>The animation continous from whatever percentage it was, eg, 100%.</li>
</ul>

<p>You can <a href=""https://css-tricks.com/restart-css-animation/"" rel=""nofollow noreferrer"">restart</a> the animation with several forms of trickery. you'll see that the animation is being played in reverse when the element is recreated.</p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>var clickFunc =function(e) {    
      //toggle the state
      $(this).toggleClass(""active"");
      //reset the animatino state by cloning and replacing the element.
      var newone = this.cloneNode(true);
      this.parentNode.replaceChild(newone, this);
      // reapply click handler to the cloned element
      $(newone).click(clickFunc)   
}


$(function() {
  $("".question"").click(function() {
    $(this).toggleClass(""active"");
  });
  
    $("".answer"").click(clickFunc);

  $("".restart"").click(function() {
    $("".line"").each(function() {
      var newone = this.cloneNode(true);
      this.parentNode.replaceChild(newone, this);
    });
  });
});</code></pre>
<pre class=""snippet-code-css lang-css prettyprint-override""><code>@keyframes line-in {
  0% {
    transform: translateY(-45px);
  }
  50% {
    transform: translateY(0);
  }
  100% {
    transform: rotate(-135deg);
  }
}
@keyframes line-out {
  0% {
    transform: rotate(-135deg);
  }
  50% {
    transform: translateY(0);
  }
  100% {
    transform: translateY(-45px);
  }
}
.line {
  width: 100%;
  height: 10%;
  position: absolute;
  top: 45%;
  background-color: orange;
  animation-direction: normal;
  animation-name: line-in;
  animation-duration: 1s;
  animation-fill-mode: forwards;
}

.container {
  margin: 1rem auto 0;
  width: 100px;
  height: 100px;
  position: relative;
  border: 1px solid black;
}
.container.reverse .line {
  animation-name: line-in;
  animation-direction: reverse;
}
.container.active .line {
  animation-name: line-in;
  animation-direction: reverse;
}
.container.active.reverse .line {
  animation-name:line-in;
  animation-direction: normal;
}

.container.out.active .line {
  animation-name: line-out;
  animation-direction: normal;
}</code></pre>
<pre class=""snippet-code-html lang-html prettyprint-override""><code>&lt;script src=""https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js""&gt;&lt;/script&gt;
&lt;button class=""restart""&gt;reset animation state&lt;/button&gt;&lt;br&gt;
in -out
&lt;div class=""container question out""&gt;
  &lt;div class=""line""&gt;&lt;/div&gt;
&lt;/div&gt;

active reversed
&lt;div class=""container question""&gt;
  &lt;div class=""line""&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;br&gt;

workaround
&lt;div class=""container answer reverse""&gt;
  &lt;div class=""line""&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</p>

<p>In order to debug this. You can inspect the animation states in the web dev tools of your browser:
<a href=""https://i.stack.imgur.com/TFZLT.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/TFZLT.png"" alt=""enter image description here""></a></p>

<p>With regards to your refactor:
I would rather have multiple animations in different directions, than doing js tricks in order to restart/reverse an animation.</p>

<p>Depending on how complicated your animation is, you might be better of using css transitions as opposed to animation frames. You would not have to worry about reversing/resetting the animation.</p>
"
"Related Field got invalid lookup :exists","<p>In my database, I have a <code>Photo</code> class, that I use as a foreignkey to other classes. These are two examples of such.</p>

<pre><code>class SubstancePointsLabel(ResultBase):   
    #: photo being labeled
    photo = models.ForeignKey(Photo, related_name='substance_points_labels')

class SubstancePoint(EmptyModelBase):   
    #: photo
    photo = models.ForeignKey(Photo, related_name='substance_points')
</code></pre>

<p>The only difference in these instances the <code>ResultBase</code> and <code>EmptyModelBase</code> but nothing in seems (to me) to be the cause.</p>

<pre><code>class EmptyModelBase(models.Model):
    """""" Base class of all models, with no fields """"""

    def get_entry_dict(self):
        return {'id': self.id}

    def get_entry_attr(self):
        ct = ContentType.objects.get_for_model(self)
        return 'data-model=""%s/%s"" data-id=""%s""' % (
            ct.app_label, ct.model, self.id)

    def get_entry_id(self):
        ct = ContentType.objects.get_for_model(self)
        return '%s.%s.%s' % (ct.app_label, ct.model, self.id)

    class Meta:
        abstract = True
        ordering = ['-id']

class ResultBase(UserBase):
    """""" Base class for objects created as a result of a submission """"""

    #: The MTurk Assignment that the user was in when this record was created
    mturk_assignment = models.ForeignKey(
        'mturk.MtAssignment', null=True, blank=True,
        related_name='+', on_delete=models.SET_NULL
    )

    #: True if created in the mturk sandbox
    sandbox = models.BooleanField(default=False)

    #: This has been marked by an admin as invalid or incorrect AND will be
    #: re-scheduled for new labeling.  This can happen when an experiment is
    #: changed and things need to be recomputed.
    invalid = models.BooleanField(default=False)

    #: The method by which the quality label was obtained
    QUALITY_METHODS = (
        ('A', 'admin'), ('C', 'CUBAM'),
        ('M', 'majority vote'), ('Q', 'qualification'),
        ('S', 'seed point'),
    )
    quality_method_to_str = dict((k, v) for (k, v) in QUALITY_METHODS)
    #: The method by which the quality label was obtained
    quality_method = models.CharField(
        max_length=1, choices=QUALITY_METHODS, blank=True, null=True)

    #: time taken to specify this label in ms
    time_ms = models.IntegerField(blank=True, null=True, db_index=True)

    #: time taken to specify this label in ms, excluding time that the user was
    #: in another window
    time_active_ms = models.IntegerField(blank=True, null=True, db_index=True)

    #: payment for this specific label
    reward = models.DecimalField(
        decimal_places=4, max_digits=8, null=True, blank=True)

    def save(self, *args, **kwargs):
        if not self.id and self.mturk_assignment:
            self.sandbox = self.mturk_assignment.hit.sandbox
        if not self.reward:
            from common.utils import compute_label_reward
            self.reward = compute_label_reward(self)
        super(ResultBase, self).save(*args, **kwargs)

    def time_s(self):
        """""" Time pretty-printed in seconds (helper for templates) """"""
        if self.time_ms:
            t = self.time_ms / 1000.0
            return round(t, 2 if t &lt; 10 else 1)
        else:
            return None

    def time_active_s(self):
        """""" Active pretty-printed time in seconds (helper for templates) """"""
        if self.time_active_ms:
            t = self.time_active_ms / 1000.0
            return round(t, 2 if t &lt; 10 else 1)
        else:
            return None

    def mark_invalid(self, save=True):
        dirty = (not self.invalid)
        self.invalid = True
        self.quality_method = 'A'
        if save:
            self.save()
        if dirty:
            marked_invalid.send(sender=self.__class__, instance=self)

    def get_thumb_overlay(self):
        return self.__unicode__()

    class Meta:
        abstract = True
        ordering = ['-time_ms']
</code></pre>

<p>For a Photo instance, I'm capable of accessing <code>SubstancePointsLabel</code> and <code>SubstancePoint</code> via the related name. </p>

<pre><code>In : photo.substance_points_labels.count()
Out: 3

In : photo.substance_points.count()
Out: 9
</code></pre>

<p>I wish to filter Photo instances, on whether the related class exists, which I do as follows.</p>

<pre><code>In : Photo.objects.filter(substance_exists_labels__exists=True).count()
Out: 335932
</code></pre>

<p>Now, as above, this works for some. For a few others, the query returns an error:</p>

<pre><code>In : Photo.objects.filter(substance_points__exists=True).count()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
/data_nfs/opensurfaces2/server/matclass/tasks.pyc in &lt;module&gt;()
----&gt; 1 Photo.objects.filter(substance_points__exists=True).count()

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/manager.pyc in manager_method(self, *args, **kwargs)
     90         def create_method(name, method):
     91             def manager_method(self, *args, **kwargs):
---&gt; 92                 return getattr(self.get_queryset(), name)(*args, **kwargs)
     93             manager_method.__name__ = method.__name__
     94             manager_method.__doc__ = method.__doc__

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/query.pyc in filter(self, *args, **kwargs)
    689         set.
    690         """"""
--&gt; 691         return self._filter_or_exclude(False, *args, **kwargs)
    692 
    693     def exclude(self, *args, **kwargs):

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/query.pyc in _filter_or_exclude(self, negate, *args, **kwargs)
    707             clone.query.add_q(~Q(*args, **kwargs))
    708         else:
--&gt; 709             clone.query.add_q(Q(*args, **kwargs))
    710         return clone
    711 

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/sql/query.pyc in add_q(self, q_object)
   1329         existing_inner = set(
   1330             (a for a in self.alias_map if self.alias_map[a].join_type == self.INNER))
-&gt; 1331         clause, require_inner = self._add_q(where_part, self.used_aliases)
   1332         self.where.add(clause, AND)
   1333         for hp in having_parts:

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/sql/query.pyc in _add_q(self, q_object, used_aliases, branch_negated, current_negated)
   1356                 child_clause, needed_inner = self.build_filter(
   1357                     child, can_reuse=used_aliases, branch_negated=branch_negated,
-&gt; 1358                     current_negated=current_negated, connector=connector)
   1359                 joinpromoter.add_votes(needed_inner)
   1360             target_clause.add(child_clause, connector)

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/sql/query.pyc in build_filter(self, filter_expr, branch_negated, current_negated, can_reuse, connector)
   1223             # refactored when composite fields lands.
   1224             condition = field.get_lookup_constraint(self.where_class, alias, targets, sources,
-&gt; 1225                                                     lookups, value)
   1226             lookup_type = lookups[-1]
   1227         else:

/data_nfs/opensurfaces2/venv/local/lib/python2.7/site-packages/django/db/models/fields/related.pyc in get_lookup_constraint(self, constraint_class, alias, targets, sources, lookups, raw_value)
   1575                 root_constraint.add(value_constraint, OR)
   1576         else:
-&gt; 1577             raise TypeError('Related Field got invalid lookup: %s' % lookup_type)
   1578         return root_constraint
   1579 

TypeError: Related Field got invalid lookup: exists
</code></pre>

<p>The classes are created the same way, and are queried the same way. What could the cause it's giving an error for some instances, and not for others? </p>
","<p>You can do it using <code>exclude</code> method and <code>__isnull</code> lookup.</p>

<pre><code>Photo.objects.exclude(substance_points__isnull=True).count()
</code></pre>

<hr>

<p>Or you can use <em><a href=""https://docs.djangoproject.com/en/2.0/ref/models/conditional-expressions/"" rel=""nofollow noreferrer""><strong><code>conditional expression</code></strong></a></em> </p>

<pre><code>from django.db.models import When, Case, IntegerField

Photo.objects.annotate(
   has_substance_points=Case(
       When(
          substance_points__isnull=True, then=0
       ), 
       default=1, 
       output_field=IntegerField()
   )
).filter(has_substance_points=1).count()
</code></pre>

<blockquote>
  <p>Above query will return <strong>count of photos</strong> that has
  <strong>substance_points</strong></p>
</blockquote>

<hr>

<p><strong>UPDATE</strong></p>

<p>Alternatively, If you just want count of photos that has <code>substance_points</code>, you can also think of below approach.</p>

<pre><code>SubstancePoint.objects.all().order_by('photo_id').distinct('photo_id').count()
# Query will return count of photos that has substance_points
</code></pre>
"